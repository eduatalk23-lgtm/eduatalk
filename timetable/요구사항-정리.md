# 요구사항 정리

> 이 문서는 플랜 생성 및 스케줄링 관련 요구사항을 정리하는 문서입니다.
> 기존 설계 문서: [학습일-복습일-주기-설정.md](./학습일-복습일-주기-설정.md), [플랜-생성-로직-설계.md](./플랜-생성-로직-설계.md)

---

## 요구사항 목록

### 1. 성적 분석 기반 교재/강의 추천 시스템

#### 개요

학생의 내신성적과 모의고사 성적을 분석하여 적합한 교재와 강의를 추천하는 기능

#### 입력 데이터

- **내신성적**
  - 과목별 성적
  - 학기/학년 정보
  - 등급 또는 점수
- **모의고사 성적**
  - 과목별 성적
  - 시험 일자
  - 등급 또는 점수
  - 표준점수 (있는 경우)
  - 백분위 (있는 경우)

#### 분석 항목

- 성적 추이 분석 (향상/하락 패턴)
- 과목별 약점/강점 파악
- 내신 vs 모의고사 성적 비교
- 목표 대비 현재 수준 분석

#### 추천 결과

- **교재 추천**
  - 교재명
  - 추천 이유
  - 난이도 레벨
  - 학습 목표
- **강의 추천**
  - 강의명
  - 추천 이유
  - 난이도 레벨
  - 학습 목표

#### 고려사항

- 성적 데이터 수집 방법
- 분석 알고리즘/로직
- 추천 기준 및 우선순위
- 개인화 수준 (학생별 맞춤 추천)

---

### 2. 수준 분석 기반 학습 분량 추천 시스템

#### 개요

학생의 수준을 분석하여 교재와 강의의 적절한 학습 분량을 추천하는 기능

#### 입력 데이터

- **학생 수준 정보**
  - 현재 성적 수준
  - 학습 능력 평가
  - 학습 속도
  - 이해도 수준
- **교재/강의 정보**

  - 교재/강의 난이도
  - 총 분량 (페이지 수, 강의 수 등)
  - 예상 소요 시간

- **플랜 기간 정보** ⚠️ 필수 고려사항

  - 플랜 시작일
  - 플랜 종료일
  - 총 플랜 기간 (일수)
  - 학습일 수 (제외일 제외)
  - 복습일 수

- **플랜 배정 가능한 시간** ⚠️ 필수 고려사항
  - 일일 학습 가능 시간
  - 주간 학습 가능 시간
  - 학습 시간대 (시작 시간 ~ 종료 시간)
  - 제외 시간 (학원 일정, 식사 시간 등)
  - 실제 학습 가능 시간 (총 시간 - 제외 시간)

#### 분석 항목

- 학생 수준과 교재/강의 난이도 매칭
- 학습 속도 기반 분량 계산
- **플랜 기간 대비 적정 분량 산출** (플랜 기간 고려)
- **플랜 배정 가능한 시간 대비 분량 계산** (실제 학습 가능 시간 고려)
- 과목별/단원별 우선순위 반영
- **시간 제약 조건 내에서의 분량 최적화**

#### 추천 결과

- **일일 학습 분량** (플랜 배정 가능한 시간 기반)
  - 교재: 페이지 수 또는 단원 수
  - 강의: 강의 수 또는 시간
  - 예상 소요 시간
  - **일일 학습 가능 시간 내에서의 분량**
- **주간/월간 학습 분량** (플랜 기간 기반)

  - 주간 목표 분량
  - 월간 목표 분량
  - **플랜 기간 내 총 목표 분량**
  - 진행률 추적 기준

- **플랜 기간별 분량 분배**
  - 학습일별 분량 배정
  - 복습일 고려 (복습 시간 제외)
  - 제외일 제외한 실제 학습일 기준 분량

#### 고려사항

- 학생 수준 평가 방법 및 기준
- 학습 속도 측정 방법
- 난이도별 분량 조정 로직
- 유연한 분량 조정 (학습 진행 상황 반영)
- **플랜 기간과 배정 가능한 시간을 반드시 고려한 분량 계산**
- **실제 학습 가능 시간 내에서의 현실적인 분량 제안**
- 플랜 생성과의 연동 (시간 배정)
- **플랜 기간 내 목표 달성 가능 여부 검증**

---

### 3. 성적 분석 기반 전략과목/취약과목 추천 시스템

#### 개요

학생의 성적과 분석을 바탕으로 전략과목(교과)과 취약과목(교과)을 추천하는 기능

#### 입력 데이터

- **내신성적**
  - 과목별 성적
  - 학기/학년 정보
  - 등급 또는 점수
  - 과목별 상세 점수 (선택/필수 영역 등)
- **모의고사 성적**

  - 과목별 성적
  - 시험 일자
  - 등급 또는 점수
  - 표준점수 (있는 경우)
  - 백분위 (있는 경우)
  - 과목별 상세 점수

- **목표 정보** (선택)
  - 목표 대학/전형
  - 목표 등급/점수
  - 반영 비율 정보

#### 분석 항목

- **전략과목 분석**
  - 현재 성적 대비 향상 가능성 높은 과목
  - 투자 대비 효과가 큰 과목
  - 상대적으로 약한 과목 중 단기간 향상 가능한 과목
  - 목표 대비 부족한 점수 보완 가능 과목
- **취약과목 분석**

  - 성적이 낮은 과목
  - 성적 추이가 하락하는 과목
  - 내신/모의고사 모두 낮은 과목
  - 기초가 부족한 과목

- **과목별 상세 분석**
  - 과목별 성적 추이 (향상/하락/유지)
  - 내신 vs 모의고사 성적 비교
  - 목표 대비 현재 수준
  - 상대적 강점/약점

#### 추천 결과

- **전략과목 추천**

  - 과목명 (교과)
  - 추천 이유
  - 현재 수준
  - 목표 수준
  - 향상 가능성
  - 예상 효과 (점수 향상 기대치)
  - 우선순위

- **취약과목 추천**
  - 과목명 (교과)
  - 추천 이유
  - 현재 수준
  - 목표 수준
  - 취약 원인 분석
  - 보완 필요도
  - 우선순위

#### 추천 기준

- **전략과목 선정 기준**

  - 현재 성적이 중간 수준인 과목
  - 단기간 향상 가능성이 높은 과목
  - 목표 달성에 필요한 점수 보완 가능 과목
  - 투자 대비 효과가 큰 과목

- **취약과목 선정 기준**
  - 성적이 평균 이하인 과목
  - 성적 추이가 하락하는 과목
  - 기초가 부족한 과목
  - 목표 달성에 장애가 되는 과목

#### 플랜 배정 방식 ⚠️ 필수 요구사항

- **취약과목 플랜 배정**

  - **전체 학습일에 플랜 배정**
  - 모든 학습일에 해당 과목의 플랜이 배정됨
  - 복습일에는 제외 (복습일은 직전 학습일 복습)
  - 제외일에는 제외

- **전략과목 플랜 배정**
  - **주 2~4일 배정을 선택할 수 있어야 함**
  - 주당 배정 일수 선택 옵션: 2일, 3일, 4일
  - 선택한 주당 일수에 따라 학습일에 균등하게 배정
  - 예시: 주 3일 선택 시, 주당 학습일 중 3일에만 해당 과목 플랜 배정
  - 복습일에는 제외 (복습일은 직전 학습일 복습)
  - 제외일에는 제외

#### 배정 방식 상세

- **취약과목 배정 예시**

  - 플랜 기간: 2025-01-01 ~ 2025-01-31
  - 학습일 수: 20일 (제외일 2일 제외)
  - 취약과목: 수학
  - 결과: 20일 모두 수학 플랜 배정

- **전략과목 배정 예시**
  - 플랜 기간: 2025-01-01 ~ 2025-01-31
  - 학습일 수: 20일 (제외일 2일 제외)
  - 전략과목: 영어
  - 주당 배정 일수: 3일 선택
  - 결과: 주당 학습일 중 3일에만 영어 플랜 배정 (총 약 12일)

#### 고려사항

- 성적 데이터의 충분성 (최소 데이터 수)
- 분석 알고리즘/로직 (가중치, 점수 계산 방식)
- 전략과목과 취약과목의 균형
- 학생의 목표와의 연계성
- 과목별 특성 고려 (문과/이과, 선택/필수)
- 시간 제약 내에서의 우선순위 설정
- **취약과목은 전체 학습일 배정, 전략과목은 주당 배정 일수 선택 가능**
- **플랜 생성 시 배정 방식에 따른 시간 배정 로직**
- **주당 배정 일수 선택 시 학습일 분배 알고리즘** (균등 분배, 연속/비연속 등)

---

### 4. 학습 범위 분할 및 소요시간 계산 시스템

#### 개요

교재와 강의의 학습 범위를 학습일과 전략/취약과목(교과)을 고려하여 나누고, 학생 수준을 바탕으로 소요시간을 도출하는 기능

#### 입력 데이터

- **교재/강의 정보**

  - 교재/강의 전체 범위
  - 단원/챕터 구성
  - 페이지 수 또는 강의 수
  - 기본 예상 소요 시간 (표준 기준)

- **학습일 정보** ⚠️ 필수 고려사항

  - 플랜 기간 내 학습일 목록
  - 학습일 수 (제외일 제외)
  - 복습일 정보
  - 학습일별 배정 가능한 시간

- **전략/취약과목 정보** ⚠️ 필수 고려사항

  - 전략과목 목록 및 주당 배정 일수
  - 취약과목 목록 (전체 학습일 배정)
  - 과목별 교재/강의 매핑

- **학생 수준 정보** ⚠️ 필수 고려사항
  - 현재 성적 수준
  - 학습 속도
  - 이해도 수준
  - 과목별 수준 차이

#### 학습 범위 분할 규칙

- **취약과목 학습 범위 분할**

  - 전체 학습일에 배정되므로 학습일 수로 전체 범위를 균등 분할
  - 예시: 교재 200페이지, 학습일 20일 → 일일 10페이지
  - 단원/챕터 경계 고려 (단원을 중간에 나누지 않도록)
  - 복습일에는 범위 분할 제외

- **전략과목 학습 범위 분할**

  - 주당 배정 일수에 따라 범위 분할
  - 예시: 교재 200페이지, 주 3일 배정, 학습일 20일 → 주당 약 30페이지, 일일 약 10페이지
  - 주당 배정 일수에 비례하여 범위 분할
  - 단원/챕터 경계 고려

- **범위 분할 우선순위**
  1. 단원/챕터 경계 우선 (단원을 중간에 나누지 않음)
  2. 학습일 수에 따른 균등 분할
  3. 전략/취약과목 배정 방식 반영

#### 소요시간 계산 규칙

- **기본 소요시간 계산**

  - 표준 소요시간 × 학생 수준 보정 계수
  - 학생 수준 보정 계수:
    - 상위 수준: 0.8~0.9 (빠르게 학습)
    - 중위 수준: 1.0 (표준)
    - 하위 수준: 1.1~1.3 (느리게 학습)

- **과목별 소요시간 조정**

  - 취약과목: 기본 소요시간 × 1.2 (더 많은 시간 필요)
  - 전략과목: 기본 소요시간 × 1.0~1.1
  - 학생의 과목별 이해도 반영

- **난이도별 소요시간 조정**

  - 교재/강의 난이도와 학생 수준 차이에 따른 조정
  - 난이도가 높을수록 소요시간 증가
  - 학생 수준이 낮을수록 소요시간 증가

- **복습일 소요시간 계산** ⚠️ 필수 고려사항
  - 복습일에는 직전 학습일(6일) 동안 학습한 전체 범위를 복습
  - 복습은 이미 학습한 내용이므로 소요시간을 다르게 계산해야 함
  - 복습 소요시간 = 직전 학습일(6일) 범위의 학습 소요시간 × 복습 보정 계수
  - 복습 보정 계수: 0.3~0.5 (학습 대비 30~50% 시간)
  - 예시: 6일간 학습 범위가 총 60페이지이고 학습 소요시간이 360분이면, 복습 소요시간은 360분 × 0.4 = 144분
  - 주차 전체 학습 범위를 복습하더라도 복습 보정 계수를 적용하여 소요시간 도출

#### 계산 결과

- **일일 학습 범위**

  - 교재: 페이지 범위 또는 단원 범위
  - 강의: 강의 번호 범위
  - 학습일별 배정 범위

- **일일 소요시간**

  - 교재 학습 소요시간 (분)
  - 강의 학습 소요시간 (분)
  - 총 예상 소요시간

- **주간/전체 학습 범위 및 소요시간**

  - 주간 목표 범위
  - 전체 기간 목표 범위
  - 총 예상 소요시간

- **복습일 학습 범위 및 소요시간**
  - 복습 범위: 직전 학습일(6일) 동안 학습한 전체 범위
  - 복습 소요시간: 직전 학습일 학습 소요시간 × 복습 보정 계수 (0.3~0.5)
  - 주차 전체 학습 범위를 복습하더라도 복습 보정 계수 적용

#### 계산 예시

**시나리오**

- 교재: 수학 교재 200페이지
- 학습일: 20일
- 취약과목: 수학 (전체 학습일 배정)
- 학생 수준: 중위 (보정 계수 1.0)
- 취약과목 보정: ×1.2
- 표준 소요시간: 페이지당 5분

**계산 (학습일)**

- 일일 범위: 200페이지 ÷ 20일 = 10페이지/일
- 일일 소요시간: 10페이지 × 5분 × 1.0 × 1.2 = 60분/일
- 총 소요시간: 60분 × 20일 = 1,200분 (20시간)

**복습일 소요시간 계산 예시**

- 직전 학습일(6일) 학습 범위: 10페이지 × 6일 = 60페이지
- 직전 학습일(6일) 학습 소요시간: 60페이지 × 5분 × 1.0 × 1.2 = 360분
- 복습 보정 계수: 0.4 (40%)
- 복습일 소요시간: 360분 × 0.4 = 144분
- **복습일에는 60페이지 전체를 복습하더라도 144분만 소요됨** (학습 대비 40% 시간)

#### 고려사항

- **학습일과 전략/취약과목 배정 방식을 반드시 고려한 범위 분할**
- **학생 수준을 바탕으로 한 정확한 소요시간 도출**
- 단원/챕터 경계를 존중한 범위 분할
- 학습일별 배정 가능한 시간 내에서의 범위/시간 검증
- 복습일에는 범위 분할 제외
- **복습일 소요시간은 직전 학습일(6일) 전체 범위를 복습하더라도 복습 보정 계수를 적용하여 계산**
- **복습 보정 계수 설정** (0.3~0.5, 학습 대비 30~50% 시간)
- 제외일에는 범위 분할 제외
- 학생 수준 평가 방법 및 보정 계수 설정
- 과목별/난이도별 소요시간 조정 로직
- 플랜 생성 시 범위와 시간 배정 연동

---

### 5. 플랜별 소요시간 기반 학습 시간 타임라인 구성 시스템

#### 개요

플랜별 소요시간을 바탕으로 학습 시간 타임라인을 구성하여 실제 시간대에 플랜을 배정하는 기능

#### 입력 데이터

- **플랜별 소요시간 정보** ⚠️ 필수

  - 각 플랜의 예상 소요시간 (분)
  - 플랜 유형 (학습일/복습일)
  - 과목 정보
  - 교재/강의 정보

- **학습 시간 정보** ⚠️ 필수

  - 학습 시간대 (시작 시간 ~ 종료 시간)
  - 일일 학습 가능 시간
  - 제외 시간 (학원 일정, 식사 시간 등)
  - 실제 학습 가능 시간대 목록

- **자율 학습 시간 정보** (선택)

  - 자율 학습 시간대 (시작 시간 ~ 종료 시간)
  - 자율 학습 시간 사용 여부
  - 지정휴일 자율 학습 시간 배정 여부

- **날짜별 정보**
  - 학습일/복습일/제외일 구분
  - 날짜별 배정 가능한 시간대
  - 날짜별 제외 시간 정보

#### 타임라인 구성 규칙

- **시간대 배정 우선순위**

  1. 취약과목 플랜 우선 배정 (전체 학습일 배정)
  2. 전략과목 플랜 배정 (주당 배정 일수에 따라)
  3. 복습일 플랜 배정 (복습일인 경우)

- **시간대 배정 방법**

  - 플랜 소요시간에 맞는 연속된 시간대 배정
  - 가능한 시간대 내에서 최적의 시간대 선택
  - 제외 시간을 피하여 배정
  - 시간대 간 간격 최소화 (연속 배정 우선)
  - **학습 제외 시간으로 인해 타임라인 연속성이 없는 경우 처리** ⚠️ 필수

- **일일 타임라인 구성**
  - 학습 시간대 내에서 플랜 배정
  - 제외 시간을 제외한 실제 학습 가능 시간대에만 배정
  - 플랜 간 적절한 간격 고려 (선택사항)
  - 일일 총 소요시간이 배정 가능한 시간 내에 있는지 검증
  - **배정 가능한 시간이 부족한 경우 자율 학습 시간 사용** ⚠️ 필수
  - **학습 제외 시간으로 인해 타임라인 연속성이 없는 경우 처리** ⚠️ 필수
    - 제외 시간 전후로 플랜이 분리되어 배정될 수 있음
    - 하나의 플랜이 제외 시간으로 인해 여러 시간대로 분할 배정 가능
    - 분할된 플랜은 동일한 학습 범위를 공유하되 시간대만 분리됨
    - 분할된 각 시간대의 소요시간 합이 원래 플랜 소요시간과 일치해야 함

#### 타임라인 구성 결과

- **날짜별 타임라인**

  - 날짜
  - 학습 시간대별 플랜 배정 목록
  - 자율 학습 시간대별 플랜 배정 목록 (배정 가능한 시간 부족 시)
  - 각 플랜의 시작 시간 ~ 종료 시간
  - 총 학습 시간 (학습 시간대 + 자율 학습 시간대)

- **플랜별 시간대 정보**

  - 플랜 ID
  - 배정 날짜
  - 시작 시간 (HH:mm)
  - 종료 시간 (HH:mm)
  - 소요시간 (분)
  - 과목 정보

- **일일 타임라인 요약**
  - 날짜
  - 총 배정 플랜 수
  - 학습 시간대 총 학습 시간
  - 자율 학습 시간대 총 학습 시간 (사용된 경우)
  - 총 학습 시간 (학습 시간대 + 자율 학습 시간대)
  - 배정 가능한 시간 대비 사용률
  - 자율 학습 시간 사용 여부

#### 타임라인 구성 예시

**시나리오**

- 학습 시간: 10:00 ~ 19:00
- 점심식사: 12:00 ~ 13:00 (제외)
- 학원 일정: 수요일 14:00 ~ 17:00, 이동시간 60분 (13:00 ~ 18:00 제외)
- 날짜: 2025-01-01 (수요일, 학습일)

**플랜 소요시간**

- 취약과목(수학): 60분
- 전략과목(영어): 40분
- 전략과목(국어): 30분

**타임라인 구성 결과 (자율 학습 시간 미사용)**

- 10:00 ~ 11:00: 수학 (60분)
- 11:00 ~ 11:40: 영어 (40분)
- 11:40 ~ 12:00: 국어 (30분 중 20분)
- 12:00 ~ 13:00: 점심식사 (제외)
- 13:00 ~ 18:00: 학원 일정 (제외)
- 18:00 ~ 18:10: 국어 (30분 중 남은 10분)
- 총 학습 시간: 130분

**타임라인 구성 결과 (자율 학습 시간 사용)**

- 학습 시간: 10:00 ~ 19:00
- 자율 학습 시간: 19:00 ~ 22:00
- 학습 시간대 배정:
  - 10:00 ~ 11:00: 수학 (60분)
  - 11:00 ~ 11:40: 영어 (40분)
  - 11:40 ~ 12:00: 국어 (30분 중 20분)
  - 12:00 ~ 13:00: 점심식사 (제외)
  - 13:00 ~ 18:00: 학원 일정 (제외)
  - 18:00 ~ 18:10: 국어 (30분 중 남은 10분)
- **자율 학습 시간대 배정** (배정 가능한 시간 부족 시):
  - 19:00 ~ 19:20: 국어 (30분 중 남은 20분)
- 총 학습 시간: 150분 (학습 시간 130분 + 자율 학습 시간 20분)

**타임라인 구성 결과 (연속성 없는 경우)**

- 학습 시간: 10:00 ~ 19:00
- 점심식사: 12:00 ~ 13:00 (제외)
- 학원 일정: 14:00 ~ 17:00, 이동시간 60분 (13:00 ~ 18:00 제외)
- 플랜 소요시간: 국어 60분

**분할 배정 결과**

- **국어 플랜 (60분)이 제외 시간으로 인해 분할 배정됨**:
  - 11:00 ~ 12:00: 국어 (60분 중 60분) - 제외 시간 전 배정
  - 12:00 ~ 13:00: 점심식사 (제외)
  - 13:00 ~ 18:00: 학원 일정 (제외)
  - 18:00 ~ 19:00: (빈 시간 또는 다른 플랜)
- **또는 다른 방식**:
  - 10:00 ~ 11:00: 국어 (60분 중 30분)
  - 11:00 ~ 12:00: (다른 플랜)
  - 12:00 ~ 13:00: 점심식사 (제외)
  - 13:00 ~ 18:00: 학원 일정 (제외)
  - 18:00 ~ 18:30: 국어 (60분 중 남은 30분)
- **분할된 플랜은 동일한 학습 범위를 공유하되 시간대만 분리됨**
- **분할된 각 시간대의 소요시간 합 = 원래 플랜 소요시간 (60분)**

#### 제약조건 및 검증

- **시간 제약 검증**

  - 플랜 소요시간이 배정 가능한 시간 내에 있는지 확인
  - 일일 총 소요시간이 배정 가능한 시간을 초과하지 않는지 확인
  - 제외 시간과 겹치지 않는지 확인
  - **분할된 플랜 검증** (제외 시간으로 인해 분할된 경우)
    - 분할된 각 시간대의 소요시간 합이 원래 플랜 소요시간과 일치하는지 확인
    - 분할된 시간대들이 제외 시간과 겹치지 않는지 확인
    - 분할된 플랜들이 동일한 학습 범위를 공유하는지 확인

- **배정 실패 처리**
  - 배정 가능한 시간이 부족한 경우
    - **자율 학습 시간 사용** ⚠️ 필수 처리 방법
    - 학습 시간대에 배정 후 남은 플랜을 자율 학습 시간대에 배정
    - 자율 학습 시간이 활성화되어 있는 경우에만 사용
    - 지정휴일의 경우 설정에 따라 자율 학습 시간 배정 가능
  - 플랜 소요시간이 너무 긴 경우
  - 제외 시간이 과도한 경우
  - 대안 제시 (소요시간 조정, 날짜 변경 등)

#### 고려사항

- **플랜별 소요시간을 바탕으로 한 정확한 타임라인 구성**
- 학습 시간대 내에서의 최적 배정
- 제외 시간을 고려한 실제 배정 가능 시간대 계산
- 취약과목 우선 배정, 전략과목 순차 배정
- 복습일 타임라인 구성 (복습일 소요시간 반영)
- 시간대 연속성 및 효율성 고려
- 일일 총 소요시간 검증
- **배정 가능한 시간이 부족한 경우 자율 학습 시간 사용** ⚠️ 필수
- **자율 학습 시간 사용 우선순위**: 학습 시간대 배정 후 남은 플랜을 자율 학습 시간대에 배정
- **자율 학습 시간 활성화 여부 확인**: 자율 학습 시간이 활성화되어 있는 경우에만 사용
- **지정휴일 자율 학습 시간 배정**: 지정휴일의 경우 설정에 따라 자율 학습 시간 배정 가능
- **학습 제외 시간으로 인해 타임라인 연속성이 없는 경우 처리** ⚠️ 필수
  - 제외 시간 전후로 플랜이 분할되어 배정될 수 있음
  - 분할된 플랜은 동일한 학습 범위를 공유하되 시간대만 분리됨
  - 분할된 각 시간대의 소요시간 합이 원래 플랜 소요시간과 일치해야 함
  - 분할된 플랜들을 원본 플랜 ID로 연결하여 관리
  - 분할 순서 및 전체 분할 개수 정보 포함
- 배정 실패 시 대안 제시 로직
- 플랜 생성 시 타임라인 자동 구성

---

### 6. 플랜 생성 시 플랜 정보 구조

#### 개요

플랜 생성 시 각 플랜에 포함되어야 할 모든 정보를 정의

#### 플랜 기본 정보

- **플랜 식별 정보**

  - 플랜 ID (고유 식별자)
  - 플랜 생성 일시
  - 플랜 수정 일시
  - 학생 ID

- **날짜 및 시간 정보**
  - 배정 날짜 (YYYY-MM-DD)
  - 날짜 유형 (학습일/복습일/제외일)
  - 주기 일자 번호 (주기 내 몇 일차)
  - 시작 시간 (HH:mm)
  - 종료 시간 (HH:mm)
  - 소요시간 (분)
  - 시간대 유형 (학습 시간대/자율 학습 시간대)

#### 과목 및 교재/강의 정보

- **과목 정보**

  - 과목명 (교과)
  - 과목 유형 (전략과목/취약과목)
  - 과목 ID

- **교재 정보** ⚠️ 플랜에 반영되는 필수 정보

  - 교재 ID
  - 교재명
  - 출판사/제작사
  - 교재 유형 (교과서/문제집/참고서 등)
  - 난이도 레벨
  - 학습 범위 (시작 페이지 ~ 종료 페이지 또는 단원 범위)
    - 시작 페이지 번호
    - 종료 페이지 번호
    - 또는 단원/챕터 범위
  - 일일 학습 범위 (해당 플랜의 학습 범위)
  - 총 학습 범위 (페이지 수 또는 단원 수)
  - 학습 목표
  - 추천 이유 (성적 분석 기반 추천인 경우)

- **강의 정보** ⚠️ 플랜에 반영되는 필수 정보

  - 강의 ID
  - 강의명
  - 강의 제공자/강사명
  - 강의 유형 (동영상/라이브/오프라인 등)
  - 난이도 레벨
  - 학습 범위 (강의 번호 범위)
    - 시작 강의 번호
    - 종료 강의 번호
    - 강의 제목 목록 (해당 범위의 강의들)
  - 일일 학습 범위 (해당 플랜의 학습 범위)
  - 총 학습 범위 (강의 수)
  - 강의 평균 소요 시간 (강의당 분)
  - 학습 목표
  - 추천 이유 (성적 분석 기반 추천인 경우)

#### 학습 범위 및 분량 정보

- **일일 학습 범위**

  - 교재: 페이지 범위 또는 단원 범위
  - 강의: 강의 번호 범위
  - 학습 내용 요약

- **전체 학습 범위**
  - 플랜 기간 내 총 학습 범위
  - 진행률 (현재 진행 범위 / 전체 범위)

#### 소요시간 정보

- **소요시간 계산 정보**

  - 기본 소요시간 (분)
  - 학생 수준 보정 계수
  - 과목별 보정 계수 (취약과목/전략과목)
  - 난이도 보정 계수
  - 복습 보정 계수 (복습일인 경우)
  - 최종 소요시간 (분)

- **복습일 소요시간 정보** (복습일인 경우)
  - 직전 학습일(6일) 학습 범위
  - 직전 학습일(6일) 학습 소요시간
  - 복습 보정 계수
  - 복습 소요시간

#### 타임라인 정보

- **시간대 배정 정보**

  - 배정 시간대 (학습 시간대/자율 학습 시간대)
  - 시작 시간 (HH:mm)
  - 종료 시간 (HH:mm)
  - 배정 순서 (일일 타임라인 내 순서)
  - **분할된 플랜 정보** (제외 시간으로 인해 분할된 경우) ⚠️ 필수
    - 원본 플랜 ID (분할된 플랜들을 연결하는 식별자)
    - 분할 순서 (원본 플랜 내에서의 순서)
    - 분할된 시간대별 소요시간
    - 분할된 시간대별 시작/종료 시간
    - 전체 소요시간 (모든 분할된 시간대의 합)

- **일일 타임라인 요약**
  - 날짜
  - 총 배정 플랜 수
  - 학습 시간대 총 학습 시간
  - 자율 학습 시간대 총 학습 시간
  - 총 학습 시간
  - **분할된 플랜 수** (제외 시간으로 인해 분할된 플랜 수)

#### 배정 방식 정보

- **과목별 배정 방식**
  - 취약과목: 전체 학습일 배정
  - 전략과목: 주당 배정 일수 (2일/3일/4일)
  - 배정 날짜 목록

#### 플랜 상태 정보

- **플랜 상태**
  - 상태 (예정/진행중/완료/보류)
  - 진행률 (%)
  - 시작 일시 (실제 시작 시간)
  - 완료 일시 (실제 완료 시간)
  - 일시정지 시간 (있는 경우)
  - 재개 시간 (있는 경우)

#### 데이터 구조 예시

```typescript
type Plan = {
  // 기본 정보
  id: string;
  student_id: string;
  date: string; // YYYY-MM-DD
  date_type: "study" | "review" | "exclusion";
  cycle_day_number: number;

  // 시간 정보
  start_time: string; // HH:mm
  end_time: string; // HH:mm
  duration_minutes: number;
  time_slot_type: "study" | "self_study";

  // 과목 정보
  subject: {
    id: string;
    name: string;
    type: "strategy" | "weakness";
  };

  // 교재 정보 (요구사항 7 참조)
  textbook?: {
    id: string;
    name: string;
    publisher?: string;
    type?: string;
    difficulty_level?: string;
    range: {
      start_page?: number;
      end_page?: number;
      chapters?: number[];
      chapter_names?: string[];
    };
    total_pages?: number;
    total_chapters?: number;
    learning_goal: string;
    recommendation_reason?: string;
  };

  // 강의 정보 (요구사항 7 참조)
  lecture?: {
    id: string;
    name: string;
    instructor?: string;
    type?: string;
    difficulty_level?: string;
    range: {
      start_lecture_number: number;
      end_lecture_number: number;
      lectures?: Array<{
        lecture_number: number;
        title: string;
        duration_minutes: number;
      }>;
    };
    total_lectures: number;
    average_duration_per_lecture?: number;
    total_lecture_duration?: number;
    total_learning_duration?: number;
    learning_goal: string;
    recommendation_reason?: string;
  };

  // 교재/강의 조합 정보
  content_combination?: {
    type: "textbook_only" | "lecture_only" | "textbook_and_lecture";
    learning_order?: "textbook_first" | "lecture_first" | "parallel";
    matching_info?: {
      textbook_range: string;
      matched_lectures: number[];
    };
  };

  // 소요시간 정보
  duration_info: {
    base_duration: number;
    student_level_factor: number;
    subject_factor: number;
    difficulty_factor: number;
    review_factor?: number; // 복습일인 경우
    final_duration: number;
  };

  // 복습일 정보 (복습일인 경우)
  review_info?: {
    previous_study_days_range: string;
    previous_study_duration: number;
    review_factor: number;
    review_duration: number;
  };

  // 타임라인 정보
  timeline: {
    time_slot_type: "study" | "self_study";
    order: number; // 일일 타임라인 내 순서
    // 분할된 플랜 정보 (제외 시간으로 인해 분할된 경우)
    split_info?: {
      original_plan_id: string; // 원본 플랜 ID (분할된 플랜들을 연결)
      split_order: number; // 원본 플랜 내에서의 분할 순서
      total_split_count: number; // 전체 분할 개수
      total_duration: number; // 전체 소요시간 (모든 분할된 시간대의 합)
    };
  };

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days" | "weekly_days";
    weekly_days?: number; // 전략과목인 경우 주당 배정 일수
  };

  // 상태 정보
  status: "scheduled" | "in_progress" | "completed" | "paused";
  progress_percentage: number;
  started_at?: string;
  completed_at?: string;
  paused_at?: string;
  resumed_at?: string;

  // 메타 정보
  created_at: string;
  updated_at: string;
};
```

#### 고려사항

- **플랜 생성 시 모든 필수 정보 포함**
- 과목 유형(전략/취약)에 따른 배정 방식 정보 포함
- 학습 범위와 소요시간 정보의 정확성
- **교재/강의 정보 필수 반영** (요구사항 7 참조) ⚠️ 필수
  - 교재/강의 기본 정보 (ID, 이름, 출판사/강사, 유형, 난이도 등)
  - 학습 범위 정보 (일일 학습 범위, 전체 범위)
  - 학습 목표 및 추천 이유
  - 교재/강의 조합 정보 (단독 사용 또는 조합 사용)
- 복습일인 경우 복습 관련 정보 포함
- 타임라인 정보를 통한 시간대 배정 추적
- **학습 제외 시간으로 인해 분할된 플랜 정보 포함** ⚠️ 필수
  - 분할된 플랜들을 원본 플랜 ID로 연결
  - 분할 순서 및 전체 분할 개수 정보
  - 분할된 각 시간대의 소요시간 및 시작/종료 시간
  - 전체 소요시간 검증 (분할된 시간대의 합 = 원래 소요시간)
- 플랜 상태 관리를 위한 상태 정보
- 데이터 일관성 및 무결성 보장

---

### 7. 플랜에 반영되는 교재/강의 정보

#### 개요

플랜 생성 시 각 플랜에 반영되어야 하는 교재와 강의의 상세 정보를 정의

#### 교재 정보 반영 규칙

- **기본 정보**

  - 교재 ID (고유 식별자)
  - 교재명
  - 출판사/제작사
  - 교재 유형 (교과서/문제집/참고서/워크북 등)
  - 난이도 레벨 (기초/중급/고급 등)

- **학습 범위 정보**

  - 전체 교재 범위
    - 총 페이지 수
    - 총 단원/챕터 수
    - 단원/챕터 목록
  - 해당 플랜의 학습 범위
    - 시작 페이지 번호
    - 종료 페이지 번호
    - 또는 단원/챕터 범위
    - 학습할 단원/챕터 목록
  - 학습 범위 요약 (예: "1단원 ~ 3단원", "p.10 ~ p.30")

- **학습 목표 및 추천 정보**
  - 학습 목표 (해당 범위의 학습 목표)
  - 추천 이유 (성적 분석 기반 추천인 경우)
  - 추천 근거 (약점 보완/강점 강화/목표 달성 등)

#### 강의 정보 반영 규칙

- **기본 정보**

  - 강의 ID (고유 식별자)
  - 강의명
  - 강의 제공자/강사명
  - 강의 유형 (동영상/라이브/오프라인/하이브리드 등)
  - 난이도 레벨 (기초/중급/고급 등)

- **학습 범위 정보**

  - 전체 강의 범위
    - 총 강의 수
    - 강의 목록 (강의 번호, 제목, 소요 시간)
  - 해당 플랜의 학습 범위
    - 시작 강의 번호
    - 종료 강의 번호
    - 학습할 강의 목록 (강의 번호, 제목, 소요 시간)
  - 학습 범위 요약 (예: "강의 1~5", "1강 ~ 3강")

- **소요 시간 정보**

  - 강의 평균 소요 시간 (강의당 분)
  - 해당 플랜 범위의 총 강의 소요 시간
  - 학습 소요 시간 (강의 시청 + 복습 시간 포함)

- **학습 목표 및 추천 정보**
  - 학습 목표 (해당 범위의 학습 목표)
  - 추천 이유 (성적 분석 기반 추천인 경우)
  - 추천 근거 (약점 보완/강점 강화/목표 달성 등)

#### 교재/강의 조합 정보

- **교재와 강의의 관계**

  - 교재만 사용하는 경우
  - 강의만 사용하는 경우
  - 교재 + 강의 조합 사용하는 경우
  - 교재와 강의의 매칭 정보 (어떤 교재 범위에 어떤 강의가 매칭되는지)

- **학습 순서**
  - 교재 선학습 후 강의 시청
  - 강의 시청 후 교재 복습
  - 교재와 강의 병행 학습
  - 학습 순서에 따른 소요 시간 조정

#### 플랜별 교재/강의 정보 구조

```typescript
type PlanContentInfo = {
  // 교재 정보
  textbook?: {
    id: string;
    name: string;
    publisher?: string;
    type?: string; // 교과서/문제집/참고서 등
    difficulty_level?: string;

    // 전체 범위
    total_pages?: number;
    total_chapters?: number;
    chapters?: Array<{
      chapter_number: number;
      chapter_name: string;
      start_page: number;
      end_page: number;
    }>;

    // 플랜 학습 범위
    plan_range: {
      start_page?: number;
      end_page?: number;
      chapters?: number[]; // 단원 번호 목록
      chapter_names?: string[]; // 단원명 목록
    };

    learning_goal: string;
    recommendation_reason?: string; // 추천 이유
  };

  // 강의 정보
  lecture?: {
    id: string;
    name: string;
    instructor?: string;
    type?: string; // 동영상/라이브/오프라인 등
    difficulty_level?: string;

    // 전체 범위
    total_lectures: number;
    all_lectures: Array<{
      lecture_number: number;
      title: string;
      duration_minutes: number;
    }>;

    // 플랜 학습 범위
    plan_range: {
      start_lecture_number: number;
      end_lecture_number: number;
      lectures: Array<{
        lecture_number: number;
        title: string;
        duration_minutes: number;
      }>;
    };

    // 소요 시간
    average_duration_per_lecture: number; // 강의당 평균 시간
    total_lecture_duration: number; // 해당 범위의 총 강의 시간
    total_learning_duration: number; // 학습 소요 시간 (강의 + 복습)

    learning_goal: string;
    recommendation_reason?: string; // 추천 이유
  };

  // 교재/강의 조합 정보
  combination?: {
    type: "textbook_only" | "lecture_only" | "textbook_and_lecture";
    learning_order?: "textbook_first" | "lecture_first" | "parallel";
    matching_info?: {
      // 교재 범위와 강의의 매칭 정보
      textbook_range: string;
      matched_lectures: number[];
    };
  };
};
```

#### 고려사항

- **플랜 생성 시 교재/강의 정보 필수 반영**
- 교재와 강의의 학습 범위 정보 정확성
- 일일 학습 범위와 전체 학습 범위의 일관성
- 학습 목표와 추천 이유의 명확성
- 교재/강의 조합 사용 시 학습 순서 및 소요 시간 고려
- 난이도 레벨과 학생 수준의 매칭 정보
- 추천 근거 정보 (성적 분석 기반 추천인 경우)

---

### 8. 플랜 구성 시 교과(과목) 제약 조건

#### 개요

플랜 생성 시 반드시 포함되어야 하는 교과(과목)를 지정하는 제약 조건 기능

#### 제약 조건 유형

- **필수 교과 지정**

  - 플랜에 반드시 포함되어야 하는 교과 목록
  - 예: 국어, 수학, 영어 교과가 플랜 교재/강의 중에 있어야 함
  - 교재 또는 강의 중 하나라도 해당 교과가 포함되면 조건 만족

- **제외 교과 지정** (선택)
  - 플랜에 포함되면 안 되는 교과 목록
  - 예: 특정 교과는 플랜에서 제외

#### 제약 조건 검증 규칙

- **필수 교과 검증**

  - 플랜 생성 시 지정된 필수 교과가 모두 포함되어 있는지 확인
  - 교재 또는 강의 중 하나라도 해당 교과가 포함되면 조건 만족
  - 필수 교과가 누락된 경우 플랜 생성 실패 또는 경고

- **제외 교과 검증**
  - 플랜 생성 시 제외 교과가 포함되어 있지 않은지 확인
  - 제외 교과가 포함된 경우 플랜 생성 실패 또는 경고

#### 입력 데이터

- **필수 교과 목록** (선택)

  - 교과 ID 목록
  - 교과명 목록
  - 예: ["국어", "수학", "영어"]

- **제외 교과 목록** (선택)
  - 교과 ID 목록
  - 교과명 목록
  - 예: ["체육", "음악"]

#### 제약 조건 적용 시점

- **플랜 생성 전 검증**

  - 플랜 생성 요청 시 필수 교과 포함 여부 확인
  - 제외 교과 포함 여부 확인
  - 조건 불만족 시 플랜 생성 중단 또는 경고

- **플랜 생성 중 검증**

  - 교재/강의 추천 시 필수 교과 포함 여부 확인
  - 전략과목/취약과목 추천 시 필수 교과 포함 여부 확인
  - 조건 불만족 시 추가 교재/강의 추천 또는 경고

- **플랜 생성 후 검증**
  - 생성된 플랜에 필수 교과가 모두 포함되어 있는지 최종 확인
  - 조건 불만족 시 플랜 생성 실패 또는 보완 제안

#### 제약 조건 우선순위

1. **필수 교과 우선**

   - 필수 교과가 지정된 경우, 해당 교과를 우선적으로 플랜에 포함
   - 전략과목/취약과목 추천 시 필수 교과 우선 고려

2. **제외 교과 차단**
   - 제외 교과는 플랜 생성 시 자동으로 제외
   - 제외 교과가 추천된 경우 다른 교재/강의로 대체

#### 제약 조건 처리 방법

- **조건 만족 시**

  - 정상적으로 플랜 생성 진행
  - 필수 교과가 모두 포함된 것으로 확인

- **조건 불만족 시**
  - **옵션 1**: 플랜 생성 실패 및 오류 메시지
  - **옵션 2**: 경고 메시지와 함께 플랜 생성 (선택 가능)
  - **옵션 3**: 자동으로 누락된 교과의 교재/강의 추가 추천

#### 데이터 구조

```typescript
type SubjectConstraint = {
  // 필수 교과 목록
  required_subjects?: string[]; // 교과 ID 또는 교과명 목록

  // 제외 교과 목록
  excluded_subjects?: string[]; // 교과 ID 또는 교과명 목록

  // 제약 조건 처리 방법
  constraint_handling: "strict" | "warning" | "auto_fix";
  // strict: 조건 불만족 시 플랜 생성 실패
  // warning: 조건 불만족 시 경고와 함께 플랜 생성
  // auto_fix: 조건 불만족 시 자동으로 보완
};

// 플랜 생성 요청에 포함
type PlanCreationRequest = {
  // ... 기존 필드들
  subject_constraints?: SubjectConstraint;
};
```

#### 검증 로직 예시

```typescript
function validateSubjectConstraints(
  plans: Plan[],
  constraints: SubjectConstraint
): ValidationResult {
  const planSubjects = new Set<string>();

  // 생성된 플랜에서 교과 추출
  plans.forEach((plan) => {
    if (plan.subject?.id) {
      planSubjects.add(plan.subject.id);
    }
  });

  // 필수 교과 검증
  if (constraints.required_subjects) {
    const missingSubjects = constraints.required_subjects.filter(
      (subject) => !planSubjects.has(subject)
    );

    if (missingSubjects.length > 0) {
      return {
        valid: false,
        message: `필수 교과가 누락되었습니다: ${missingSubjects.join(", ")}`,
        missing_subjects: missingSubjects,
      };
    }
  }

  // 제외 교과 검증
  if (constraints.excluded_subjects) {
    const includedExcludedSubjects = constraints.excluded_subjects.filter(
      (subject) => planSubjects.has(subject)
    );

    if (includedExcludedSubjects.length > 0) {
      return {
        valid: false,
        message: `제외된 교과가 포함되었습니다: ${includedExcludedSubjects.join(
          ", "
        )}`,
        excluded_subjects_found: includedExcludedSubjects,
      };
    }
  }

  return { valid: true };
}
```

#### 고려사항

- **플랜 생성 시 교과 제약 조건 필수 검증** ⚠️ 필수
- 필수 교과가 지정된 경우, 해당 교과가 플랜에 반드시 포함되어야 함
- 교재 또는 강의 중 하나라도 해당 교과가 포함되면 조건 만족
- 제외 교과가 지정된 경우, 해당 교과는 플랜에서 제외되어야 함
- 제약 조건 처리 방법 선택 (strict/warning/auto_fix)
- 전략과목/취약과목 추천 시 필수 교과 우선 고려
- 플랜 생성 전/중/후 단계별 검증
- 사용자에게 제약 조건 위반 시 명확한 피드백 제공

---

## 4주 플랜 작성 예시

### 시나리오 설정

#### 기본 정보

- **플랜 기간**: 2025-01-01 (수) ~ 2025-01-28 (화), 4주 (28일)
- **학습일/복습일 주기**: 6일 학습 + 1일 복습 = 7일 주기
- **학습 시간**: 10:00 ~ 19:00 (9시간)
- **자율 학습 시간**: 19:00 ~ 22:00 (3시간, 활성화)
- **점심식사**: 12:00 ~ 13:00 (제외)
- **학원 일정**: 수요일 14:00 ~ 17:00, 이동시간 60분 (13:00 ~ 18:00 제외)
- **제외일**: 2025-01-15 (수) - 휴가

#### 학생 정보

- **학생 수준**: 중위 (보정 계수 1.0)
- **전략과목**: 영어 (주 3일 배정), 국어 (주 3일 배정)
- **취약과목**: 수학 (전체 학습일 배정)

#### 교과 제약 조건

- **필수 교과**: 국어, 수학, 영어
  - 플랜에 국어, 수학, 영어 교과가 반드시 포함되어야 함
  - 교재 또는 강의 중 하나라도 해당 교과가 포함되면 조건 만족
- **제약 조건 처리**: strict (조건 불만족 시 플랜 생성 실패)

#### 교재/강의 정보

**수학 (취약과목)**

- 교재: "수학의 정석 기하와 벡터" (200페이지)
- 표준 소요시간: 페이지당 5분
- 취약과목 보정: ×1.2

**영어 (전략과목)**

- 교재: "영어 문법 완성" (150페이지)
- 강의: "영어 문법 기초 강의" (30강, 강의당 30분)
- 표준 소요시간: 교재 페이지당 4분, 강의 시청 + 복습
- 전략과목 보정: ×1.0

**국어 (전략과목)**

- 교재: "국어 독해 실전" (180페이지)
- 표준 소요시간: 페이지당 4분
- 전략과목 보정: ×1.0

---

### 주기별 학습일/복습일 계산

#### 1주기 (2025-01-01 ~ 2025-01-07)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-01 (수) | 학습일 | 주기 1일차 | 1주기 시작 |
| 2025-01-02 (목) | 학습일 | 주기 2일차 |            |
| 2025-01-03 (금) | 학습일 | 주기 3일차 |            |
| 2025-01-04 (토) | 학습일 | 주기 4일차 |            |
| 2025-01-05 (일) | 학습일 | 주기 5일차 |            |
| 2025-01-06 (월) | 학습일 | 주기 6일차 |            |
| 2025-01-07 (화) | 복습일 | 주기 7일차 | 1주기 완료 |

#### 2주기 (2025-01-08 ~ 2025-01-14)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-08 (수) | 학습일 | 주기 1일차 | 2주기 시작 |
| 2025-01-09 (목) | 학습일 | 주기 2일차 |            |
| 2025-01-10 (금) | 학습일 | 주기 3일차 |            |
| 2025-01-11 (토) | 학습일 | 주기 4일차 |            |
| 2025-01-12 (일) | 학습일 | 주기 5일차 |            |
| 2025-01-13 (월) | 학습일 | 주기 6일차 |            |
| 2025-01-14 (화) | 복습일 | 주기 7일차 | 2주기 완료 |

#### 3주기 (2025-01-15 ~ 2025-01-21)

| 날짜            | 유형   | 주기 일자  | 설명                  |
| --------------- | ------ | ---------- | --------------------- |
| 2025-01-15 (수) | 제외일 | -          | 휴가 (주기 계산 제외) |
| 2025-01-16 (목) | 학습일 | 주기 1일차 | 3주기 시작            |
| 2025-01-17 (금) | 학습일 | 주기 2일차 |                       |
| 2025-01-18 (토) | 학습일 | 주기 3일차 |                       |
| 2025-01-19 (일) | 학습일 | 주기 4일차 |                       |
| 2025-01-20 (월) | 학습일 | 주기 5일차 |                       |
| 2025-01-21 (화) | 학습일 | 주기 6일차 |                       |

#### 4주기 (2025-01-22 ~ 2025-01-28)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-22 (수) | 복습일 | 주기 7일차 | 3주기 완료 |
| 2025-01-23 (목) | 학습일 | 주기 1일차 | 4주기 시작 |
| 2025-01-24 (금) | 학습일 | 주기 2일차 |            |
| 2025-01-25 (토) | 학습일 | 주기 3일차 |            |
| 2025-01-26 (일) | 학습일 | 주기 4일차 |            |
| 2025-01-27 (월) | 학습일 | 주기 5일차 |            |
| 2025-01-28 (화) | 학습일 | 주기 6일차 | 4주기 종료 |

**총 학습일**: 24일 (제외일 1일 제외, 복습일 3일 제외)
**총 복습일**: 3일

---

### 학습 범위 분할

#### 수학 (취약과목) - 전체 학습일 배정

- **전체 범위**: 200페이지
- **학습일 수**: 24일
- **일일 범위**: 200페이지 ÷ 24일 = 약 8.3페이지/일
- **실제 배정**:
  - 대부분 일일 8페이지
  - 일부 일일 9페이지 (총합 200페이지 맞춤)

#### 영어 (전략과목) - 주 3일 배정

- **전체 범위**: 교재 150페이지 + 강의 30강
- **주당 배정 일수**: 3일
- **4주 총 배정 일수**: 약 12일 (주당 3일 × 4주)
- **교재 일일 범위**: 150페이지 ÷ 12일 = 약 12.5페이지/일
- **강의 일일 범위**: 30강 ÷ 12일 = 약 2.5강/일
- **실제 배정**:
  - 교재: 일일 12~13페이지
  - 강의: 일일 2~3강

#### 국어 (전략과목) - 주 3일 배정

- **전체 범위**: 180페이지
- **주당 배정 일수**: 3일
- **4주 총 배정 일수**: 약 12일
- **일일 범위**: 180페이지 ÷ 12일 = 15페이지/일

---

### 소요시간 계산

#### 수학 (취약과목) - 학습일

- **일일 범위**: 8페이지
- **일일 소요시간**: 8페이지 × 5분 × 1.0 (학생 수준) × 1.2 (취약과목) = **48분/일**
- **24일 총 소요시간**: 48분 × 24일 = 1,152분 (19.2시간)

#### 수학 (취약과목) - 복습일

- **직전 학습일(6일) 범위**: 8페이지 × 6일 = 48페이지
- **직전 학습일(6일) 소요시간**: 48페이지 × 5분 × 1.0 × 1.2 = 288분
- **복습 보정 계수**: 0.4 (40%)
- **복습일 소요시간**: 288분 × 0.4 = **115분/복습일**
- **3일 총 복습 소요시간**: 115분 × 3일 = 345분 (5.75시간)

#### 영어 (전략과목) - 학습일

- **교재 일일 범위**: 12페이지
- **교재 일일 소요시간**: 12페이지 × 4분 × 1.0 × 1.0 = **48분/일**
- **강의 일일 범위**: 2.5강
- **강의 일일 소요시간**: 2.5강 × 30분 (강의) + 15분 (복습) = **90분/일**
- **일일 총 소요시간**: 48분 + 90분 = **138분/일**
- **12일 총 소요시간**: 138분 × 12일 = 1,656분 (27.6시간)

#### 국어 (전략과목) - 학습일

- **일일 범위**: 15페이지
- **일일 소요시간**: 15페이지 × 4분 × 1.0 × 1.0 = **60분/일**
- **12일 총 소요시간**: 60분 × 12일 = 720분 (12시간)

---

### 타임라인 구성 예시 (2025-01-01, 수요일)

#### 입력 정보

- **날짜**: 2025-01-01 (수요일, 학습일, 주기 1일차)
- **학습 시간**: 10:00 ~ 19:00
- **자율 학습 시간**: 19:00 ~ 22:00
- **점심식사**: 12:00 ~ 13:00 (제외)
- **학원 일정**: 13:00 ~ 18:00 (14:00~17:00 학원 + 이동시간 60분, 제외)

#### 플랜 소요시간

- 수학: 48분
- 영어: 138분 (교재 48분 + 강의 90분)
- 국어: 60분
- **총 소요시간**: 246분 (4.1시간)

#### 배정 가능한 시간 계산

- **학습 시간대**: 10:00 ~ 19:00 (9시간 = 540분)
- **제외 시간**:
  - 점심식사: 12:00 ~ 13:00 (60분)
  - 학원 일정: 13:00 ~ 18:00 (300분)
- **실제 배정 가능한 시간**: 540분 - 60분 - 300분 = **180분**

#### 타임라인 구성 결과

**학습 시간대 배정**

- 10:00 ~ 10:48: 수학 (48분) - 취약과목 우선
- 10:48 ~ 11:36: 영어 교재 (48분) - 전략과목
- 11:36 ~ 12:00: 국어 (24분) - 전략과목 (일부)
- 12:00 ~ 13:00: 점심식사 (제외)
- 13:00 ~ 18:00: 학원 일정 (제외)
- 18:00 ~ 18:36: 국어 (36분) - 전략과목 (남은 부분)

**자율 학습 시간대 배정** (배정 가능한 시간 부족으로 사용)

- 19:00 ~ 20:30: 영어 강의 (90분) - 전략과목

**일일 타임라인 요약**

- 총 배정 플랜 수: 3개 (수학, 영어, 국어)
- 학습 시간대 총 학습 시간: 156분
- 자율 학습 시간대 총 학습 시간: 90분
- 총 학습 시간: 246분
- 배정 가능한 시간 대비 사용률: 100% (180분 사용, 자율 학습 시간 90분 추가 사용)

---

### 플랜 정보 예시 (2025-01-01 수학 플랜)

```typescript
{
  // 기본 정보
  id: "plan_math_20250101",
  student_id: "student_001",
  date: "2025-01-01",
  date_type: "study",
  cycle_day_number: 1,

  // 시간 정보
  start_time: "10:00",
  end_time: "10:48",
  duration_minutes: 48,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    publisher: "성지출판",
    type: "참고서",
    difficulty_level: "중급",
    range: {
      start_page: 1,
      end_page: 8,
      chapters: [1],
      chapter_names: ["1단원: 벡터의 연산"]
    },
    total_pages: 200,
    total_chapters: 10,
    learning_goal: "벡터의 기본 연산을 이해하고 문제를 해결할 수 있다",
    recommendation_reason: "기하와 벡터 영역 성적이 낮아 기초 보완 필요"
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 40, // 8페이지 × 5분
    student_level_factor: 1.0,
    subject_factor: 1.2, // 취약과목
    difficulty_factor: 1.0,
    final_duration: 48
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1 // 일일 타임라인 내 첫 번째
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days" // 취약과목: 전체 학습일 배정
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

---

### 플랜 정보 예시 (2025-01-01 영어 플랜)

```typescript
{
  // 기본 정보
  id: "plan_english_20250101",
  student_id: "student_001",
  date: "2025-01-01",
  date_type: "study",
  cycle_day_number: 1,

  // 시간 정보 (교재 부분)
  start_time: "10:48",
  end_time: "11:36",
  duration_minutes: 48,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_english",
    name: "영어",
    type: "strategy"
  },

  // 교재 정보
  textbook: {
    id: "textbook_english_001",
    name: "영어 문법 완성",
    publisher: "영어출판사",
    type: "문제집",
    difficulty_level: "중급",
    range: {
      start_page: 1,
      end_page: 12,
      chapters: [1],
      chapter_names: ["1단원: 문장의 구조"]
    },
    total_pages: 150,
    learning_goal: "영어 문장의 기본 구조를 이해한다",
    recommendation_reason: "문법 영역 향상 가능성 높음"
  },

  // 강의 정보 (자율 학습 시간대에 배정)
  lecture: {
    id: "lecture_english_001",
    name: "영어 문법 기초 강의",
    instructor: "김영어",
    type: "동영상",
    difficulty_level: "중급",
    range: {
      start_lecture_number: 1,
      end_lecture_number: 2,
      lectures: [
        { lecture_number: 1, title: "문장의 구조 1", duration_minutes: 30 },
        { lecture_number: 2, title: "문장의 구조 2", duration_minutes: 30 }
      ]
    },
    total_lectures: 30,
    average_duration_per_lecture: 30,
    total_lecture_duration: 60, // 2강 × 30분
    total_learning_duration: 90, // 강의 60분 + 복습 30분
    learning_goal: "영어 문장 구조를 강의로 이해하고 복습한다",
    recommendation_reason: "문법 영역 향상 가능성 높음"
  },

  // 교재/강의 조합 정보
  content_combination: {
    type: "textbook_and_lecture",
    learning_order: "textbook_first", // 교재 선학습 후 강의 시청
    matching_info: {
      textbook_range: "1~12페이지",
      matched_lectures: [1, 2]
    }
  },

  // 소요시간 정보 (교재 부분)
  duration_info: {
    base_duration: 48, // 12페이지 × 4분
    student_level_factor: 1.0,
    subject_factor: 1.0, // 전략과목
    difficulty_factor: 1.0,
    final_duration: 48
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 2, // 일일 타임라인 내 두 번째
    // 강의는 자율 학습 시간대에 별도 플랜으로 배정됨
  },

  // 배정 방식 정보
  allocation_type: {
    type: "weekly_days",
    weekly_days: 3 // 전략과목: 주 3일 배정
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

---

### 복습일 플랜 예시 (2025-01-07, 복습일)

```typescript
{
  // 기본 정보
  id: "plan_math_review_20250107",
  student_id: "student_001",
  date: "2025-01-07",
  date_type: "review",
  cycle_day_number: 7,

  // 시간 정보
  start_time: "10:00",
  end_time: "11:55",
  duration_minutes: 115,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보 (직전 6일간 학습 범위)
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    range: {
      start_page: 1,
      end_page: 48, // 직전 6일간 학습 범위 (8페이지 × 6일)
      chapters: [1, 2],
      chapter_names: ["1단원: 벡터의 연산", "2단원: 벡터의 내적"]
    },
    learning_goal: "직전 6일간 학습한 내용을 복습하여 이해도를 높인다"
  },

  // 복습일 소요시간 정보
  review_info: {
    previous_study_days_range: "2025-01-01 ~ 2025-01-06",
    previous_study_duration: 288, // 48페이지 × 5분 × 1.0 × 1.2
    review_factor: 0.4,
    review_duration: 115 // 288분 × 0.4
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 288,
    student_level_factor: 1.0,
    subject_factor: 1.2,
    difficulty_factor: 1.0,
    review_factor: 0.4,
    final_duration: 115
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days"
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

---

### 4주 플랜 요약

#### 전체 통계

- **플랜 기간**: 2025-01-01 ~ 2025-01-28 (28일)
- **총 학습일**: 24일
- **총 복습일**: 3일
- **제외일**: 1일

#### 과목별 통계

**수학 (취약과목)**

- 배정 일수: 24일 (학습일) + 3일 (복습일) = 27일
- 총 소요시간: 1,152분 (학습) + 345분 (복습) = 1,497분 (24.95시간)
- 학습 범위: 200페이지 전체

**영어 (전략과목)**

- 배정 일수: 12일 (주 3일 × 4주)
- 총 소요시간: 1,656분 (27.6시간)
- 학습 범위: 교재 150페이지 + 강의 30강

**국어 (전략과목)**

- 배정 일수: 12일 (주 3일 × 4주)
- 총 소요시간: 720분 (12시간)
- 학습 범위: 180페이지

#### 일일 평균 학습 시간

- **학습일 평균**: 약 246분 (4.1시간)
- **복습일 평균**: 약 115분 (1.9시간)
- **전체 평균**: 약 220분 (3.7시간)

#### 교과 제약 조건 검증 결과

- **필수 교과**: 국어, 수학, 영어
- **검증 결과**: ✅ 조건 만족
  - 국어: 포함됨 (전략과목, 교재 180페이지)
  - 수학: 포함됨 (취약과목, 교재 200페이지)
  - 영어: 포함됨 (전략과목, 교재 150페이지 + 강의 30강)
- **모든 필수 교과가 플랜에 포함되어 조건을 만족함**

---

## 변경 이력

- 2025-01-XX: 문서 생성

- 2025-01-XX: 문서 생성
