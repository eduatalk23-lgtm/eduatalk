# 1730Timetable 솔루션 요구사항 및 플랜 예시

> 이 문서는 1730Timetable 솔루션의 핵심 요구사항과 플랜 생성 예시를 종합적으로 정리한 문서입니다.
>
> 참고 문서:
>
> - [요구사항-정리.md](./요구사항-정리.md)
> - [학습일-복습일-주기-설정.md](./학습일-복습일-주기-설정.md)
> - [플랜-생성-로직-설계.md](./플랜-생성-로직-설계.md)

---

## 목차

1. [개요](#개요)
2. [핵심 요구사항](#핵심-요구사항)
3. [플랜 생성 로직](#플랜-생성-로직)
4. [학습일/복습일 주기 설정](#학습일복습일-주기-설정)
5. [4주 플랜 작성 예시](#4주-플랜-작성-예시)
6. [추가 기간 학습 범위 재배치 예시](#추가-기간-학습-범위-재배치-예시)
7. [데이터 구조](#데이터-구조)

---

## 개요

1730Timetable 솔루션은 학생의 성적 분석을 기반으로 맞춤형 학습 플랜을 자동 생성하는 시스템입니다. 주요 기능은 다음과 같습니다:

- **성적 분석 기반 교재/강의 추천**: 내신성적과 모의고사 성적을 분석하여 적합한 교재와 강의 추천
- **수준 분석 기반 학습 분량 추천**: 학생 수준에 맞는 적절한 학습 분량 계산
- **전략과목/취약과목 추천**: 성적 분석을 바탕으로 전략과목과 취약과목 추천
- **자동 플랜 생성**: 학습 시간대, 제외 시간, 주기 등을 고려한 최적의 학습 스케줄 자동 생성
- **타임라인 구성**: 플랜별 소요시간을 바탕으로 실제 시간대에 플랜 배정

---

## 핵심 요구사항

### 1. 성적 분석 기반 교재/강의 추천 시스템

#### 개요

학생의 내신성적과 모의고사 성적을 분석하여 적합한 교재와 강의를 추천하는 기능

#### 입력 데이터

- **내신성적**: 과목별 성적, 학기/학년 정보, 등급 또는 점수
- **모의고사 성적**: 과목별 성적, 시험 일자, 등급/점수, 표준점수, 백분위

#### 분석 항목

- 성적 추이 분석 (향상/하락 패턴)
- 과목별 약점/강점 파악
- 내신 vs 모의고사 성적 비교
- 목표 대비 현재 수준 분석

#### 추천 결과

- **교재 추천**: 교재명, 추천 이유, 난이도 레벨, 학습 목표
- **강의 추천**: 강의명, 추천 이유, 난이도 레벨, 학습 목표

---

### 2. 수준 분석 기반 학습 분량 추천 시스템

#### 개요

학생의 수준을 분석하여 교재와 강의의 적절한 학습 분량을 추천하는 기능

#### 필수 고려사항

- **플랜 기간 정보**: 플랜 시작일, 종료일, 총 플랜 기간, 학습일 수, 복습일 수
- **플랜 배정 가능한 시간**: 일일 학습 가능 시간, 주간 학습 가능 시간, 학습 시간대, 제외 시간, 실제 학습 가능 시간

#### 추천 결과

- **일일 학습 분량**: 플랜 배정 가능한 시간 기반 분량
- **주간/월간 학습 분량**: 플랜 기간 기반 분량
- **플랜 기간별 분량 분배**: 학습일별 분량 배정, 복습일 고려

---

### 3. 성적 분석 기반 전략과목/취약과목 추천 시스템

#### 개요

학생의 성적과 분석을 바탕으로 전략과목(교과)과 취약과목(교과)을 추천하는 기능

#### 플랜 배정 방식 ⚠️ 필수 요구사항

**취약과목 플랜 배정**

- **전체 학습일에 플랜 배정**
- 모든 학습일에 해당 과목의 플랜이 배정됨
- 복습일에는 제외 (복습일은 직전 학습일 복습)
- 제외일에는 제외

**전략과목 플랜 배정**

- **주 2~4일 배정을 선택할 수 있어야 함**
- 주당 배정 일수 선택 옵션: 2일, 3일, 4일
- 선택한 주당 일수에 따라 학습일에 균등하게 배정
- 복습일에는 제외
- 제외일에는 제외

#### 배정 예시

- **취약과목**: 학습일 20일 → 20일 모두 해당 과목 플랜 배정
- **전략과목**: 학습일 20일, 주 3일 선택 → 주당 학습일 중 3일에만 해당 과목 플랜 배정 (총 약 12일)

---

### 4. 학습 범위 분할 및 소요시간 계산 시스템

#### 개요

교재와 강의의 학습 범위를 학습일과 전략/취약과목을 고려하여 나누고, 학생 수준을 바탕으로 소요시간을 도출하는 기능

#### 학습 범위 분할 규칙

- **취약과목**: 전체 학습일에 배정되므로 학습일 수로 전체 범위를 균등 분할
- **전략과목**: 주당 배정 일수에 따라 범위 분할
- **범위 분할 우선순위**: 단원/챕터 경계 우선 → 학습일 수에 따른 균등 분할

#### 소요시간 계산 규칙

- **기본 소요시간**: 표준 소요시간 × 학생 수준 보정 계수
  - 상위 수준: 0.8~0.9
  - 중위 수준: 1.0
  - 하위 수준: 1.1~1.3
- **과목별 소요시간 조정**
  - 취약과목: 기본 소요시간 × 1.2
  - 전략과목: 기본 소요시간 × 1.0~1.1
- **복습일 소요시간 계산** ⚠️ 필수 고려사항
  - 복습일에는 직전 학습일(6일) 동안 학습한 전체 범위를 복습
  - 복습 소요시간 = 직전 학습일(6일) 범위의 학습 소요시간 × 복습 보정 계수
  - 복습 보정 계수: 0.3~0.5 (학습 대비 30~50% 시간)

---

### 5. 플랜별 소요시간 기반 학습 시간 타임라인 구성 시스템

#### 개요

플랜별 소요시간을 바탕으로 학습 시간 타임라인을 구성하여 실제 시간대에 플랜을 배정하는 기능

#### 타임라인 구성 규칙

- **시간대 배정 우선순위**
  1. 취약과목 플랜 우선 배정
  2. 전략과목 플랜 배정
  3. 복습일 플랜 배정
- **배정 가능한 시간이 부족한 경우 자율 학습 시간 사용** ⚠️ 필수
- **학습 제외 시간으로 인해 타임라인 연속성이 없는 경우 처리** ⚠️ 필수
  - 제외 시간 전후로 플랜이 분할되어 배정될 수 있음
  - 분할된 플랜은 동일한 학습 범위를 공유하되 시간대만 분리됨
  - 분할된 각 시간대의 소요시간 합이 원래 플랜 소요시간과 일치해야 함

---

### 6. 플랜 생성 시 플랜 정보 구조

#### 플랜 기본 정보

- 플랜 식별 정보 (ID, 생성/수정 일시, 학생 ID)
- 날짜 및 시간 정보 (배정 날짜, 날짜 유형, 주기 일자 번호, 시작/종료 시간, 소요시간, 시간대 유형)
- 과목 정보 (과목명, 과목 유형, 과목 ID)

#### 교재/강의 정보 ⚠️ 필수 반영

- **교재 정보**: ID, 이름, 출판사, 유형, 난이도, 학습 범위, 학습 목표, 추천 이유
- **강의 정보**: ID, 이름, 강사, 유형, 난이도, 학습 범위, 소요 시간, 학습 목표, 추천 이유
- **교재/강의 조합 정보**: 조합 유형, 학습 순서, 매칭 정보

#### 소요시간 정보

- 기본 소요시간, 학생 수준 보정 계수, 과목별 보정 계수, 난이도 보정 계수, 복습 보정 계수, 최종 소요시간

#### 타임라인 정보

- 시간대 배정 정보, 일일 타임라인 요약
- **분할된 플랜 정보** (제외 시간으로 인해 분할된 경우) ⚠️ 필수
  - 원본 플랜 ID, 분할 순서, 분할된 시간대별 소요시간, 전체 소요시간

---

### 7. 플랜에 반영되는 교재/강의 정보

#### 교재 정보 반영 규칙

- 기본 정보 (ID, 이름, 출판사, 유형, 난이도)
- 학습 범위 정보 (전체 범위, 해당 플랜의 학습 범위)
- 학습 목표 및 추천 정보

#### 강의 정보 반영 규칙

- 기본 정보 (ID, 이름, 강사, 유형, 난이도)
- 학습 범위 정보 (전체 강의 범위, 해당 플랜의 학습 범위)
- 소요 시간 정보 (강의 평균 소요 시간, 총 강의 소요 시간, 학습 소요 시간)
- 학습 목표 및 추천 정보

#### 교재/강의 조합 정보

- 교재만 사용 / 강의만 사용 / 교재 + 강의 조합 사용
- 학습 순서 (교재 선학습 후 강의 / 강의 후 교재 복습 / 병행 학습)

---

### 8. 플랜 구성 시 교과(과목) 제약 조건

#### 제약 조건 유형

- **필수 교과 지정**: 플랜에 반드시 포함되어야 하는 교과 목록
- **제외 교과 지정**: 플랜에 포함되면 안 되는 교과 목록

#### 제약 조건 검증 규칙

- **필수 교과 검증**: 플랜 생성 시 지정된 필수 교과가 모두 포함되어 있는지 확인
- **제외 교과 검증**: 플랜 생성 시 제외 교과가 포함되어 있지 않은지 확인
- **제약 조건 처리 방법**: strict (실패) / warning (경고) / auto_fix (자동 보완)

---

### 9. 추가 기간 학습 범위 재배치 시스템 (복습의 복습)

#### 개요

특별 조건으로 추가 기간을 지정하여 앞서 진행한 학습 범위를 추가 기간으로 플랜 재배치하는 기능. 복습의 복습 개념으로 소요시간을 추가로 감소시킴

#### 입력 데이터

- **추가 기간 정보** ⚠️ 필수
  - 추가 기간 시작일: `YYYY-MM-DD`
  - 추가 기간 종료일: `YYYY-MM-DD`
  - 추가 기간 유형: `"additional_review"` (추가 복습)
- **재배치 대상 학습 범위** ⚠️ 필수
  - 원본 플랜 기간: 시작일 ~ 종료일
  - 재배치할 과목 목록 (선택: 전체 또는 특정 과목만)
  - 재배치할 학습 범위 (선택: 전체 또는 특정 범위만)
- **학습 시간 설정**
  - 추가 기간의 학습 시간대 (기존 학습 시간 설정과 동일하거나 다를 수 있음)
  - 자율 학습 시간 설정 (선택)
  - 제외 시간 설정 (선택)

#### 재배치 규칙

- **학습 범위 재배치**
  - 앞서 진행한 학습 범위를 추가 기간에 재배치
  - 원본 플랜의 학습 범위를 그대로 사용 (새로운 학습 범위 생성 없음)
  - 추가 기간의 학습일 수에 따라 학습 범위를 균등 분할
- **소요시간 계산** ⚠️ 필수 고려사항
  - **복습의 복습 보정 계수**: 0.2~0.3 (복습 대비 20~30% 시간)
  - 복습일의 복습 보정 계수(0.3~0.5)보다 더 낮은 보정 계수 적용
  - 계산 공식:
    ```
    추가 복습 소요시간 = 원본 학습 소요시간 × 복습 보정 계수 × 복습의 복습 보정 계수
    또는
    추가 복습 소요시간 = 원본 복습 소요시간 × 복습의 복습 보정 계수
    ```
- **배정 방식**
  - 취약과목: 전체 추가 기간 학습일에 배정
  - 전략과목: 주당 배정 일수에 따라 배정 (원본과 동일하거나 다를 수 있음)

#### 소요시간 계산 예시

**시나리오**

- 원본 학습 범위: 수학 200페이지 (24일 학습일)
- 원본 학습 소요시간: 1,152분 (48분/일 × 24일)
- 원본 복습 소요시간: 345분 (115분/복습일 × 3일)
- 추가 기간: 2025-02-01 ~ 2025-02-07 (7일, 학습일 6일 + 복습일 1일)
- 복습의 복습 보정 계수: 0.25 (25%)

**계산 (추가 기간 학습일)**

- 추가 기간 학습일 수: 6일
- 일일 범위: 200페이지 ÷ 6일 = 약 33.3페이지/일
- 원본 일일 학습 소요시간: 48분/일
- 추가 복습 일일 소요시간: 48분 × 0.25 = **12분/일**
- 6일 총 소요시간: 12분 × 6일 = **72분**

**계산 (추가 기간 복습일)**

- 직전 학습일(6일) 범위: 33.3페이지 × 6일 = 약 200페이지 (전체)
- 직전 학습일(6일) 소요시간: 12분 × 6일 = 72분
- 복습 보정 계수: 0.4 (40%)
- 복습의 복습 보정 계수: 0.25 (25%)
- 추가 복습일 소요시간: 72분 × 0.4 × 0.25 = **7.2분** (약 7분)

#### 재배치 결과

- **추가 기간 플랜 목록**
  - 추가 기간 내 학습일별 플랜 배정
  - 원본 플랜의 학습 범위를 참조하여 재배치
  - 소요시간은 복습의 복습 보정 계수 적용
- **원본 플랜과의 연결 정보**
  - 원본 플랜 ID 참조
  - 재배치된 플랜임을 표시
  - 원본 학습 범위 정보 유지

#### 고려사항

- **원본 플랜 범위 재사용**: 새로운 학습 범위 생성 없이 원본 범위 재사용
- **소요시간 추가 감소**: 복습의 복습 보정 계수로 소요시간 추가 감소
- **학습 범위 분할**: 추가 기간의 학습일 수에 따라 학습 범위 균등 분할
- **타임라인 구성**: 추가 기간의 학습 시간대에 맞춰 타임라인 구성
- **원본 플랜 참조**: 재배치된 플랜은 원본 플랜 정보를 참조하여 관리

---

## 플랜 생성 로직

### 1. 기간 정보 (Period)

#### 필수 입력 항목

- **period_start** (시작일): `YYYY-MM-DD` 형식
- **period_end** (종료일): `YYYY-MM-DD` 형식

#### 제약조건

- `period_end > period_start`

---

### 2. 학습 시간 설정 (Study Hours)

#### 필수 입력 항목

- **하루 중 학습 가능한 시간 범위**
  - 시작 시간: `HH:mm` (24시간 형식)
  - 종료 시간: `HH:mm` (24시간 형식)
  - 예시: `10:00 ~ 19:00`

#### 제약조건

- 시작 시간 < 종료 시간
- 시간 형식이 올바르야 함 (`HH:mm`)

---

### 3. 자율학습 시간 설정 (Self-Study Hours)

#### 선택 입력 항목

- **자율학습 가능한 시간 범위**
  - 시작 시간: `HH:mm` (24시간 형식)
  - 종료 시간: `HH:mm` (24시간 형식)
  - 예시: `19:00 ~ 22:00`

#### ⚠️ 중요 제약사항

- **자율학습 시간에는 기본적으로 플랜 배정을 하지 않음**
- **배정 가능한 시간이 부족한 경우에만 자율 학습 시간 사용**
- **지정휴일의 경우 설정에 따라 자율학습 시간 배정 가능**

---

### 4. 학습 제외일 설정 (Exclusions)

#### 제외일 유형

1. **휴가**: 학습 시간과 자율학습 시간 모두 제외
2. **개인일정**: 학습 시간과 자율학습 시간 모두 제외
3. **기타**: 학습 시간과 자율학습 시간 모두 제외
4. **지정휴일**: 일반 학습 시간에는 플랜 배정하지 않음, **하지만 자율학습 시간은 배정 가능** (선택사항)

#### 입력 항목

- 날짜: `YYYY-MM-DD`
- 제외일 유형: `"휴가" | "개인일정" | "기타" | "지정휴일"`
- 사유 (선택): 텍스트

---

### 5. 학원 일정 설정 (Academy Schedules)

#### 입력 항목

- **요일**: `0` (일요일) ~ `6` (토요일)
- **학원 시간**: 시작 시간 ~ 종료 시간 (`HH:mm`)
- **이동시간**: 학원 가는 시간 + 학원 오는 시간 (분 단위)
- **학원명/과목** (선택): 텍스트

#### 시간 제외 계산

```
실제 제외 시작 시간 = 학원 시작 시간 - 이동시간
실제 제외 종료 시간 = 학원 종료 시간 + 이동시간
```

#### 예시

- 학원 시간: `14:00 ~ 17:00`
- 이동시간: `60분`
- 실제 제외 시간: `13:00 ~ 18:00`

---

### 6. 학습 시간 제외 항목 설정 (Non-Study Time Blocks)

#### 제외 항목 유형

1. **아침식사**: 아침 식사 시간
2. **점심식사**: 점심 식사 시간
3. **저녁식사**: 저녁 식사 시간
4. **수면**: 수면 시간
5. **기타**: 기타 개인 시간

#### 입력 항목

- 제외 항목 유형
- 시간 범위: 시작 시간 ~ 종료 시간 (`HH:mm`)
- 요일 적용 범위 (선택): 매일 적용 / 특정 요일만 적용 / 특정 요일 제외
- 설명 (선택): 텍스트

#### 제약조건

- 시간 범위가 **학습 시간(Study Hours) 내**에 있어야 함
- 같은 시간대에 여러 제외 항목이 겹치지 않아야 함

---

### 플랜 배정 우선순위 및 제외 규칙

#### 시간 제외 우선순위

1. **제외일 (Exclusions)**
   - 일반 제외일: 학습 시간 + 자율학습 시간 모두 제외
   - 지정휴일: 학습 시간만 제외 (자율학습 시간은 설정에 따라 배정 가능)
2. **학원 일정 (Academy Schedules)**
   - 학원 시간 + 이동시간 제외
   - 학습 시간 내에서만 적용
3. **학습 시간 제외 항목 (Non-Study Time Blocks)**
   - 식사 시간, 수면 시간 등
   - 학습 시간 내에서만 적용
4. **자율학습 시간 (Self-Study Hours)**
   - 기본적으로 플랜 배정하지 않음
   - 배정 가능한 시간 부족 시 사용
   - 지정휴일의 경우 설정에 따라 배정 가능

---

## 학습일/복습일 주기 설정

### 필수 입력 항목

- **학습일 수 (Study Days)**: 숫자 (일), 기본값: `6`
- **복습일 수 (Review Days)**: 숫자 (일), 기본값: `1`

### 주기 구성 규칙

- **1주기 = 학습일 + 복습일**
- 기본 구성: `6일 학습 + 1일 복습 = 7일 (1주기)`
- 주기는 기간 내에서 반복 적용됨

### 복습 범위

- **복습일에는 직전 학습일(6일) 동안 학습한 내용을 복습**
- 복습 대상은 직전 주기의 학습일에 배정된 플랜들

### ⚠️ 중요: 제외일 처리

**학습 제외일은 주기 계산에서 제외됨**

- 실제 날짜 기준이 아닌, **학습일과 복습일만 합쳐서 주기 길이 계산**
- 예: 6일 학습 + 1일 복습 = 7일인데, 그 사이에 제외일이 2일 있으면 실제로는 9일이 걸리지만 주기는 여전히 7일(학습일+복습일)로 계산
- 제외일은 주기 일자 카운트에 포함되지 않음

### 제약조건

- **학습일 수**: 1 이상의 정수
- **복습일 수**: 0 이상의 정수 (0이면 복습일 없음)
- **주기 길이**: 학습일 수 + 복습일 수 = 주기 길이

---

## 4주 플랜 작성 예시

### 시나리오 설정

#### 기본 정보

- **플랜 기간**: 2025-01-01 (수) ~ 2025-01-28 (화), 4주 (28일)
- **학습일/복습일 주기**: 6일 학습 + 1일 복습 = 7일 주기
- **학습 시간**: 10:00 ~ 19:00 (9시간)
- **자율 학습 시간**: 19:00 ~ 22:00 (3시간, 활성화)
- **점심식사**: 12:00 ~ 13:00 (제외)
- **학원 일정**: 수요일 14:00 ~ 17:00, 이동시간 60분 (13:00 ~ 18:00 제외)
- **제외일**: 2025-01-15 (수) - 휴가

#### 학생 정보

- **학생 수준**: 중위 (보정 계수 1.0)
- **전략과목**: 영어 (주 3일 배정), 국어 (주 3일 배정)
- **취약과목**: 수학 (전체 학습일 배정)

#### 교과 제약 조건

- **필수 교과**: 국어, 수학, 영어
- **제약 조건 처리**: strict (조건 불만족 시 플랜 생성 실패)

#### 교재/강의 정보

**수학 (취약과목)**

- 교재: "수학의 정석 기하와 벡터" (200페이지)
- 표준 소요시간: 페이지당 5분
- 취약과목 보정: ×1.2

**영어 (전략과목)**

- 교재: "영어 문법 완성" (150페이지)
- 강의: "영어 문법 기초 강의" (30강, 강의당 30분)
- 표준 소요시간: 교재 페이지당 4분, 강의 시청 + 복습
- 전략과목 보정: ×1.0

**국어 (전략과목)**

- 교재: "국어 독해 실전" (180페이지)
- 표준 소요시간: 페이지당 4분
- 전략과목 보정: ×1.0

---

### 주기별 학습일/복습일 계산

#### 1주기 (2025-01-01 ~ 2025-01-07)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-01 (수) | 학습일 | 주기 1일차 | 1주기 시작 |
| 2025-01-02 (목) | 학습일 | 주기 2일차 |            |
| 2025-01-03 (금) | 학습일 | 주기 3일차 |            |
| 2025-01-04 (토) | 학습일 | 주기 4일차 |            |
| 2025-01-05 (일) | 학습일 | 주기 5일차 |            |
| 2025-01-06 (월) | 학습일 | 주기 6일차 |            |
| 2025-01-07 (화) | 복습일 | 주기 7일차 | 1주기 완료 |

#### 2주기 (2025-01-08 ~ 2025-01-14)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-08 (수) | 학습일 | 주기 1일차 | 2주기 시작 |
| 2025-01-09 (목) | 학습일 | 주기 2일차 |            |
| 2025-01-10 (금) | 학습일 | 주기 3일차 |            |
| 2025-01-11 (토) | 학습일 | 주기 4일차 |            |
| 2025-01-12 (일) | 학습일 | 주기 5일차 |            |
| 2025-01-13 (월) | 학습일 | 주기 6일차 |            |
| 2025-01-14 (화) | 복습일 | 주기 7일차 | 2주기 완료 |

#### 3주기 (2025-01-15 ~ 2025-01-21)

| 날짜            | 유형   | 주기 일자  | 설명                  |
| --------------- | ------ | ---------- | --------------------- |
| 2025-01-15 (수) | 제외일 | -          | 휴가 (주기 계산 제외) |
| 2025-01-16 (목) | 학습일 | 주기 1일차 | 3주기 시작            |
| 2025-01-17 (금) | 학습일 | 주기 2일차 |                       |
| 2025-01-18 (토) | 학습일 | 주기 3일차 |                       |
| 2025-01-19 (일) | 학습일 | 주기 4일차 |                       |
| 2025-01-20 (월) | 학습일 | 주기 5일차 |                       |
| 2025-01-21 (화) | 학습일 | 주기 6일차 |                       |

#### 4주기 (2025-01-22 ~ 2025-01-28)

| 날짜            | 유형   | 주기 일자  | 설명       |
| --------------- | ------ | ---------- | ---------- |
| 2025-01-22 (수) | 복습일 | 주기 7일차 | 3주기 완료 |
| 2025-01-23 (목) | 학습일 | 주기 1일차 | 4주기 시작 |
| 2025-01-24 (금) | 학습일 | 주기 2일차 |            |
| 2025-01-25 (토) | 학습일 | 주기 3일차 |            |
| 2025-01-26 (일) | 학습일 | 주기 4일차 |            |
| 2025-01-27 (월) | 학습일 | 주기 5일차 |            |
| 2025-01-28 (화) | 학습일 | 주기 6일차 | 4주기 종료 |

**총 학습일**: 24일 (제외일 1일 제외, 복습일 3일 제외)  
**총 복습일**: 3일

---

### 학습 범위 분할

#### 수학 (취약과목) - 전체 학습일 배정

- **전체 범위**: 200페이지
- **학습일 수**: 24일
- **일일 범위**: 200페이지 ÷ 24일 = 약 8.3페이지/일
- **실제 배정**: 대부분 일일 8페이지, 일부 일일 9페이지 (총합 200페이지 맞춤)

#### 영어 (전략과목) - 주 3일 배정

- **전체 범위**: 교재 150페이지 + 강의 30강
- **주당 배정 일수**: 3일
- **4주 총 배정 일수**: 약 12일 (주당 3일 × 4주)
- **교재 일일 범위**: 150페이지 ÷ 12일 = 약 12.5페이지/일
- **강의 일일 범위**: 30강 ÷ 12일 = 약 2.5강/일
- **실제 배정**: 교재 일일 12~13페이지, 강의 일일 2~3강

#### 국어 (전략과목) - 주 3일 배정

- **전체 범위**: 180페이지
- **주당 배정 일수**: 3일
- **4주 총 배정 일수**: 약 12일
- **일일 범위**: 180페이지 ÷ 12일 = 15페이지/일

---

### 소요시간 계산

#### 수학 (취약과목) - 학습일

- **일일 범위**: 8페이지
- **일일 소요시간**: 8페이지 × 5분 × 1.0 (학생 수준) × 1.2 (취약과목) = **48분/일**
- **24일 총 소요시간**: 48분 × 24일 = 1,152분 (19.2시간)

#### 수학 (취약과목) - 복습일

- **직전 학습일(6일) 범위**: 8페이지 × 6일 = 48페이지
- **직전 학습일(6일) 소요시간**: 48페이지 × 5분 × 1.0 × 1.2 = 288분
- **복습 보정 계수**: 0.4 (40%)
- **복습일 소요시간**: 288분 × 0.4 = **115분/복습일**
- **3일 총 복습 소요시간**: 115분 × 3일 = 345분 (5.75시간)

#### 영어 (전략과목) - 학습일

- **교재 일일 범위**: 12페이지
- **교재 일일 소요시간**: 12페이지 × 4분 × 1.0 × 1.0 = **48분/일**
- **강의 일일 범위**: 2.5강
- **강의 일일 소요시간**: 2.5강 × 30분 (강의) + 15분 (복습) = **90분/일**
- **일일 총 소요시간**: 48분 + 90분 = **138분/일**
- **12일 총 소요시간**: 138분 × 12일 = 1,656분 (27.6시간)

#### 국어 (전략과목) - 학습일

- **일일 범위**: 15페이지
- **일일 소요시간**: 15페이지 × 4분 × 1.0 × 1.0 = **60분/일**
- **12일 총 소요시간**: 60분 × 12일 = 720분 (12시간)

---

### 타임라인 구성 예시 (2025-01-01, 수요일)

#### 입력 정보

- **날짜**: 2025-01-01 (수요일, 학습일, 주기 1일차)
- **학습 시간**: 10:00 ~ 19:00
- **자율 학습 시간**: 19:00 ~ 22:00
- **점심식사**: 12:00 ~ 13:00 (제외)
- **학원 일정**: 13:00 ~ 18:00 (14:00~17:00 학원 + 이동시간 60분, 제외)

#### 플랜 소요시간

- 수학: 48분
- 영어: 138분 (교재 48분 + 강의 90분)
- 국어: 60분
- **총 소요시간**: 246분 (4.1시간)

#### 배정 가능한 시간 계산

- **학습 시간대**: 10:00 ~ 19:00 (9시간 = 540분)
- **제외 시간**:
  - 점심식사: 12:00 ~ 13:00 (60분)
  - 학원 일정: 13:00 ~ 18:00 (300분)
- **실제 배정 가능한 시간**: 540분 - 60분 - 300분 = **180분**

#### 타임라인 구성 결과

**학습 시간대 배정**

- 10:00 ~ 10:48: 수학 (48분) - 취약과목 우선
- 10:48 ~ 11:36: 영어 교재 (48분) - 전략과목
- 11:36 ~ 12:00: 국어 (24분) - 전략과목 (일부)
- 12:00 ~ 13:00: 점심식사 (제외)
- 13:00 ~ 18:00: 학원 일정 (제외)
- 18:00 ~ 18:36: 국어 (36분) - 전략과목 (남은 부분)

**자율 학습 시간대 배정** (배정 가능한 시간 부족으로 사용)

- 19:00 ~ 20:30: 영어 강의 (90분) - 전략과목

**일일 타임라인 요약**

- 총 배정 플랜 수: 3개 (수학, 영어, 국어)
- 학습 시간대 총 학습 시간: 156분
- 자율 학습 시간대 총 학습 시간: 90분
- 총 학습 시간: 246분
- 배정 가능한 시간 대비 사용률: 100% (180분 사용, 자율 학습 시간 90분 추가 사용)

---

### 플랜 정보 예시

#### 2025-01-01 수학 플랜

```typescript
{
  // 기본 정보
  id: "plan_math_20250101",
  student_id: "student_001",
  date: "2025-01-01",
  date_type: "study",
  cycle_day_number: 1,

  // 시간 정보
  start_time: "10:00",
  end_time: "10:48",
  duration_minutes: 48,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    publisher: "성지출판",
    type: "참고서",
    difficulty_level: "중급",
    range: {
      start_page: 1,
      end_page: 8,
      chapters: [1],
      chapter_names: ["1단원: 벡터의 연산"]
    },
    total_pages: 200,
    total_chapters: 10,
    learning_goal: "벡터의 기본 연산을 이해하고 문제를 해결할 수 있다",
    recommendation_reason: "기하와 벡터 영역 성적이 낮아 기초 보완 필요"
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 40, // 8페이지 × 5분
    student_level_factor: 1.0,
    subject_factor: 1.2, // 취약과목
    difficulty_factor: 1.0,
    final_duration: 48
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1 // 일일 타임라인 내 첫 번째
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days" // 취약과목: 전체 학습일 배정
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

#### 2025-01-01 영어 플랜

```typescript
{
  // 기본 정보
  id: "plan_english_20250101",
  student_id: "student_001",
  date: "2025-01-01",
  date_type: "study",
  cycle_day_number: 1,

  // 시간 정보 (교재 부분)
  start_time: "10:48",
  end_time: "11:36",
  duration_minutes: 48,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_english",
    name: "영어",
    type: "strategy"
  },

  // 교재 정보
  textbook: {
    id: "textbook_english_001",
    name: "영어 문법 완성",
    publisher: "영어출판사",
    type: "문제집",
    difficulty_level: "중급",
    range: {
      start_page: 1,
      end_page: 12,
      chapters: [1],
      chapter_names: ["1단원: 문장의 구조"]
    },
    total_pages: 150,
    learning_goal: "영어 문장의 기본 구조를 이해한다",
    recommendation_reason: "문법 영역 향상 가능성 높음"
  },

  // 강의 정보 (자율 학습 시간대에 배정)
  lecture: {
    id: "lecture_english_001",
    name: "영어 문법 기초 강의",
    instructor: "김영어",
    type: "동영상",
    difficulty_level: "중급",
    range: {
      start_lecture_number: 1,
      end_lecture_number: 2,
      lectures: [
        { lecture_number: 1, title: "문장의 구조 1", duration_minutes: 30 },
        { lecture_number: 2, title: "문장의 구조 2", duration_minutes: 30 }
      ]
    },
    total_lectures: 30,
    average_duration_per_lecture: 30,
    total_lecture_duration: 60, // 2강 × 30분
    total_learning_duration: 90, // 강의 60분 + 복습 30분
    learning_goal: "영어 문장 구조를 강의로 이해하고 복습한다",
    recommendation_reason: "문법 영역 향상 가능성 높음"
  },

  // 교재/강의 조합 정보
  content_combination: {
    type: "textbook_and_lecture",
    learning_order: "textbook_first", // 교재 선학습 후 강의 시청
    matching_info: {
      textbook_range: "1~12페이지",
      matched_lectures: [1, 2]
    }
  },

  // 소요시간 정보 (교재 부분)
  duration_info: {
    base_duration: 48, // 12페이지 × 4분
    student_level_factor: 1.0,
    subject_factor: 1.0, // 전략과목
    difficulty_factor: 1.0,
    final_duration: 48
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 2, // 일일 타임라인 내 두 번째
    // 강의는 자율 학습 시간대에 별도 플랜으로 배정됨
  },

  // 배정 방식 정보
  allocation_type: {
    type: "weekly_days",
    weekly_days: 3 // 전략과목: 주 3일 배정
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

#### 2025-01-07 복습일 플랜 예시

```typescript
{
  // 기본 정보
  id: "plan_math_review_20250107",
  student_id: "student_001",
  date: "2025-01-07",
  date_type: "review",
  cycle_day_number: 7,

  // 시간 정보
  start_time: "10:00",
  end_time: "11:55",
  duration_minutes: 115,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보 (직전 6일간 학습 범위)
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    range: {
      start_page: 1,
      end_page: 48, // 직전 6일간 학습 범위 (8페이지 × 6일)
      chapters: [1, 2],
      chapter_names: ["1단원: 벡터의 연산", "2단원: 벡터의 내적"]
    },
    learning_goal: "직전 6일간 학습한 내용을 복습하여 이해도를 높인다"
  },

  // 복습일 소요시간 정보
  review_info: {
    previous_study_days_range: "2025-01-01 ~ 2025-01-06",
    previous_study_duration: 288, // 48페이지 × 5분 × 1.0 × 1.2
    review_factor: 0.4,
    review_duration: 115 // 288분 × 0.4
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 288,
    student_level_factor: 1.0,
    subject_factor: 1.2,
    difficulty_factor: 1.0,
    review_factor: 0.4,
    final_duration: 115
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days"
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-01-01T00:00:00Z",
  updated_at: "2025-01-01T00:00:00Z"
}
```

---

### 4주 플랜 요약

#### 전체 통계

- **플랜 기간**: 2025-01-01 ~ 2025-01-28 (28일)
- **총 학습일**: 24일
- **총 복습일**: 3일
- **제외일**: 1일

#### 과목별 통계

**수학 (취약과목)**

- 배정 일수: 24일 (학습일) + 3일 (복습일) = 27일
- 총 소요시간: 1,152분 (학습) + 345분 (복습) = 1,497분 (24.95시간)
- 학습 범위: 200페이지 전체

**영어 (전략과목)**

- 배정 일수: 12일 (주 3일 × 4주)
- 총 소요시간: 1,656분 (27.6시간)
- 학습 범위: 교재 150페이지 + 강의 30강

**국어 (전략과목)**

- 배정 일수: 12일 (주 3일 × 4주)
- 총 소요시간: 720분 (12시간)
- 학습 범위: 180페이지

#### 일일 평균 학습 시간

- **학습일 평균**: 약 246분 (4.1시간)
- **복습일 평균**: 약 115분 (1.9시간)
- **전체 평균**: 약 220분 (3.7시간)

#### 교과 제약 조건 검증 결과

- **필수 교과**: 국어, 수학, 영어
- **검증 결과**: ✅ 조건 만족
  - 국어: 포함됨 (전략과목, 교재 180페이지)
  - 수학: 포함됨 (취약과목, 교재 200페이지)
  - 영어: 포함됨 (전략과목, 교재 150페이지 + 강의 30강)
- **모든 필수 교과가 플랜에 포함되어 조건을 만족함**

---

## 추가 기간 학습 범위 재배치 예시

### 시나리오 설정

#### 기본 정보

- **원본 플랜 기간**: 2025-01-01 ~ 2025-01-28 (4주)
- **추가 기간**: 2025-02-01 (토) ~ 2025-02-07 (금), 1주 (7일)
- **학습일/복습일 주기**: 6일 학습 + 1일 복습 = 7일 주기
- **학습 시간**: 10:00 ~ 19:00 (9시간)
- **자율 학습 시간**: 19:00 ~ 22:00 (3시간, 활성화)
- **점심식사**: 12:00 ~ 13:00 (제외)

#### 재배치 대상

- **원본 플랜**: 4주 플랜 (2025-01-01 ~ 2025-01-28)
- **재배치 과목**: 수학 (취약과목)
- **재배치 범위**: 전체 학습 범위 (200페이지)
- **복습의 복습 보정 계수**: 0.25 (25%)

#### 원본 플랜 정보 (수학)

- **학습일**: 24일
- **복습일**: 3일
- **학습 범위**: 200페이지
- **학습 소요시간**: 1,152분 (48분/일 × 24일)
- **복습 소요시간**: 345분 (115분/복습일 × 3일)

---

### 추가 기간 주기별 학습일/복습일 계산

#### 추가 기간 1주기 (2025-02-01 ~ 2025-02-07)

| 날짜            | 유형   | 주기 일자  | 설명           |
| --------------- | ------ | ---------- | -------------- |
| 2025-02-01 (토) | 학습일 | 주기 1일차 | 추가 기간 시작 |
| 2025-02-02 (일) | 학습일 | 주기 2일차 |                |
| 2025-02-03 (월) | 학습일 | 주기 3일차 |                |
| 2025-02-04 (화) | 학습일 | 주기 4일차 |                |
| 2025-02-05 (수) | 학습일 | 주기 5일차 |                |
| 2025-02-06 (목) | 학습일 | 주기 6일차 |                |
| 2025-02-07 (금) | 복습일 | 주기 7일차 | 추가 기간 완료 |

**총 학습일**: 6일  
**총 복습일**: 1일

---

### 추가 기간 학습 범위 분할

#### 수학 (취약과목) - 전체 학습일 배정

- **전체 범위**: 200페이지 (원본과 동일)
- **학습일 수**: 6일
- **일일 범위**: 200페이지 ÷ 6일 = 약 33.3페이지/일
- **실제 배정**: 대부분 일일 33페이지, 일부 일일 34페이지 (총합 200페이지 맞춤)

---

### 추가 기간 소요시간 계산

#### 수학 (취약과목) - 학습일

- **일일 범위**: 33페이지
- **원본 일일 학습 소요시간**: 48분/일 (8페이지 × 5분 × 1.0 × 1.2)
- **복습의 복습 보정 계수**: 0.25 (25%)
- **추가 복습 일일 소요시간**: 48분 × 0.25 = **12분/일**
- **6일 총 소요시간**: 12분 × 6일 = **72분**

#### 수학 (취약과목) - 복습일

- **직전 학습일(6일) 범위**: 33페이지 × 6일 = 약 200페이지 (전체)
- **직전 학습일(6일) 소요시간**: 12분 × 6일 = 72분
- **복습 보정 계수**: 0.4 (40%)
- **복습의 복습 보정 계수**: 0.25 (25%)
- **추가 복습일 소요시간**: 72분 × 0.4 × 0.25 = **7.2분** (약 7분)

---

### 추가 기간 타임라인 구성 예시 (2025-02-01, 토요일)

#### 입력 정보

- **날짜**: 2025-02-01 (토요일, 학습일, 주기 1일차)
- **학습 시간**: 10:00 ~ 19:00
- **자율 학습 시간**: 19:00 ~ 22:00
- **점심식사**: 12:00 ~ 13:00 (제외)

#### 플랜 소요시간

- 수학: 12분
- **총 소요시간**: 12분

#### 배정 가능한 시간 계산

- **학습 시간대**: 10:00 ~ 19:00 (9시간 = 540분)
- **제외 시간**:
  - 점심식사: 12:00 ~ 13:00 (60분)
- **실제 배정 가능한 시간**: 540분 - 60분 = **480분**

#### 타임라인 구성 결과

**학습 시간대 배정**

- 10:00 ~ 10:12: 수학 (12분) - 추가 복습

**일일 타임라인 요약**

- 총 배정 플랜 수: 1개 (수학)
- 학습 시간대 총 학습 시간: 12분
- 총 학습 시간: 12분
- 배정 가능한 시간 대비 사용률: 2.5% (12분 사용)

---

### 추가 기간 플랜 정보 예시

#### 2025-02-01 수학 플랜 (재배치)

```typescript
{
  // 기본 정보
  id: "plan_math_reallocated_20250201",
  student_id: "student_001",
  date: "2025-02-01",
  date_type: "study",
  cycle_day_number: 1,

  // 시간 정보
  start_time: "10:00",
  end_time: "10:12",
  duration_minutes: 12,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보 (원본과 동일한 범위)
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    publisher: "성지출판",
    type: "참고서",
    difficulty_level: "중급",
    range: {
      start_page: 1,
      end_page: 33,
      chapters: [1, 2, 3],
      chapter_names: ["1단원: 벡터의 연산", "2단원: 벡터의 내적", "3단원: 벡터의 외적"]
    },
    total_pages: 200,
    total_chapters: 10,
    learning_goal: "이전에 학습한 내용을 추가로 복습하여 이해도를 더욱 높인다",
    recommendation_reason: "기하와 벡터 영역 성적이 낮아 추가 복습 필요"
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 165, // 33페이지 × 5분
    student_level_factor: 1.0,
    subject_factor: 1.2, // 취약과목
    difficulty_factor: 1.0,
    review_of_review_factor: 0.25, // 복습의 복습 보정 계수
    final_duration: 12 // 165분 × 1.0 × 1.2 × 0.25 = 약 12분
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days" // 취약과목: 전체 학습일 배정
  },

  // 추가 기간 재배치 정보
  reallocation_info: {
    is_reallocated: true,
    original_plan_id: "plan_math_20250101", // 원본 플랜 ID 참조
    original_period_start: "2025-01-01",
    original_period_end: "2025-01-28",
    review_of_review_factor: 0.25
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-02-01T00:00:00Z",
  updated_at: "2025-02-01T00:00:00Z"
}
```

#### 2025-02-07 복습일 플랜 예시 (재배치)

```typescript
{
  // 기본 정보
  id: "plan_math_reallocated_review_20250207",
  student_id: "student_001",
  date: "2025-02-07",
  date_type: "review",
  cycle_day_number: 7,

  // 시간 정보
  start_time: "10:00",
  end_time: "10:07",
  duration_minutes: 7,
  time_slot_type: "study",

  // 과목 정보
  subject: {
    id: "subject_math",
    name: "수학",
    type: "weakness"
  },

  // 교재 정보 (직전 6일간 학습 범위)
  textbook: {
    id: "textbook_math_001",
    name: "수학의 정석 기하와 벡터",
    range: {
      start_page: 1,
      end_page: 200, // 직전 6일간 학습 범위 (전체)
      chapters: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
      chapter_names: ["전체 단원"]
    },
    learning_goal: "이전에 학습한 내용을 추가로 복습하여 이해도를 더욱 높인다"
  },

  // 복습일 소요시간 정보
  review_info: {
    previous_study_days_range: "2025-02-01 ~ 2025-02-06",
    previous_study_duration: 72, // 12분 × 6일
    review_factor: 0.4,
    review_of_review_factor: 0.25,
    review_duration: 7 // 72분 × 0.4 × 0.25 = 7.2분 (약 7분)
  },

  // 소요시간 정보
  duration_info: {
    base_duration: 72,
    student_level_factor: 1.0,
    subject_factor: 1.2,
    difficulty_factor: 1.0,
    review_factor: 0.4,
    review_of_review_factor: 0.25,
    final_duration: 7
  },

  // 타임라인 정보
  timeline: {
    time_slot_type: "study",
    order: 1
  },

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days"
  },

  // 추가 기간 재배치 정보
  reallocation_info: {
    is_reallocated: true,
    original_plan_id: "plan_math_20250101",
    original_period_start: "2025-01-01",
    original_period_end: "2025-01-28",
    review_of_review_factor: 0.25
  },

  // 상태 정보
  status: "scheduled",
  progress_percentage: 0,

  // 메타 정보
  created_at: "2025-02-01T00:00:00Z",
  updated_at: "2025-02-01T00:00:00Z"
}
```

---

### 추가 기간 플랜 요약

#### 전체 통계

- **추가 기간**: 2025-02-01 ~ 2025-02-07 (7일)
- **총 학습일**: 6일
- **총 복습일**: 1일

#### 과목별 통계

**수학 (취약과목)**

- 배정 일수: 6일 (학습일) + 1일 (복습일) = 7일
- 총 소요시간: 72분 (학습) + 7분 (복습) = **79분** (1.3시간)
- 학습 범위: 200페이지 전체 (원본과 동일)
- **원본 대비 소요시간 감소**: 1,497분 → 79분 (약 94.7% 감소)

#### 일일 평균 학습 시간

- **학습일 평균**: 약 12분
- **복습일 평균**: 약 7분
- **전체 평균**: 약 11.3분

#### 소요시간 비교

| 구분          | 원본 플랜 | 추가 기간 재배치 | 감소율 |
| ------------- | --------- | ---------------- | ------ |
| 학습 소요시간 | 1,152분   | 72분             | 93.8%  |
| 복습 소요시간 | 345분     | 7분              | 98.0%  |
| 총 소요시간   | 1,497분   | 79분             | 94.7%  |

---

## 데이터 구조

### 플랜 생성 요청 데이터 구조

```typescript
type PlanCreationRequest = {
  // 1. 기간 정보
  period: {
    period_start: string; // YYYY-MM-DD
    period_end: string; // YYYY-MM-DD
  };

  // 2. 학습 시간 설정
  study_hours: {
    start_time: string; // HH:mm
    end_time: string; // HH:mm
  };

  // 3. 자율학습 시간 설정 (선택)
  self_study_hours?: {
    enabled: boolean;
    start_time: string; // HH:mm
    end_time: string; // HH:mm
    allow_on_holiday?: boolean; // 지정휴일에 자율학습 시간 배정 여부
  };

  // 4. 학습 제외일 설정 (선택)
  exclusions?: Exclusion[];

  // 5. 학원 일정 설정 (선택)
  academy_schedules?: AcademySchedule[];

  // 6. 학습 시간 제외 항목 설정 (선택)
  non_study_time_blocks?: NonStudyTimeBlock[];

  // 7. 학습일/복습일 주기 설정
  study_review_cycle: {
    study_days: number; // 학습일 수 (기본값: 6)
    review_days: number; // 복습일 수 (기본값: 1)
  };

  // 8. 교과 제약 조건 (선택)
  subject_constraints?: {
    required_subjects?: string[]; // 필수 교과 목록
    excluded_subjects?: string[]; // 제외 교과 목록
    constraint_handling: "strict" | "warning" | "auto_fix";
  };

  // 9. 추가 기간 재배치 설정 (선택)
  additional_period_reallocation?: {
    period_start: string; // YYYY-MM-DD
    period_end: string; // YYYY-MM-DD
    type: "additional_review"; // 추가 복습
    original_period_start: string; // 원본 플랜 기간 시작일
    original_period_end: string; // 원본 플랜 기간 종료일
    subjects?: string[]; // 재배치할 과목 목록 (없으면 전체)
    review_of_review_factor?: number; // 복습의 복습 보정 계수 (기본값: 0.25)
  };
};
```

### 플랜 데이터 구조

```typescript
type Plan = {
  // 기본 정보
  id: string;
  student_id: string;
  date: string; // YYYY-MM-DD
  date_type: "study" | "review" | "exclusion";
  cycle_day_number: number;

  // 시간 정보
  start_time: string; // HH:mm
  end_time: string; // HH:mm
  duration_minutes: number;
  time_slot_type: "study" | "self_study";

  // 과목 정보
  subject: {
    id: string;
    name: string;
    type: "strategy" | "weakness";
  };

  // 교재 정보
  textbook?: {
    id: string;
    name: string;
    publisher?: string;
    type?: string;
    difficulty_level?: string;
    range: {
      start_page?: number;
      end_page?: number;
      chapters?: number[];
      chapter_names?: string[];
    };
    total_pages?: number;
    total_chapters?: number;
    learning_goal: string;
    recommendation_reason?: string;
  };

  // 강의 정보
  lecture?: {
    id: string;
    name: string;
    instructor?: string;
    type?: string;
    difficulty_level?: string;
    range: {
      start_lecture_number: number;
      end_lecture_number: number;
      lectures?: Array<{
        lecture_number: number;
        title: string;
        duration_minutes: number;
      }>;
    };
    total_lectures: number;
    average_duration_per_lecture?: number;
    total_lecture_duration?: number;
    total_learning_duration?: number;
    learning_goal: string;
    recommendation_reason?: string;
  };

  // 교재/강의 조합 정보
  content_combination?: {
    type: "textbook_only" | "lecture_only" | "textbook_and_lecture";
    learning_order?: "textbook_first" | "lecture_first" | "parallel";
    matching_info?: {
      textbook_range: string;
      matched_lectures: number[];
    };
  };

  // 소요시간 정보
  duration_info: {
    base_duration: number;
    student_level_factor: number;
    subject_factor: number;
    difficulty_factor: number;
    review_factor?: number; // 복습일인 경우
    final_duration: number;
  };

  // 복습일 정보 (복습일인 경우)
  review_info?: {
    previous_study_days_range: string;
    previous_study_duration: number;
    review_factor: number;
    review_duration: number;
  };

  // 타임라인 정보
  timeline: {
    time_slot_type: "study" | "self_study";
    order: number; // 일일 타임라인 내 순서
    // 분할된 플랜 정보 (제외 시간으로 인해 분할된 경우)
    split_info?: {
      original_plan_id: string; // 원본 플랜 ID (분할된 플랜들을 연결)
      split_order: number; // 원본 플랜 내에서의 분할 순서
      total_split_count: number; // 전체 분할 개수
      total_duration: number; // 전체 소요시간 (모든 분할된 시간대의 합)
    };
  };

  // 배정 방식 정보
  allocation_type: {
    type: "all_study_days" | "weekly_days";
    weekly_days?: number; // 전략과목인 경우 주당 배정 일수
  };

  // 추가 기간 재배치 정보 (추가 기간 재배치인 경우)
  reallocation_info?: {
    is_reallocated: boolean; // 재배치된 플랜 여부
    original_plan_id?: string; // 원본 플랜 ID
    original_period_start?: string; // 원본 플랜 기간 시작일
    original_period_end?: string; // 원본 플랜 기간 종료일
    review_of_review_factor?: number; // 복습의 복습 보정 계수
  };

  // 상태 정보
  status: "scheduled" | "in_progress" | "completed" | "paused";
  progress_percentage: number;
  started_at?: string;
  completed_at?: string;
  paused_at?: string;
  resumed_at?: string;

  // 메타 정보
  created_at: string;
  updated_at: string;
};
```

---

## 변경 이력

- 2025-01-XX: 문서 생성
- 2025-01-XX: 추가 기간 학습 범위 재배치 시스템 요구사항 추가 (복습의 복습)
