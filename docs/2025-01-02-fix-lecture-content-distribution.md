# ê°•ì˜ ì½˜í…ì¸  ë°°ì¹˜ ë¡œì§ ê°œì„ 

## ğŸ“‹ ë¬¸ì œì 

í”Œëœ ê·¸ë£¹ ìƒì„± ì‹œ ê°•ì˜ ì½˜í…ì¸  ë°°ì¹˜ ê´€ë ¨ ë¬¸ì œ:

1. **ë¬¸ì œ**: ê°•ì˜ ì½˜í…ì¸ ì˜ ì—í”¼ì†Œë“œê°€ 23ê°œì¸ë°, í•™ìŠµ ì‹œê°„ì˜ ì—¬ìœ ê°€ ìˆë‹¤ê³  í•™ìŠµ ê¸°ê°„ê³¼ ìƒê´€ì—†ì´ íšŒì°¨ë¥¼ ëª¨ë‘ ë‚ ì§œë³„ì— ëª°ì•„ì„œ ë„£ì–´ì„œ í”Œëœ ë°°ì¹˜ê°€ ì•ˆë˜ëŠ” í•™ìŠµì¼ ë°œìƒ
2. **í˜„ì¬ ë™ì‘**: ì£¼ ë‹¨ìœ„ë¡œ ë°˜ë³µí•´ì„œ íšŒì°¨ë¥¼ ëª°ì•„ë„£ê³  ë³µìŠµì¼ì„ ì§„í–‰í•˜ëŠ” ë°©ì‹

## ğŸ¯ ìš”êµ¬ì‚¬í•­

- í•™ìŠµì¼ì´ 30ì¼ì´ê³  íšŒì°¨ê°€ 30ê°œë©´ í•˜ë£¨ 1ê°œì”© ë¶„ë°°
- í•™ìŠµì¼ì˜ ì—¬ìœ ê°€ ì—†ë‹¤ë©´ ê°€ëŠ¥í•œ ì—°ì† ê³ ë ¤

## ğŸ”§ ìˆ˜ì • ë‚´ìš©

### íŒŒì¼
- `lib/scheduler/SchedulerEngine.ts` - `distributeContentWithCapacity` ë©”ì„œë“œ

### ë³€ê²½ ì‚¬í•­

**ê°•ì˜ ì½˜í…ì¸  ê· ë“± ë¶„ë°° ë¡œì§ ì¶”ê°€**

ê¸°ì¡´ì—ëŠ” capacity(ì‹œê°„ ì—¬ìœ )ì— ë”°ë¼ ê°€ëŠ¥í•œ ë§ì€ íšŒì°¨ë¥¼ ëª°ì•„ë„£ëŠ” ë°©ì‹ì´ì—ˆìœ¼ë‚˜, ê°•ì˜ ì½˜í…ì¸ ì˜ ê²½ìš° í•™ìŠµì¼ ìˆ˜ì— ë§ì¶° ê· ë“± ë¶„ë°°í•˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

```typescript
// ê°•ì˜ ì½˜í…ì¸ ì˜ ê²½ìš°: í•™ìŠµì¼ ìˆ˜ì— ë§ì¶° ê· ë“± ë¶„ë°°
if (content.content_type === "lecture" && durationInfo.episodes && totalStudyDays > 0 && totalRange > 0) {
  const dailyRange = totalRange / totalStudyDays;
  let currentPos = 0; // 0ë¶€í„° ì‹œì‘í•˜ëŠ” ìƒëŒ€ ìœ„ì¹˜
  
  for (let i = 0; i < sortedDates.length; i++) {
    const date = sortedDates[i];
    const isLastDay = i === sortedDates.length - 1;
    
    // ë§ˆì§€ë§‰ ë‚ ì´ ì•„ë‹ˆë©´ dailyRangeë¥¼ ë°˜ì˜¬ë¦¼, ë§ˆì§€ë§‰ ë‚ ì´ë©´ ë‚¨ì€ ëª¨ë“  íšŒì°¨ ë°°ì •
    const dayRange = isLastDay
      ? totalRange - currentPos
      : Math.round(dailyRange);
    
    const dayEnd = currentPos + dayRange;
    
    // ì‹¤ì œ íšŒì°¨ ë²”ìœ„ (start_range ì˜¤í”„ì…‹ ì ìš©)
    const actualStart = content.start_range + Math.round(currentPos);
    const actualEnd = content.start_range + Math.round(dayEnd);
    
    // íšŒì°¨ê°€ ìˆëŠ” ê²½ìš°ë§Œ ë°°ì •
    if (actualEnd > actualStart) {
      result.set(date, { start: actualStart, end: actualEnd });
    }
    
    // ë‹¤ìŒ ë‚ ì„ ìœ„í•´ í˜„ì¬ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    currentPos = dayEnd;
  }
  
  return result;
}
```

**ìˆ˜ì • ì‚¬í•­ (2025-01-02 ì—…ë°ì´íŠ¸)**:
- ê¸°ì¡´: `currentPos`ë¥¼ ëˆ„ì í•˜ë©´ì„œ ë§¤ë²ˆ `Math.round`ë¥¼ ì ìš©í•˜ì—¬ ì˜¤ì°¨ê°€ ëˆ„ì ë¨
- ìˆ˜ì •: ê° ë‚ ì§œì˜ ë°°ì • ë²”ìœ„ë¥¼ ì§ì ‘ ê³„ì‚° (`Math.round(i * dailyRange)`)í•˜ì—¬ ì˜¤ì°¨ ëˆ„ì  ë°©ì§€
- íšŒì°¨ ì¤‘ë³µ ë°°ì •, ëˆ„ë½, ì²« ì£¼ ë§ˆì§€ë§‰ ë‚  ëª°ì•„ ë°°ì • ë¬¸ì œ í•´ê²°

**ìµœì¢… ìˆ˜ì • (2025-01-02 ì¬ìˆ˜ì •)**:
- `divideContentRange` íŒ¨í„´ì„ ì •í™•íˆ ë”°ë¦„ (currentPosë¥¼ ëˆ„ì í•˜ëŠ” ë°©ì‹)
- ê° ë‚ ì§œì˜ dayRangeë¥¼ ê³„ì‚°í•˜ê³  currentPosë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ì—°ì†ì„± ë³´ì¥
- `Math.round`ëŠ” dayRange ê³„ì‚°ì—ë§Œ ì‚¬ìš©í•˜ê³ , currentPosì™€ dayEndëŠ” ì´ë¯¸ ì •ìˆ˜ì´ë¯€ë¡œ Math.round ë¶ˆí•„ìš”
- ì£¼ì°¨ ê²½ê³„ì—ì„œ íšŒì°¨ ì¬ë°°ì • ë¬¸ì œ í•´ê²°
- ì˜¤ì°¨ ëˆ„ì  ì—†ì´ ì •í™•í•œ íšŒì°¨ ë¶„ë°° ë³´ì¥

**ì—í”¼ì†Œë“œ ìˆ˜ ì œí•œ ì¶”ê°€ (2025-01-02 ìµœì¢…)**:
- ì‹¤ì œ ì¡´ì¬í•˜ëŠ” ì—í”¼ì†Œë“œ ìˆ˜ë¥¼ í™•ì¸í•˜ì—¬ `content.end_range` ì œí•œ
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íšŒì°¨(ì˜ˆ: íšŒì°¨ 25ê°€ ë°°ì •ë˜ëŠ” ë¬¸ì œ) ë°°ì • ë°©ì§€
- `durationInfo.episodes`ì—ì„œ ìµœëŒ€ episode_numberë¥¼ ì°¾ì•„ ë²”ìœ„ ì œí•œ
- `end_range`ëŠ” exclusiveì´ë¯€ë¡œ `maxEpisodeNumber + 1`ë¡œ ì œí•œ

**ì£¼ì°¨ë³„ ë²”ìœ„ ì‚¬ìš© ìˆ˜ì • (2025-01-02 ìµœì¢…)**:
- ë¬¸ì œ: `rangeMap`ì€ ì „ì²´ ê¸°ê°„ì˜ ëª¨ë“  í•™ìŠµì¼ì— ëŒ€í•´ ìƒì„±ë˜ì§€ë§Œ, ì£¼ì°¨ë³„ë¡œ í˜¸ì¶œ ì‹œ ë‹¤ë¥¸ ì£¼ì°¨ì˜ ë²”ìœ„ê¹Œì§€ í˜„ì¬ ì£¼ì°¨ì— ì¶”ê°€ë˜ì–´ íšŒì°¨ ì¤‘ë³µ ë°°ì • ë°œìƒ
- í•´ê²°: `generateStudyDayPlans`ì—ì„œ í˜„ì¬ ì£¼ì°¨ì˜ í•™ìŠµì¼ì— í•´ë‹¹í•˜ëŠ” `rangeMap` í•­ëª©ë§Œ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •
- ë‹¤ë¥¸ ì£¼ì°¨ì˜ ë²”ìœ„ëŠ” ë¬´ì‹œí•˜ì—¬ íšŒì°¨ ì¤‘ë³µ ë°°ì • ë¬¸ì œ í•´ê²°

### ë™ì‘ ë°©ì‹

1. **í•™ìŠµì¼ ìˆ˜ >= ì´ íšŒì°¨ ìˆ˜ì¸ ê²½ìš°**
   - ì˜ˆ: í•™ìŠµì¼ 30ì¼, íšŒì°¨ 30ê°œ â†’ í•˜ë£¨ 1ê°œì”© ë¶„ë°°
   - `dailyRange = 30 / 30 = 1` â†’ ê° ë‚ ì§œì— 1ê°œì”© ë°°ì¹˜

2. **í•™ìŠµì¼ ìˆ˜ < ì´ íšŒì°¨ ìˆ˜ì¸ ê²½ìš°**
   - ì˜ˆ: í•™ìŠµì¼ 15ì¼, íšŒì°¨ 30ê°œ â†’ í•˜ë£¨ 2ê°œì”© ë¶„ë°°
   - `dailyRange = 30 / 15 = 2` â†’ ê° ë‚ ì§œì— 2ê°œì”© ë°°ì¹˜

3. **êµì¬ ë° ì»¤ìŠ¤í…€ ì½˜í…ì¸ **
   - ê¸°ì¡´ capacity-aware ë¡œì§ ìœ ì§€ (ì‹œê°„ ì—¬ìœ ì— ë”°ë¼ ë°°ì¹˜)

## âœ… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

1. **ì‹œë‚˜ë¦¬ì˜¤ 1**: í•™ìŠµì¼ 30ì¼, íšŒì°¨ 30ê°œ
   - ì˜ˆìƒ ê²°ê³¼: ê° í•™ìŠµì¼ì— 1ê°œì”© ë°°ì¹˜

2. **ì‹œë‚˜ë¦¬ì˜¤ 2**: í•™ìŠµì¼ 15ì¼, íšŒì°¨ 30ê°œ
   - ì˜ˆìƒ ê²°ê³¼: ê° í•™ìŠµì¼ì— 2ê°œì”© ë°°ì¹˜

3. **ì‹œë‚˜ë¦¬ì˜¤ 3**: í•™ìŠµì¼ 30ì¼, íšŒì°¨ 23ê°œ
   - ì˜ˆìƒ ê²°ê³¼: ì²« 23ì¼ì—ëŠ” 1ê°œì”©, ë‚˜ë¨¸ì§€ 7ì¼ì—ëŠ” ë°°ì¹˜ ì—†ìŒ

## ğŸ“ ì°¸ê³ ì‚¬í•­

- êµì¬ ë° ì»¤ìŠ¤í…€ ì½˜í…ì¸ ëŠ” ê¸°ì¡´ capacity-aware ë¡œì§ì„ ìœ ì§€í•˜ì—¬ ì‹œê°„ ì—¬ìœ ì— ë”°ë¼ ë°°ì¹˜ë©ë‹ˆë‹¤
- ê°•ì˜ ì½˜í…ì¸ ë§Œ í•™ìŠµì¼ ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ê· ë“± ë¶„ë°°ë©ë‹ˆë‹¤
- `generateStudyDayPlans`ì—ì„œ episodeë³„ë¡œ ë¶„í• í•˜ëŠ” ë¡œì§ì€ ìœ ì§€ë©ë‹ˆë‹¤

## ğŸ”— ê´€ë ¨ íŒŒì¼

- `lib/scheduler/SchedulerEngine.ts` - ìŠ¤ì¼€ì¤„ëŸ¬ ì—”ì§„
- `lib/plan/1730TimetableLogic.ts` - `divideContentRange` í•¨ìˆ˜ (ì°¸ê³ )
- `app/(student)/actions/plan-groups/generatePlansRefactored.ts` - í”Œëœ ìƒì„± ì•¡ì…˜

---

**ì‘ì—…ì¼**: 2025-01-02
