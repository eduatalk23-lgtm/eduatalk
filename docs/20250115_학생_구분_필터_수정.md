# 학생 구분 필터 수정 (2025-01-15)

## 문제점
- 고등부 구분 학생이 있는데 "등록된 학생이 없습니다"라고 표시되는 문제
- "전체" 필터를 선택했을 때 division이 null인 학생만 조회되는 버그

## 원인 분석
1. `getStudentsByDivision` 함수에서 `division === null`일 때 division이 null인 학생만 조회
2. 페이지에서 "all" 필터일 때 `null`을 전달하여 잘못된 필터링 발생
3. 통계 조회는 모든 학생을 조회하지만, 학생 목록 조회는 division이 null인 학생만 조회하여 불일치 발생

## 수정 내용

### 1. `lib/data/students.ts` - `getStudentsByDivision` 함수 수정
- 타입 시그니처 변경: `division: StudentDivision | null | undefined`
- `undefined`를 전달하면 모든 학생 조회하도록 수정
- JSDoc 주석 추가

```typescript
/**
 * 구분별 학생 목록 조회
 * @param division - 구분 필터 (undefined: 전체, null: 미설정, "고등부"|"중등부"|"기타": 특정 구분)
 */
export async function getStudentsByDivision(
  division: StudentDivision | null | undefined
): Promise<Student[]> {
  // ...
  // undefined인 경우 모든 학생 조회 (필터 없음)
  if (division !== undefined) {
    if (division !== null) {
      query = query.eq("division", division);
    } else {
      query = query.is("division", null);
    }
  }
  // ...
}
```

### 2. `app/(admin)/admin/students/divisions/page.tsx` - 페이지 로직 수정
- "all" 필터일 때 `undefined`를 전달하도록 수정
- 기존: `divisionFilter === "all" ? null : divisionFilter`
- 수정: `divisionFilter === "all" ? undefined : divisionFilter`

## 수정 결과
- ✅ "전체" 필터 선택 시 모든 학생 조회
- ✅ "미설정" 필터 선택 시 division이 null인 학생만 조회
- ✅ 특정 구분 필터 선택 시 해당 구분 학생만 조회
- ✅ 통계와 학생 목록 조회가 일관성 있게 동작

## 테스트 항목
- [x] "전체" 필터 선택 시 모든 학생 조회 확인
- [x] "미설정" 필터 선택 시 division이 null인 학생만 조회 확인
- [x] "고등부" 필터 선택 시 고등부 학생만 조회 확인
- [x] "중등부" 필터 선택 시 중등부 학생만 조회 확인
- [x] "기타" 필터 선택 시 기타 학생만 조회 확인
- [x] 통계 카드와 학생 목록 일관성 확인

## 관련 파일
- `lib/data/students.ts`
- `app/(admin)/admin/students/divisions/page.tsx`





