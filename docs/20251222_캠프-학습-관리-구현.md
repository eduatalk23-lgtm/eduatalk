# ìº í”„ í•™ìŠµ ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

## ğŸ“‹ êµ¬í˜„ ì™„ë£Œ ì‚¬í•­

### Phase 1: ë°ì´í„° ë ˆì´ì–´ ë° API âœ…

#### 1. íƒ€ì… ì •ì˜ ì¶”ê°€ âœ…

**íŒŒì¼**: `lib/types/camp/learning.ts`

- `DatePlanDetail`: ë‚ ì§œë³„ í”Œëœ ìƒì„¸ ì •ë³´ íƒ€ì…
- `PlanWithStudent`: í•™ìƒ ì •ë³´ê°€ í¬í•¨ëœ í”Œëœ íƒ€ì…
- `DateLearningProgress`: ë‚ ì§œë³„ í•™ìŠµ ì§„í–‰ë¥  ì •ë³´ íƒ€ì…

#### 2. ë°ì´í„° ë ˆì´ì–´ êµ¬í˜„ âœ…

**íŒŒì¼**: `lib/data/campLearning.ts`

êµ¬í˜„ëœ í•¨ìˆ˜:
- `getCampLearningRecords()`: ìº í”„ ê¸°ê°„ í•™ìŠµ ê¸°ë¡ ì¡°íšŒ (í•™ìƒ ì •ë³´ í¬í•¨)
- `getCampDatePlans()`: íŠ¹ì • ë‚ ì§œì˜ í”Œëœ ìƒì„¸ ì¡°íšŒ
- `getCampStudentPlans()`: í•™ìƒë³„ í•™ìŠµ í”Œëœ ì¡°íšŒ

**ìµœì í™” ì‚¬í•­**:
- ë°°ì¹˜ ì¡°íšŒë¡œ N+1 ë¬¸ì œ ë°©ì§€
- í•„ìš”í•œ ì»¬ëŸ¼ë§Œ SELECT
- ë‚ ì§œ ë²”ìœ„ ì¸ë±ìŠ¤ í™œìš©
- ì½˜í…ì¸  ì •ë³´ ë°°ì¹˜ ì¡°íšŒ

#### 3. API ë¼ìš°íŠ¸ êµ¬í˜„ âœ…

**íŒŒì¼ë“¤**:
- `app/api/camp-learning/date/[date]/route.ts`: ë‚ ì§œë³„ í”Œëœ ì¡°íšŒ API
- `app/api/camp-learning/students/[studentId]/route.ts`: í•™ìƒë³„ í•™ìŠµ í†µê³„ API
- `app/api/camp-learning/records/route.ts`: ìº í”„ ê¸°ê°„ í•™ìŠµ ê¸°ë¡ ì¡°íšŒ API

### Phase 2: React Query í†µí•© âœ…

#### 4. ì¿¼ë¦¬ ì˜µì…˜ êµ¬í˜„ âœ…

**íŒŒì¼**: `lib/query-options/campLearning.ts`

êµ¬í˜„ëœ ì¿¼ë¦¬ ì˜µì…˜:
- `campLearningStatsQueryOptions()`: ìº í”„ í•™ìŠµ í†µê³„ ì¿¼ë¦¬ ì˜µì…˜
- `campDatePlansQueryOptions()`: ë‚ ì§œë³„ í”Œëœ ì¡°íšŒ ì¿¼ë¦¬ ì˜µì…˜
- `campLearningRecordsQueryOptions()`: ìº í”„ ê¸°ê°„ í•™ìŠµ ê¸°ë¡ ì¡°íšŒ ì¿¼ë¦¬ ì˜µì…˜
- `campStudentLearningStatsQueryOptions()`: í•™ìƒë³„ í•™ìŠµ í†µê³„ ì¿¼ë¦¬ ì˜µì…˜

**ìºì‹œ ì „ëµ**:
- í†µê³„: `staleTime: 5ë¶„`, `gcTime: 30ë¶„`
- ë‚ ì§œë³„ í”Œëœ: `staleTime: 1ë¶„`, `gcTime: 10ë¶„`

#### 5. React Query í›… êµ¬í˜„ âœ…

**íŒŒì¼**: `lib/hooks/useCampLearning.ts`

êµ¬í˜„ëœ í›…:
- `useCampLearningStats()`: ìº í”„ í•™ìŠµ í†µê³„ ì¡°íšŒ í›…
- `useCampDatePlans()`: ë‚ ì§œë³„ í”Œëœ ì¡°íšŒ í›…
- `useCampLearningRecords()`: ìº í”„ ê¸°ê°„ í•™ìŠµ ê¸°ë¡ ì¡°íšŒ í›…
- `useCampStudentLearningStats()`: í•™ìƒë³„ í•™ìŠµ í†µê³„ ì¡°íšŒ í›…

### Phase 3: UI ì»´í¬ë„ŒíŠ¸ âœ…

#### 6. ë©”ì¸ ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/CampLearningDashboard.tsx`

êµ¬ì„± ìš”ì†Œ:
- Header (í…œí”Œë¦¿ëª…, ë„¤ë¹„ê²Œì´ì…˜)
- ìº í”„ ê¸°ê°„ ì •ë³´
- í•™ìŠµ ë‹¬ë ¥ (`CampLearningCalendar`)
- í•™ìŠµ í†µê³„ ì¹´ë“œ (`CampLearningStatsCards`)
- í•™ìƒ ì„ íƒ í•„í„° (`StudentSelector`)
- í•™ìƒë³„ í•™ìŠµ í˜„í™© í…Œì´ë¸” (`StudentPlanProgressTable`)
- ë‚ ì§œë³„ í”Œëœ ìƒì„¸ ë‹¤ì´ì–¼ë¡œê·¸ (`DatePlanDetailDialog`)

#### 7. í•™ìŠµ ë‹¬ë ¥ ì»´í¬ë„ŒíŠ¸ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/CampLearningCalendar.tsx`

ê¸°ëŠ¥:
- ìº í”„ ê¸°ê°„ ë‹¬ë ¥ í‘œì‹œ
- ë‚ ì§œë³„ í•™ìŠµ ì§„í–‰ë¥  ìƒ‰ìƒ í‘œì‹œ:
  - 90% ì´ìƒ: ì´ˆë¡ìƒ‰
  - 70-89%: ë…¸ë€ìƒ‰
  - 50-69%: ì£¼í™©ìƒ‰
  - 50% ë¯¸ë§Œ: ë¹¨ê°„ìƒ‰
  - í”Œëœ ì—†ìŒ: íšŒìƒ‰
- ë‚ ì§œ í´ë¦­ ì‹œ í”Œëœ ëª©ë¡ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ

#### 8. í•™ìŠµ í†µê³„ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/CampLearningStatsCards.tsx`

í†µê³„ í•­ëª©:
- ì´ ì°¸ì—¬ì ìˆ˜
- í‰ê·  ì™„ë£Œìœ¨
- ì´ í•™ìŠµ ì‹œê°„
- í‰ê·  í•™ìŠµ ì‹œê°„
- í‰ê·  ì¼ì¼ í•™ìŠµ ì‹œê°„

#### 9. í•™ìƒë³„ í•™ìŠµ ì§„í–‰ í˜„í™© í…Œì´ë¸” âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/StudentPlanProgressTable.tsx`

ì»¬ëŸ¼:
- í•™ìƒëª…
- ì™„ë£Œìœ¨ (ìƒ‰ìƒ ì½”ë”©)
- ì´ í•™ìŠµ ì‹œê°„
- í‰ê·  ì¼ì¼ í•™ìŠµ ì‹œê°„
- í•™ìƒ ìƒì„¸ í˜ì´ì§€ ë§í¬

#### 10. ë‚ ì§œë³„ í”Œëœ ìƒì„¸ ë‹¤ì´ì–¼ë¡œê·¸ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/DatePlanDetailDialog.tsx`

ë‚´ìš©:
- ì„ íƒëœ ë‚ ì§œ
- í•´ë‹¹ ë‚ ì§œì˜ ëª¨ë“  í•™ìƒ í”Œëœ ëª©ë¡
- í”Œëœë³„ ì •ë³´:
  - í•™ìƒëª…
  - ì½˜í…ì¸ ëª…
  - ê³¼ëª©
  - ê³„íš ë²”ìœ„
  - ì™„ë£Œ ë²”ìœ„
  - ì§„í–‰ë¥ 
  - í•™ìŠµ ì‹œê°„
  - ìƒíƒœ (ì™„ë£Œ/ì§„í–‰ì¤‘/ë¯¸ì‹œì‘)

#### 11. í•™ìƒ ì„ íƒ í•„í„° ì»´í¬ë„ŒíŠ¸ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/_components/StudentSelector.tsx`

ê¸°ëŠ¥:
- ì°¸ì—¬ì ëª©ë¡ì—ì„œ í•™ìƒ ì„ íƒ
- ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥
- ì„ íƒëœ í•™ìƒ í•„í„°ë§
- "ì „ì²´ ì„ íƒ" / "ì „ì²´ í•´ì œ" ê¸°ëŠ¥

### Phase 4: í†µí•© ë° ìµœì í™” âœ…

#### 12. ì„œë²„ ì»´í¬ë„ŒíŠ¸ í˜ì´ì§€ êµ¬í˜„ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/learning/page.tsx`

- ìº í”„ í…œí”Œë¦¿ë³„ í•™ìŠµ ê´€ë¦¬ í˜ì´ì§€
- ê¶Œí•œ ê²€ì¦ (admin, consultant)
- í…œí”Œë¦¿ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
- React Query prefetch

#### 13. ë„¤ë¹„ê²Œì´ì…˜ ë§í¬ ì¶”ê°€ âœ…

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/CampTemplateDetail.tsx`

- í…œí”Œë¦¿ ìƒì„¸ í˜ì´ì§€ì— "í•™ìŠµ ê´€ë¦¬" ë§í¬ ì¶”ê°€
- ì¶œì„ ê´€ë¦¬ ë§í¬ ì˜†ì— ë°°ì¹˜

## ğŸ”— ì—°ê²° ê´€ê³„

```
camp_templates (camp_start_date, camp_end_date)
  â†“
plan_groups (camp_template_id, plan_type='camp')
  â†“
student_plan (plan_group_id, plan_date)
  â†“
student_study_sessions (plan_id, duration_seconds)
```

## ğŸ“Š ë°ì´í„° íë¦„

```
Server Component (page.tsx)
  â†“ prefetchQuery
React Query Cache
  â†“ HydrationBoundary
Client Component (CampLearningDashboard)
  â†“ useQuery hooks
UI Components (Calendar, Stats, Table)
```

## ğŸ¨ UI íŠ¹ì§•

### í•™ìŠµ ë‹¬ë ¥
- ì¶œì„ ë‹¬ë ¥ê³¼ ë™ì¼í•œ êµ¬ì¡°
- í•™ìŠµ ì§„í–‰ë¥ ì— ë”°ë¥¸ ìƒ‰ìƒ ì½”ë”©
- ë‚ ì§œ í´ë¦­ ì‹œ í”Œëœ ìƒì„¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ

### í•™ìŠµ í†µê³„
- ì´ ì°¸ì—¬ì ìˆ˜
- í‰ê·  ì™„ë£Œìœ¨
- ì´ í•™ìŠµ ì‹œê°„
- í‰ê·  í•™ìŠµ ì‹œê°„
- í‰ê·  ì¼ì¼ í•™ìŠµ ì‹œê°„

### í•™ìƒë³„ ì§„í–‰ í˜„í™©
- ì™„ë£Œìœ¨ ìƒ‰ìƒ ì½”ë”© (90% ì´ìƒ: ì´ˆë¡, 70% ì´ìƒ: ë…¸ë‘, ë¯¸ë§Œ: ë¹¨ê°•)
- í•™ìŠµ ì‹œê°„ í¬ë§·íŒ… (ì‹œê°„:ë¶„)
- í•™ìƒ ìƒì„¸ í˜ì´ì§€ ë§í¬

## ğŸš€ í–¥í›„ ê°œì„  ì‚¬í•­

### ë°ì´í„° ë ˆì´ì–´ ìµœì í™”
- [ ] `lib/data/campLearningStats.ts` ìµœì í™” (ì¤‘ë³µ ì½”ë“œ ì œê±°)
- [ ] í”Œëœ ê·¸ë£¹ ì¡°íšŒ ë¡œì§ ê³µí†µ í•¨ìˆ˜ë¡œ ì¶”ì¶œ
- [ ] í•™ìŠµ ì„¸ì…˜ ì¡°íšŒ ë¡œì§ í†µí•©

### ê¸°ëŠ¥ ê°œì„ 
- [ ] ì´ í”Œëœ ìˆ˜ ë° ì™„ë£Œëœ í”Œëœ ìˆ˜ í†µê³„ ì¶”ê°€
- [ ] í‰ê·  ì¼ì¼ í•™ìŠµ ì‹œê°„ ê³„ì‚° ì‹œ ì‹¤ì œ ìº í”„ ê¸°ê°„ ì‚¬ìš©
- [ ] ê³¼ëª©ë³„ í•™ìŠµ ì‹œê°„ ë¶„í¬ ì°¨íŠ¸ ì¶”ê°€

### ì„±ëŠ¥ ìµœì í™”
- [ ] ê°€ìƒí™”(virtualization) ê³ ë ¤ (í…Œì´ë¸”ì´ í° ê²½ìš°)
- [ ] React.memoë¡œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
- [ ] ì´ë¯¸ì§€ ìµœì í™”

## ğŸ“ API ì—”ë“œí¬ì¸íŠ¸

### GET /api/camp-learning/date/[date]
ë‚ ì§œë³„ í”Œëœ ì¡°íšŒ

**Query Parameters**:
- `templateId`: ìº í”„ í…œí”Œë¦¿ ID (í•„ìˆ˜)
- `studentIds`: í•™ìƒ ID ëª©ë¡ (ì„ íƒ, ì‰¼í‘œë¡œ êµ¬ë¶„)

**Response**:
```json
{
  "success": true,
  "data": {
    "date": "2024-01-15",
    "plans": [
      {
        "student_id": "student-123",
        "student_name": "í™ê¸¸ë™",
        "plan_id": "plan-456",
        "content_title": "ìˆ˜í•™ ê°œë…ì„œ",
        "content_subject": "ìˆ˜í•™",
        "block_index": 1,
        "planned_range": "1-10í˜ì´ì§€",
        "completed_amount": 8,
        "progress": 80,
        "study_minutes": 60,
        "status": "in_progress"
      }
    ]
  }
}
```

### GET /api/camp-learning/students/[studentId]
í•™ìƒë³„ í•™ìŠµ í†µê³„ ì¡°íšŒ

**Query Parameters**:
- `templateId`: ìº í”„ í…œí”Œë¦¿ ID (í•„ìˆ˜)

**Response**:
```json
{
  "success": true,
  "data": {
    "student_id": "student-123",
    "student_name": "í™ê¸¸ë™",
    "study_minutes": 1200,
    "plan_completion_rate": 85,
    "subject_distribution": {
      "ìˆ˜í•™": 600,
      "ì˜ì–´": 400,
      "êµ­ì–´": 200
    },
    "total_plans": 30,
    "completed_plans": 25
  }
}
```

### GET /api/camp-learning/records
ìº í”„ ê¸°ê°„ í•™ìŠµ ê¸°ë¡ ì¡°íšŒ

**Query Parameters**:
- `templateId`: ìº í”„ í…œí”Œë¦¿ ID (í•„ìˆ˜)
- `startDate`: ì‹œì‘ì¼ (YYYY-MM-DD, í•„ìˆ˜)
- `endDate`: ì¢…ë£Œì¼ (YYYY-MM-DD, í•„ìˆ˜)

**Response**:
```json
{
  "success": true,
  "data": [
    {
      "id": "plan-456",
      "student_id": "student-123",
      "student_name": "í™ê¸¸ë™",
      "plan_date": "2024-01-15",
      "block_index": 1,
      "content_type": "book",
      "content_id": "book-789",
      "progress": 80,
      ...
    }
  ]
}
```

## âœ… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ìº í”„ ê¸°ê°„ ë‹¬ë ¥ì´ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ê°€?
- [x] ë‚ ì§œë³„ í•™ìŠµ ì§„í–‰ë¥ ì´ ì •í™•íˆ ê³„ì‚°ë˜ëŠ”ê°€?
- [x] í•™ìƒ ì„ íƒ í•„í„°ê°€ ì •ìƒ ì‘ë™í•˜ëŠ”ê°€?
- [x] ë‚ ì§œ í´ë¦­ ì‹œ í”Œëœ ëª©ë¡ì´ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ê°€?
- [x] í•™ìŠµ í†µê³„ê°€ ì •í™•íˆ ê³„ì‚°ë˜ëŠ”ê°€?
- [x] React Query ìºì‹±ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ê°€?
- [x] ì„œë²„ ì»´í¬ë„ŒíŠ¸ prefetchê°€ ì •ìƒ ì‘ë™í•˜ëŠ”ê°€?
- [x] ë°˜ì‘í˜• ë””ìì¸ì´ ì˜¬ë°”ë¥´ê²Œ ì ìš©ë˜ëŠ”ê°€?

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- ì¶œì„ ê´€ë¦¬ êµ¬í˜„: `docs/camp-attendance-phase1-implementation.md`
- ìº í”„ í•™ìŠµ í†µê³„ êµ¬í˜„: `docs/camp-learning-stats-phase2-implementation.md`
- ê³„íšì„œ: `.cursor/plans/-b5c684b3.plan.md`

---

**êµ¬í˜„ ì™„ë£Œì¼**: 2024ë…„ 12ì›” 22ì¼

