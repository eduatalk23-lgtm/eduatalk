# Phase 3.1: ìœ„ìë“œ ë‹¤ì¤‘ ì½˜í…ì¸  â†’ ë‹¤ì¤‘ í”Œëœê·¸ë£¹ ê°œì„ 

> **ì‘ì„±ì¼**: 2026-01-20
> **ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ
> **ê´€ë ¨ ë¬¸ì„œ**: [í”Œëœ ì‹œìŠ¤í…œ í†µí•© ì•„í‚¤í…ì²˜](./plan-system-unification.md)

---

## ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ë³€ê²½ ì „í›„ ë¹„êµ](#2-ë³€ê²½-ì „í›„-ë¹„êµ)
3. [ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨](#3-ì•„í‚¤í…ì²˜-ë‹¤ì´ì–´ê·¸ë¨)
4. [êµ¬í˜„ ìƒì„¸](#4-êµ¬í˜„-ìƒì„¸)
5. [ì£¼ìš” ì»´í¬ë„ŒíŠ¸](#5-ì£¼ìš”-ì»´í¬ë„ŒíŠ¸)
6. [API ë ˆí¼ëŸ°ìŠ¤](#6-api-ë ˆí¼ëŸ°ìŠ¤)
7. [í…ŒìŠ¤íŠ¸](#7-í…ŒìŠ¤íŠ¸)
8. [í–¥í›„ ì‘ì—…](#8-í–¥í›„-ì‘ì—…)

---

## 1. ê°œìš”

### 1.1 ë°°ê²½

ê¸°ì¡´ ìœ„ìë“œì—ì„œ ì‚¬ìš©ìê°€ ì—¬ëŸ¬ ì½˜í…ì¸ (ìˆ˜í•™, êµ­ì–´, ì˜ì–´ ë“±)ë¥¼ ì„ íƒí•˜ë©´ **í•˜ë‚˜ì˜ plan_group**ì— ëª¨ë‘ ë‹´ê¸°ê³ , `plan_contents` í…Œì´ë¸”ì— ê° ì½˜í…ì¸ ê°€ í–‰ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ êµ¬ì¡°ëŠ” ë‹¤ìŒ ë¬¸ì œë¥¼ ì•¼ê¸°í–ˆìŠµë‹ˆë‹¤:
- ì½˜í…ì¸ ë³„ ì§„í–‰ìƒí™© ì¶”ì ì´ ì–´ë ¤ì›€
- ìŠ¤ì¼€ì¤„ëŸ¬ê°€ plan_group ë‹¨ìœ„ë¡œ ì¡°ìœ¨í•˜ì—¬ ìœ ì—°ì„± ë¶€ì¡±
- ì½˜í…ì¸  ì¶”ê°€/ì œê±° ì‹œ ë³µì¡í•œ ì²˜ë¦¬ í•„ìš”

### 1.2 ëª©í‘œ

**ì—¬ëŸ¬ ì½˜í…ì¸  ì„ íƒ â†’ ê°ê° ë³„ë„ì˜ plan_groupìœ¼ë¡œ ìƒì„±** (all `is_single_content=true`)

í•µì‹¬ ë³€ê²½:
- ìŠ¤ì¼€ì¤„ëŸ¬ ì¡°ìœ¨ ì±…ì„: `plan_group` â†’ `planner`ë¡œ ì´ë™
- Planner í•„ìˆ˜í™”: ëª¨ë“  í•™ìƒì´ Plannerë¥¼ ê°€ì§ (ì—†ìœ¼ë©´ ìë™ ìƒì„±)

---

## 2. ë³€ê²½ ì „í›„ ë¹„êµ

### 2.1 ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ë³€ê²½ ì „ (Before)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì‚¬ìš©ì: ìˆ˜í•™, êµ­ì–´, ì˜ì–´ 3ê°œ ì½˜í…ì¸  ì„ íƒ
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Plan Group (1ê°œ)  â”‚
         â”‚   name: "í•™ìŠµ í”Œëœ" â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚plan_     â”‚  â”‚plan_     â”‚  â”‚plan_     â”‚
â”‚contents  â”‚  â”‚contents  â”‚  â”‚contents  â”‚
â”‚(ìˆ˜í•™)    â”‚  â”‚(êµ­ì–´)    â”‚  â”‚(ì˜ì–´)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         ìŠ¤ì¼€ì¤„ëŸ¬: plan_group ë‹¨ìœ„ë¡œ
         3ê°œ ì½˜í…ì¸  í•¨ê»˜ ì¡°ìœ¨


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ë³€ê²½ í›„ (After)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì‚¬ìš©ì: ìˆ˜í•™, êµ­ì–´, ì˜ì–´ 3ê°œ ì½˜í…ì¸  ì„ íƒ
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Planner    â”‚       â”‚ 2. Plan Groups (3ê°œ)  â”‚
â”‚    í™•ë³´       â”‚       â”‚    ìˆœì°¨ ìƒì„±          â”‚
â”‚ (ì—†ìœ¼ë©´ ìƒì„±) â”‚       â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Planner           â”‚
         â”‚   (ìŠ¤ì¼€ì¤„ëŸ¬ ì¡°ìœ¨)   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Plan Groupâ”‚  â”‚Plan Groupâ”‚  â”‚Plan Groupâ”‚
â”‚(ìˆ˜í•™)    â”‚  â”‚(êµ­ì–´)    â”‚  â”‚(ì˜ì–´)    â”‚
â”‚single_   â”‚  â”‚single_   â”‚  â”‚single_   â”‚
â”‚content   â”‚  â”‚content   â”‚  â”‚content   â”‚
â”‚=true     â”‚  â”‚=true     â”‚  â”‚=true     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         ìŠ¤ì¼€ì¤„ëŸ¬: Planner ë‹¨ìœ„ë¡œ
         3ê°œ plan_group í•¨ê»˜ ì¡°ìœ¨
```

### 2.2 ë°ì´í„° ëª¨ë¸ ë¹„êµ

| í•­ëª© | Before | After |
|------|--------|-------|
| **Plan Group ê°œìˆ˜** | 1ê°œ (ì—¬ëŸ¬ ì½˜í…ì¸  í¬í•¨) | ì½˜í…ì¸  ê°œìˆ˜ë§Œí¼ |
| **ì½˜í…ì¸  ì €ì¥ ìœ„ì¹˜** | `plan_contents` í…Œì´ë¸” | `plan_groups` í…Œì´ë¸” í•„ë“œ |
| **ì½˜í…ì¸  ì •ë³´ í•„ë“œ** | ë³„ë„ í…Œì´ë¸” ì°¸ì¡° | `content_type`, `content_id`, `start_range`, `end_range` ì§ì ‘ ì €ì¥ |
| **Planner ì—°ê²°** | ì„ íƒì  (nullable) | í•„ìˆ˜ (ìë™ ìƒì„±) |
| **ìŠ¤ì¼€ì¤„ëŸ¬ ì¡°ìœ¨ ë‹¨ìœ„** | plan_group | planner |
| **is_single_content** | N/A | `true` (ê¸°ë³¸ê°’) |

### 2.3 ì¥ì 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ê°œì„  íš¨ê³¼                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“Š ì§„í–‰ìƒí™© ì¶”ì           ğŸ”§ ìœ ì§€ë³´ìˆ˜ì„±          ğŸš€ í™•ì¥ì„±    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  â€¢ ì½˜í…ì¸ ë³„ ë…ë¦½ ì¶”ì       â€¢ JOIN ê°ì†Œ           â€¢ ì½˜í…ì¸  ì¶”ê°€â”‚
â”‚  â€¢ ì§„í–‰ë¥  ê³„ì‚° ë‹¨ìˆœí™”      â€¢ ì¿¼ë¦¬ ë‹¨ìˆœí™”           /ì œê±° ìš©ì´ â”‚
â”‚  â€¢ ê°œë³„ ì™„ë£Œ ì²˜ë¦¬ ê°€ëŠ¥     â€¢ íƒ€ì… ì•ˆì „ì„± í–¥ìƒ    â€¢ ê°œë³„ ì¡°ì •  â”‚
â”‚                                                     ê°€ëŠ¥       â”‚
â”‚                                                                 â”‚
â”‚  âš¡ ì„±ëŠ¥                    ğŸ”„ ì¼ê´€ì„±                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
â”‚  â€¢ plan_contents ì¡°íšŒ ë¶ˆí•„ìš”  â€¢ í•™ìƒ/ê´€ë¦¬ì ë™ì¼ êµ¬ì¡°           â”‚
â”‚  â€¢ ì¸ë±ìŠ¤ ìµœì í™” ìš©ì´        â€¢ ìº í”„ ì™¸ ëª¨ë“  í”Œëœ í†µì¼           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

### 3.1 ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           UI Layer                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    PlanGroupWizard (7 Steps)                      â”‚  â”‚
â”‚  â”‚  Step 1-6: ì½˜í…ì¸  ì„ íƒ, ê¸°ê°„ ì„¤ì •, ìŠ¤ì¼€ì¤„ëŸ¬ ì˜µì…˜ ë“±              â”‚  â”‚
â”‚  â”‚  Step 7: ê²°ê³¼ í™•ì¸                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Hook Layer                                     â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ usePlanPayload      â”‚  â”‚ usePlanGenerator    â”‚  â”‚ usePlanSubmissionâ”‚ â”‚
â”‚  â”‚ Builder             â”‚  â”‚                     â”‚  â”‚                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ buildPayload()    â”‚  â”‚ â€¢ ensurePlanner()   â”‚  â”‚ â€¢ handleSubmit() â”‚ â”‚
â”‚  â”‚ â€¢ buildSingle       â”‚  â”‚ â€¢ createMultiple    â”‚  â”‚ â€¢ handleMultiple â”‚  â”‚
â”‚  â”‚   ContentPayloads() â”‚  â”‚   PlanGroups()      â”‚  â”‚   GroupsSubmit() â”‚  â”‚
â”‚  â”‚                     â”‚  â”‚ â€¢ generatePlans     â”‚  â”‚ â€¢ progress       â”‚  â”‚
â”‚  â”‚                     â”‚  â”‚   ForMultipleGroups â”‚  â”‚   tracking       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                        â”‚                        â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Server Action Layer                              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    planners/autoCreate.ts                          â”‚ â”‚
â”‚  â”‚  getOrCreateDefaultPlannerAction()                                 â”‚ â”‚
â”‚  â”‚  - ê¸°ì¡´ active/draft Planner ì¡°íšŒ                                  â”‚ â”‚
â”‚  â”‚  - ì—†ìœ¼ë©´ ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ìë™ ìƒì„±                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   plan-groups/create.ts                            â”‚ â”‚
â”‚  â”‚  createPlanGroupAction()                                           â”‚ â”‚
â”‚  â”‚  - is_single_content ìë™ ê°ì§€                                     â”‚ â”‚
â”‚  â”‚  - content_* í•„ë“œ ì§ì ‘ ì €ì¥                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              plan-groups/generatePlansWithServices.ts              â”‚ â”‚
â”‚  â”‚  generatePlansFromGroupAction()                                    â”‚ â”‚
â”‚  â”‚  - ìŠ¤ì¼€ì¤„ëŸ¬ í˜¸ì¶œ                                                   â”‚ â”‚
â”‚  â”‚  - student_plan ìƒì„±                                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ì œì¶œ íë¦„ ì‹œí€€ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ì â”‚     â”‚ usePlanSubmission â”‚     â”‚ usePlanGeneratorâ”‚     â”‚ Server  â”‚
â”‚        â”‚     â”‚                   â”‚     â”‚                â”‚     â”‚ Actions â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚  Submit í´ë¦­      â”‚                       â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚ handleMultiple        â”‚                   â”‚
     â”‚                   â”‚ GroupsSubmit()        â”‚                   â”‚
     â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚     Phase: validating â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚ ensurePlanner()   â”‚
     â”‚                   â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚     Phase: ensuring_  â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     planner           â”‚                   â”‚
     â”‚                   â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚                       â”‚  { plannerId }    â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚ Loop: ê° ì½˜í…ì¸ ë³„ â”‚
     â”‚                   â”‚     Phase: creating_  â”‚ createPlanGroup   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     groups (1/3)      â”‚ Action()          â”‚
     â”‚                   â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚     Phase: creating_  â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     groups (2/3)      â”‚                   â”‚
     â”‚                   â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚     Phase: creating_  â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     groups (3/3)      â”‚                   â”‚
     â”‚                   â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚ Loop: ê° ê·¸ë£¹ë³„   â”‚
     â”‚                   â”‚     Phase: generating_â”‚ generatePlans     â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     plans (1/3)       â”‚ FromGroupAction() â”‚
     â”‚                   â”‚                       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                   â”‚                       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                   â”‚     ...               â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚                   â”‚     Phase: completed  â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
     â”‚  Step 7ë¡œ ì´ë™    â”‚                       â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                       â”‚                   â”‚
     â”‚                   â”‚                       â”‚                   â”‚
```

### 3.3 ì§„í–‰ë¥  í‘œì‹œ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í”Œëœ ìƒì„± ì¤‘...                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Phase: ensuring_planner                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  í”Œë˜ë„ˆ í™•ì¸ ì¤‘...                                              â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Phase: creating_groups (2/3)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  í”Œëœ ê·¸ë£¹ ìƒì„± ì¤‘... (2/3)                                     â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Phase: generating_plans (1/3)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  í•™ìŠµ í”Œëœ ìƒì„± ì¤‘... (1/3)                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. êµ¬í˜„ ìƒì„¸

### 4.1 í•µì‹¬ íƒ€ì… ì •ì˜

```typescript
// SingleContentPayload - ê° ì½˜í…ì¸ ë³„ í˜ì´ë¡œë“œ
interface SingleContentPayload {
  // ê¸°ë³¸ í•„ë“œ
  name: string;
  period_start: string;
  period_end: string;

  // ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ í•„ë“œ
  is_single_content: true;
  single_content_type: ContentType;
  single_content_id: string;
  single_master_content_id: string | null;
  single_start_range: number;
  single_end_range: number;

  // ë©”íƒ€ë°ì´í„° (ìŠ¤ì¼€ì¤„ë§ìš©)
  contentTitle: string;
  subjectCategory: string;
  subject: string;

  // ë¹ˆ ë°°ì—´ (ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œì—ì„œëŠ” ì‚¬ìš© ì•ˆ í•¨)
  contents: [];

  // ê³µìœ  ì„¤ì • (ëª¨ë“  plan_groupì— ë™ì¼)
  exclusions: Exclusion[];
  academy_schedules: AcademySchedule[];
  scheduler_options: SchedulerOptions;
  // ...
}

// ìƒì„± ê²°ê³¼
interface MultipleGroupsCreationResult {
  plannerId: string;
  groupIds: string[];
  totalCount: number;
}

// ì§„í–‰ ì½œë°±
type ProgressCallback = (
  current: number,
  total: number,
  phase: string
) => void;
```

### 4.2 Planner ìë™ ìƒì„±

```typescript
// lib/domains/plan/actions/planners/autoCreate.ts

export async function getOrCreateDefaultPlannerAction(
  options?: CreateDefaultPlannerOptions
): Promise<GetOrCreateDefaultPlannerResult> {
  // 1. ê¸°ì¡´ active/draft í”Œë˜ë„ˆ ì¡°íšŒ
  const existing = await findDefaultPlanner(studentId);
  if (existing) {
    return { plannerId: existing.id, isNew: false, plannerName: existing.name };
  }

  // 2. ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ìƒˆ í”Œë˜ë„ˆ ìƒì„±
  const created = await createDefaultPlanner({
    name: "ê¸°ë³¸ í”Œë˜ë„ˆ",
    periodStart: today,
    periodEnd: threeMonthsLater,
    studyHours: { start: "10:00", end: "19:00" },
    selfStudyHours: { start: "19:00", end: "22:00" },
    lunchTime: { start: "12:00", end: "13:00" },
    schedulerType: "1730_timetable",
    schedulerOptions: { study_days: 6, review_days: 1 },
  });

  return { plannerId: created.id, isNew: true, plannerName: created.name };
}
```

### 4.3 ì—¬ëŸ¬ Plan Group ìƒì„±

```typescript
// usePlanGenerator.ts - createMultiplePlanGroups()

const createMultiplePlanGroups = async (
  onProgress?: ProgressCallback
): Promise<MultipleGroupsCreationResult> => {
  // 1. ë‹¨ì¼ ì½˜í…ì¸  í˜ì´ë¡œë“œ ë°°ì—´ ìƒì„±
  const payloads = buildSingleContentPayloads();
  // [{ ìˆ˜í•™ }, { êµ­ì–´ }, { ì˜ì–´ }]

  onProgress?.(0, payloads.length, "ensuring_planner");

  // 2. Planner í™•ë³´ (ì—†ìœ¼ë©´ ìë™ ìƒì„±)
  const plannerId = await ensurePlanner();

  onProgress?.(0, payloads.length, "creating_groups");

  // 3. ê° ì½˜í…ì¸ ë³„ plan_group ìƒì„±
  const groupIds: string[] = [];
  for (let i = 0; i < payloads.length; i++) {
    onProgress?.(i, payloads.length, "creating_groups");

    const result = await createPlanGroupAction({
      ...payloads[i],
      planner_id: plannerId,  // ëª¨ë“  ê·¸ë£¹ì´ ê°™ì€ Planner ì°¸ì¡°
    });

    groupIds.push(result.groupId);
  }

  return { plannerId, groupIds, totalCount: groupIds.length };
};
```

---

## 5. ì£¼ìš” ì»´í¬ë„ŒíŠ¸

### 5.1 íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ì—­í•  | ìƒíƒœ |
|------|------|------|
| `lib/domains/plan/actions/planners/autoCreate.ts` | Planner ìë™ ìƒì„± Server Action | âœ… ì‹ ê·œ |
| `usePlanPayloadBuilder.ts` | ë‹¨ì¼ ì½˜í…ì¸  í˜ì´ë¡œë“œ ë¹Œë” | âœ… ìˆ˜ì • |
| `usePlanGenerator.ts` | í”Œëœ ìƒì„± ë¡œì§ (ensurePlanner, createMultiplePlanGroups) | âœ… ìˆ˜ì • |
| `usePlanSubmission.ts` | ì œì¶œ í•¸ë“¤ëŸ¬ (handleMultipleGroupsSubmit) | âœ… ìˆ˜ì • |
| `lib/domains/plan/actions/plan-groups/create.ts` | Plan Group ìƒì„± (is_single_content ì§€ì›) | âœ… ìˆ˜ì • |

### 5.2 ë°ì´í„°ë² ì´ìŠ¤ ì»¬ëŸ¼

```sql
-- plan_groups í…Œì´ë¸”ì— ì¶”ê°€ëœ ì»¬ëŸ¼
ALTER TABLE plan_groups ADD COLUMN content_type VARCHAR(50);
ALTER TABLE plan_groups ADD COLUMN content_id UUID;
ALTER TABLE plan_groups ADD COLUMN master_content_id UUID;
ALTER TABLE plan_groups ADD COLUMN start_range INTEGER;
ALTER TABLE plan_groups ADD COLUMN end_range INTEGER;
ALTER TABLE plan_groups ADD COLUMN start_detail_id UUID;
ALTER TABLE plan_groups ADD COLUMN end_detail_id UUID;
ALTER TABLE plan_groups ADD COLUMN is_single_content BOOLEAN DEFAULT true;
```

---

## 6. API ë ˆí¼ëŸ°ìŠ¤

### 6.1 Server Actions

#### getOrCreateDefaultPlannerAction

```typescript
import { getOrCreateDefaultPlannerAction } from "@/lib/domains/plan/actions/planners";

// í•™ìƒ ëª¨ë“œ: ìì‹ ì˜ í”Œë˜ë„ˆ
const result = await getOrCreateDefaultPlannerAction();
// { plannerId: "...", isNew: false, plannerName: "ê¸°ë³¸ í”Œë˜ë„ˆ" }

// ê´€ë¦¬ì ëª¨ë“œ: íŠ¹ì • í•™ìƒì˜ í”Œë˜ë„ˆ
const result = await getOrCreateDefaultPlannerAction({
  studentId: "student-123"
});
```

#### createPlanGroupAction (ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ)

```typescript
import { createPlanGroupAction } from "@/lib/domains/plan/actions/plan-groups";

const result = await createPlanGroupAction({
  name: "ìˆ˜í•™ ê°œë…ì™„ì„±",
  planner_id: "planner-123",
  period_start: "2026-01-20",
  period_end: "2026-02-28",

  // ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ í•„ë“œ
  is_single_content: true,
  single_content_type: "book",
  single_content_id: "content-abc",
  single_start_range: 1,
  single_end_range: 300,

  // contentsëŠ” ë¹ˆ ë°°ì—´
  contents: [],
});
```

### 6.2 Hooks

#### usePlanGenerator

```typescript
const {
  ensurePlanner,                  // () => Promise<string>
  createMultiplePlanGroups,       // (onProgress?) => Promise<Result>
  generatePlansForMultipleGroups, // (groupIds[], onProgress?) => Promise<Result>
  // ê¸°ì¡´ ë©”ì„œë“œ
  createOrUpdatePlanGroup,
  generatePlans,
  isGenerating,
} = usePlanGenerator({ wizardData, ... });
```

#### usePlanSubmission

```typescript
const {
  handleMultipleGroupsSubmit,   // (generateFlag?) => Promise<Result | undefined>
  multipleGroupsProgress,       // { current, total, phase } | null
  submissionPhase,              // SubmissionPhase
  // ê¸°ì¡´ ë©”ì„œë“œ
  handleSubmit,
  executeSave,
  isSubmitting,
} = usePlanSubmission({ wizardData, mode, ... });
```

---

## 7. í…ŒìŠ¤íŠ¸

### 7.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

```
__tests__/lib/plan/schedulerPlanner.test.ts (9 tests)
â”œâ”€â”€ isSingleContentPlanGroup
â”‚   â”œâ”€â”€ ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ PlanGroup ì‹ë³„
â”‚   â”œâ”€â”€ ë‹¤ì¤‘ ì½˜í…ì¸  ëª¨ë“œ PlanGroup ì‹ë³„
â”‚   â””â”€â”€ content_id ì—†ëŠ” ê²½ìš° false
â”œâ”€â”€ toSingleContentPlanGroup
â”‚   â”œâ”€â”€ ìœ íš¨í•œ PlanGroup ë³€í™˜
â”‚   â””â”€â”€ ë‹¤ì¤‘ ì½˜í…ì¸  ëª¨ë“œ null ë°˜í™˜
â”œâ”€â”€ toContentInfoWithPlanGroup
â”‚   â””â”€â”€ SingleContentPlanGroup â†’ ContentInfo ë³€í™˜
â”œâ”€â”€ buildPlanGroupIdMap
â”‚   â”œâ”€â”€ content_id â†’ plan_group_id ë§¤í•‘
â”‚   â””â”€â”€ ë¹ˆ ë°°ì—´ ì²˜ë¦¬
â””â”€â”€ PlannerWithSchedulerOptions íƒ€ì…
    â””â”€â”€ content_allocations í¬í•¨ ê°€ëŠ¥

__tests__/lib/data/planGroups/unifiedContent.test.ts (14 tests)
â”œâ”€â”€ getSingleContentFromGroup
â”‚   â”œâ”€â”€ ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œì—ì„œ ì¶”ì¶œ
â”‚   â”œâ”€â”€ ë‹¤ì¤‘ ì½˜í…ì¸  ëª¨ë“œ null ë°˜í™˜
â”‚   â”œâ”€â”€ content_id ì—†ìœ¼ë©´ null
â”‚   â””â”€â”€ content_type nullì´ë©´ ê¸°ë³¸ê°’ 'book'
â”œâ”€â”€ hasContent
â”‚   â”œâ”€â”€ ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ - content_id ìˆìŒ
â”‚   â”œâ”€â”€ ë‹¨ì¼ ì½˜í…ì¸  ëª¨ë“œ - content_id ì—†ìŒ
â”‚   â”œâ”€â”€ ìŠ¬ë¡¯ ëª¨ë“œ - content_slots ìˆìŒ
â”‚   â”œâ”€â”€ ìŠ¬ë¡¯ ëª¨ë“œ - content_slots ë¹„ì–´ìˆìŒ
â”‚   â””â”€â”€ ë‹¤ì¤‘ ì½˜í…ì¸  ëª¨ë“œ - false
â””â”€â”€ getContentMode
    â”œâ”€â”€ single ì‹ë³„
    â”œâ”€â”€ slot ì‹ë³„
    â”œâ”€â”€ legacy_multi ì‹ë³„
    â”œâ”€â”€ empty ì‹ë³„
    â””â”€â”€ ë¹ˆ ìŠ¬ë¡¯ ëª¨ë“œ ì²˜ë¦¬
```

### 7.2 ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (ìˆ˜ë™/E2E)

```markdown
[ ] ìœ„ìë“œì—ì„œ ì½˜í…ì¸  1ê°œ ì„ íƒ â†’ plan_group 1ê°œ ìƒì„±
[ ] ìœ„ìë“œì—ì„œ ì½˜í…ì¸  3ê°œ ì„ íƒ â†’ plan_group 3ê°œ ìƒì„±
[ ] ëª¨ë“  plan_groupì´ ë™ì¼í•œ planner_id ê³µìœ 
[ ] ê° plan_groupì˜ is_single_content = true
[ ] plan_contents í…Œì´ë¸”ì— ì‹ ê·œ í–‰ ì—†ìŒ
[ ] ì§„í–‰ë¥  UI ì •ìƒ í‘œì‹œ
[ ] ì˜¤ë¥˜ ë°œìƒ ì‹œ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€
[ ] ê¸°ì¡´ ë ˆê±°ì‹œ ë°ì´í„° ì¡°íšŒ ì •ìƒ
```

---

## 8. í–¥í›„ ì‘ì—…

### 8.1 ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìˆ˜í–‰

| ì˜ì—­ | í•­ëª© | ìƒíƒœ |
|------|------|------|
| **ìŠ¤ì¼€ì¤„ëŸ¬** | ë¸”ë¡ íš¨ìœ¨ì„± 100% ìœ ì§€ | [ ] |
| | ì „ëµê³¼ëª© ì£¼ë‹¹ Nì¼ ë°°ì • ì •í™• | [ ] |
| | ì·¨ì•½ê³¼ëª© ì „ì²´ í•™ìŠµì¼ ë°°ì • | [ ] |
| | ë³µìŠµì¼ ì‹œê°„ ê³„ì‚° ì •í™• | [ ] |
| **ë°ì´í„°** | student_plan ì´ ê°œìˆ˜ ë¶ˆë³€ | [ ] |
| | ë‚ ì§œë³„ í•™ìŠµëŸ‰ í•©ê³„ ë¶ˆë³€ | [ ] |
| | planner-plan_group ê´€ê³„ ì •í™• | [ ] |
| **UI/UX** | í•™ìƒ ìœ„ìë“œ 7ë‹¨ê³„ ì •ìƒ | [ ] |
| | ìº˜ë¦°ë” í‘œì‹œ ì •ìƒ | [ ] |
| | ì§„í–‰ë¥  í‘œì‹œ ì •ìƒ | [ ] |

### 8.2 ì¶”ê°€ ê°œì„  ì‘ì—…

1. **E2E í…ŒìŠ¤íŠ¸ ì¶”ê°€**
   - Playwright/Cypressë¡œ ìœ„ìë“œ í”Œë¡œìš° ìë™í™” í…ŒìŠ¤íŠ¸

2. **ì„±ëŠ¥ ìµœì í™”**
   - ì—¬ëŸ¬ plan_group ë°°ì¹˜ ìƒì„± API ì¶”ê°€ ê²€í† 
   - í˜„ì¬ëŠ” ìˆœì°¨ ìƒì„± (ì•ˆì •ì„± ìš°ì„ )

3. **ìº í”„ ìŠ¬ë¡¯ ëª¨ë“œ ë¦¬íŒ©í† ë§**
   - `plan_contents` ì™„ì „ ì œê±°ë¥¼ ìœ„í•´ ìº í”„ êµ¬ì¡° ê°œì„  í•„ìš”
   - í˜„ì¬ëŠ” `is_single_content=false`ë¡œ ë ˆê±°ì‹œ ìœ ì§€

---

## ì°¸ì¡°

- [í”Œëœ ì‹œìŠ¤í…œ í†µí•© ì•„í‚¤í…ì²˜](./plan-system-unification.md)
- [ê¸°ëŠ¥ ì¸ë²¤í† ë¦¬](./plan-system-feature-inventory.md)
- [Serena Memory: plan-system-unification-architecture.md](.serena/memories/plan-system-unification-architecture.md)
