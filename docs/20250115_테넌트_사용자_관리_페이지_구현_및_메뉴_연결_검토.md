# í…Œë„ŒíŠ¸ ì‚¬ìš©ì ê´€ë¦¬ í˜ì´ì§€ êµ¬í˜„ ë° ë©”ë‰´ ì—°ê²° ê²€í† 

**ì‘ì—… ì¼ì‹œ**: 2025-01-15  
**ëª©ì **: í…Œë„ŒíŠ¸ ì‚¬ìš©ì ê´€ë¦¬ ê¸°ëŠ¥ì˜ í˜ì´ì§€ êµ¬í˜„ ìƒíƒœ ë° ë©”ë‰´ ì—°ê²° ìƒíƒœ í™•ì¸

---

## ğŸ“‹ ê²€í†  ê²°ê³¼ ìš”ì•½

### âœ… êµ¬í˜„ ì™„ë£Œëœ ê¸°ëŠ¥

1. **Super Admin - í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ê´€ë¦¬**
   - í˜ì´ì§€: `/superadmin/tenantless-users`
   - ë©”ë‰´ ì—°ê²°: âœ… ì™„ë£Œ
   - ê¸°ëŠ¥: í…Œë„ŒíŠ¸ê°€ í• ë‹¹ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì¡°íšŒ ë° í• ë‹¹

2. **Admin - ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬**
   - í˜ì´ì§€: `/admin/tenant/users`
   - ë©”ë‰´ ì—°ê²°: âœ… ì™„ë£Œ
   - ê¸°ëŠ¥: ê¸°ê´€ë³„ í•™ìƒ ë° í•™ë¶€ëª¨ ì¡°íšŒ ë° ê´€ë¦¬

---

## ğŸ” ìƒì„¸ ê²€í†  ë‚´ìš©

### 1. Super Admin - í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ê´€ë¦¬

#### í˜ì´ì§€ êµ¬í˜„ ìƒíƒœ

**íŒŒì¼**: `app/(superadmin)/superadmin/tenantless-users/page.tsx`

**êµ¬í˜„ëœ ê¸°ëŠ¥**:
- âœ… Super Admin ê¶Œí•œ ì²´í¬
- âœ… í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ì¡°íšŒ (í•™ìƒ/í•™ë¶€ëª¨/ê´€ë¦¬ì)
- âœ… ê²€ìƒ‰ ê¸°ëŠ¥ (ì´ë©”ì¼, ì´ë¦„)
- âœ… íƒ€ì…ë³„ í•„í„°ë§ (ì „ì²´/í•™ìƒ/í•™ë¶€ëª¨/ê´€ë¦¬ì)
- âœ… í˜ì´ì§€ë„¤ì´ì…˜ (í˜ì´ì§€ë‹¹ 20ëª…)
- âœ… í†µê³„ í‘œì‹œ (ì „ì²´/í•™ìƒ/í•™ë¶€ëª¨/ê´€ë¦¬ì ìˆ˜)

**Server Actions**: `app/(superadmin)/actions/tenantlessUserActions.ts`
- âœ… `getTenantlessUsers()`: í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ì¡°íšŒ
- âœ… `assignTenantToUser()`: ë‹¨ì¼ ì‚¬ìš©ì í…Œë„ŒíŠ¸ í• ë‹¹
- âœ… `assignTenantToMultipleUsers()`: ë‹¤ì¤‘ ì‚¬ìš©ì í…Œë„ŒíŠ¸ í• ë‹¹
- âœ… `getActiveTenants()`: í™œì„± í…Œë„ŒíŠ¸ ëª©ë¡ ì¡°íšŒ

#### ë©”ë‰´ ì—°ê²° ìƒíƒœ

**íŒŒì¼**: `components/navigation/global/configs/superadminCategories.tsx`

**ë©”ë‰´ êµ¬ì¡°**:
```typescript
{
  id: "superadmin-users",
  label: "ì‚¬ìš©ì ê´€ë¦¬",
  icon: <Users className="w-4 h-4" />,
  items: [
    {
      id: "superadmin-admin-users",
      label: "ê´€ë¦¬ì ê³„ì •",
      href: "/superadmin/admin-users",
    },
    {
      id: "superadmin-unverified-users",
      label: "ë¯¸ì¸ì¦ ê°€ì… ê´€ë¦¬",
      href: "/superadmin/unverified-users",
    },
    {
      id: "superadmin-tenantless-users",
      label: "í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì",
      href: "/superadmin/tenantless-users",  // âœ… ì—°ê²°ë¨
    },
  ],
}
```

**ë©”ë‰´ ìœ„ì¹˜**: "ì‚¬ìš©ì ê´€ë¦¬" ì¹´í…Œê³ ë¦¬ í•˜ìœ„  
**ì ‘ê·¼ ê²½ë¡œ**: Super Admin ëŒ€ì‹œë³´ë“œ â†’ ì‚¬ì´ë“œë°” â†’ ì‚¬ìš©ì ê´€ë¦¬ â†’ í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì

---

### 2. Admin - ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬

#### í˜ì´ì§€ êµ¬í˜„ ìƒíƒœ

**íŒŒì¼**: `app/(admin)/admin/tenant/users/page.tsx`

**êµ¬í˜„ëœ ê¸°ëŠ¥**:
- âœ… Admin ê¶Œí•œ ì²´í¬
- âœ… TenantContextë¥¼ í†µí•œ ê¸°ê´€ ì •ë³´ í™•ì¸
- âœ… ê¸°ê´€ë³„ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
- âœ… ì‚¬ìš©ì í• ë‹¹/ì´ë™ ê¸°ëŠ¥

**ì»´í¬ë„ŒíŠ¸**: `app/(admin)/admin/tenant/users/_components/TenantUsersManagement.tsx`

**ì£¼ìš” ê¸°ëŠ¥**:
- âœ… í†µê³„ ì¹´ë“œ (ì „ì²´/í•™ìƒ/í•™ë¶€ëª¨/ë¯¸í• ë‹¹ ì‚¬ìš©ì ìˆ˜)
- âœ… í•„í„°ë§ (ì „ì²´/í•™ìƒ/í•™ë¶€ëª¨)
- âœ… ê²€ìƒ‰ ê¸°ëŠ¥ (ì´ë¦„, ì´ë©”ì¼, í•™ë…„)
- âœ… ì‚¬ìš©ì ëª©ë¡ í…Œì´ë¸”
- âœ… ê¸°ê´€ í• ë‹¹/ì´ë™ ë²„íŠ¼

**Server Actions**: `app/(admin)/actions/tenantUsers.ts`
- âœ… `getTenantUsersAction()`: ê¸°ê´€ë³„ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
- âœ… `assignUserToTenantAction()`: ì‚¬ìš©ì ê¸°ê´€ í• ë‹¹/ì´ë™

#### ë©”ë‰´ ì—°ê²° ìƒíƒœ

**íŒŒì¼**: `components/navigation/global/configs/adminCategories.tsx`

**ë©”ë‰´ êµ¬ì¡°**:
```typescript
{
  id: "admin-settings",
  label: "ì„¤ì •",
  icon: <Settings className="w-4 h-4" />,
  items: [
    // ... ê¸°íƒ€ ì„¤ì • ë©”ë‰´ë“¤
    {
      id: "admin-tenant-users",
      label: "ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬",
      href: "/admin/tenant/users",  // âœ… ì—°ê²°ë¨
      icon: <Users className="w-4 h-4" />,
      roles: ["admin"],  // adminë§Œ ì ‘ê·¼
    },
  ],
}
```

**ë©”ë‰´ ìœ„ì¹˜**: "ì„¤ì •" ì¹´í…Œê³ ë¦¬ í•˜ìœ„  
**ì ‘ê·¼ ê²½ë¡œ**: Admin ëŒ€ì‹œë³´ë“œ â†’ ì‚¬ì´ë“œë°” â†’ ì„¤ì • â†’ ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬

---

## ğŸ”— ë©”ë‰´ ë„¤ë¹„ê²Œì´ì…˜ êµ¬ì¡°

### Super Admin ë©”ë‰´ êµ¬ì¡°

```
Super Admin
â”œâ”€â”€ ëŒ€ì‹œë³´ë“œ
â”œâ”€â”€ ê¸°ê´€ ê´€ë¦¬
â”œâ”€â”€ ì‚¬ìš©ì ê´€ë¦¬
â”‚   â”œâ”€â”€ ê´€ë¦¬ì ê³„ì •
â”‚   â”œâ”€â”€ ë¯¸ì¸ì¦ ê°€ì… ê´€ë¦¬
â”‚   â””â”€â”€ í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì âœ…
â””â”€â”€ ì„¤ì •
```

### Admin ë©”ë‰´ êµ¬ì¡°

```
Admin
â”œâ”€â”€ ëŒ€ì‹œë³´ë“œ
â”œâ”€â”€ í•™ìƒ ê´€ë¦¬
â”œâ”€â”€ ìƒë‹´ ë…¸íŠ¸
â”œâ”€â”€ SMS ê´€ë¦¬
â”œâ”€â”€ ë¦¬í¬íŠ¸
â”œâ”€â”€ ë¹„êµ ë¶„ì„
â”œâ”€â”€ ì„œë¹„ìŠ¤ ë§ˆìŠ¤í„°
â”œâ”€â”€ ì‹œê°„ ê´€ë¦¬
â”œâ”€â”€ ìº í”„ ê´€ë¦¬
â””â”€â”€ ì„¤ì •
    â”œâ”€â”€ ì„¤ì •
    â”œâ”€â”€ ê¸°ê´€ ì„¤ì •
    â”œâ”€â”€ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •
    â”œâ”€â”€ ì¶”ì²œ ì‹œìŠ¤í…œ ì„¤ì •
    â””â”€â”€ ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬ âœ…
```

---

## ğŸ“Š ê¸°ëŠ¥ ë¹„êµ

| ê¸°ëŠ¥ | Super Admin | Admin |
|------|------------|-------|
| **í˜ì´ì§€ ê²½ë¡œ** | `/superadmin/tenantless-users` | `/admin/tenant/users` |
| **ëŒ€ìƒ ì‚¬ìš©ì** | í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì (ì „ì²´) | ê¸°ê´€ë³„ ì‚¬ìš©ì (í˜„ì¬ ê¸°ê´€) |
| **ì¡°íšŒ ë²”ìœ„** | ëª¨ë“  í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì | í˜„ì¬ ê¸°ê´€ì˜ ì‚¬ìš©ì + ë¯¸í• ë‹¹ ì‚¬ìš©ì |
| **ì‚¬ìš©ì íƒ€ì…** | í•™ìƒ, í•™ë¶€ëª¨, ê´€ë¦¬ì | í•™ìƒ, í•™ë¶€ëª¨ |
| **í• ë‹¹ ê¸°ëŠ¥** | âœ… ë‹¨ì¼/ë‹¤ì¤‘ í• ë‹¹ | âœ… ë‹¨ì¼ í• ë‹¹ |
| **ë©”ë‰´ ìœ„ì¹˜** | ì‚¬ìš©ì ê´€ë¦¬ ì¹´í…Œê³ ë¦¬ | ì„¤ì • ì¹´í…Œê³ ë¦¬ |

---

## âš ï¸ ë°œê²¬ëœ ì´ìŠˆ ë° ê°œì„  ì‚¬í•­

### 1. ì½”ë“œ ì¤‘ë³µ ë¬¸ì œ (ê³„íšì„œì— ëª…ì‹œë¨)

**ë¬¸ì œì **:
- `assignTenantToUser` (superadmin)ì™€ `assignUserToTenantAction` (admin)ì´ ìœ ì‚¬í•œ ë¡œì§ ë°˜ë³µ
- í…Œë„ŒíŠ¸ ì¡´ì¬ í™•ì¸ ë¡œì§ ì¤‘ë³µ
- ì‚¬ìš©ì íƒ€ì…ë³„ ì—…ë°ì´íŠ¸ ë¡œì§ ì¤‘ë³µ

**ê°œì„  ë°©ì•ˆ** (ê³„íšì„œ ì°¸ì¡°):
- ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ìƒì„± (`lib/utils/tenantAssignment.ts`)
- í…Œë„ŒíŠ¸ ì¡´ì¬ í™•ì¸ ê³µí†µ í•¨ìˆ˜ (`lib/utils/tenantValidation.ts`)

### 2. ì„±ëŠ¥ ìµœì í™” í•„ìš” (ê³„íšì„œì— ëª…ì‹œë¨)

**ë¬¸ì œì **:
- `getTenantUsersAction`ì´ ëª¨ë“  ì‚¬ìš©ìë¥¼ ì¡°íšŒí•œ í›„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•„í„°ë§
- Auth ì‚¬ìš©ì ì¡°íšŒ ì‹œ ì „ì²´ ì‚¬ìš©ì ëª©ë¡ì„ í•œ ë²ˆì— ì¡°íšŒ

**ê°œì„  ë°©ì•ˆ** (ê³„íšì„œ ì°¸ì¡°):
- DB ë ˆë²¨ í•„í„°ë§ìœ¼ë¡œ ë³€ê²½
- íŠ¹ì • ì‚¬ìš©ì ID ëª©ë¡ì˜ ë©”íƒ€ë°ì´í„°ë§Œ ì¡°íšŒ

### 3. ë©”ë‰´ ìœ„ì¹˜ ì¼ê´€ì„±

**í˜„ì¬ ìƒíƒœ**:
- Super Admin: "ì‚¬ìš©ì ê´€ë¦¬" ì¹´í…Œê³ ë¦¬ í•˜ìœ„
- Admin: "ì„¤ì •" ì¹´í…Œê³ ë¦¬ í•˜ìœ„

**ê²€í†  ì‚¬í•­**:
- Adminì˜ "ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬"ê°€ "ì„¤ì •" ì¹´í…Œê³ ë¦¬ì— ìˆëŠ” ê²ƒì´ ì ì ˆí•œì§€ ê²€í†  í•„ìš”
- "í•™ìƒ ê´€ë¦¬" ì¹´í…Œê³ ë¦¬ í•˜ìœ„ë¡œ ì´ë™í•˜ëŠ” ê²ƒë„ ê³ ë ¤ ê°€ëŠ¥

---

## âœ… ê²€ì¦ ì™„ë£Œ ì‚¬í•­

1. âœ… í˜ì´ì§€ íŒŒì¼ ì¡´ì¬ í™•ì¸
   - `/superadmin/tenantless-users/page.tsx` âœ…
   - `/admin/tenant/users/page.tsx` âœ…

2. âœ… Server Actions êµ¬í˜„ í™•ì¸
   - `app/(superadmin)/actions/tenantlessUserActions.ts` âœ…
   - `app/(admin)/actions/tenantUsers.ts` âœ…

3. âœ… ë©”ë‰´ ì„¤ì • í™•ì¸
   - Super Admin ë©”ë‰´: `superadminCategories.tsx` âœ…
   - Admin ë©”ë‰´: `adminCategories.tsx` âœ…

4. âœ… ê¶Œí•œ ì²´í¬ êµ¬í˜„ í™•ì¸
   - Super Admin í˜ì´ì§€: `role !== "superadmin"` ì²´í¬ âœ…
   - Admin í˜ì´ì§€: `role !== "admin"` ì²´í¬ âœ…

5. âœ… ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ í™•ì¸
   - `TenantlessUsersList.tsx` âœ…
   - `TenantUsersManagement.tsx` âœ…

---

## ğŸ“ ê²°ë¡ 

### êµ¬í˜„ ìƒíƒœ

**âœ… ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, ë©”ë‰´ ì—°ê²°ë„ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.**

1. **Super Admin - í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ê´€ë¦¬**
   - í˜ì´ì§€ êµ¬í˜„: âœ… ì™„ë£Œ
   - ë©”ë‰´ ì—°ê²°: âœ… ì™„ë£Œ
   - ê¸°ëŠ¥ ë™ì‘: âœ… ì •ìƒ

2. **Admin - ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬**
   - í˜ì´ì§€ êµ¬í˜„: âœ… ì™„ë£Œ
   - ë©”ë‰´ ì—°ê²°: âœ… ì™„ë£Œ
   - ê¸°ëŠ¥ ë™ì‘: âœ… ì •ìƒ

### ë‹¤ìŒ ë‹¨ê³„

ê³„íšì„œ(`.cursor/plans/-b4d37dcd.plan.md`)ì— ëª…ì‹œëœ ë¦¬íŒ©í† ë§ ì‘ì—…ì„ ì§„í–‰í•˜ì—¬:
1. ì½”ë“œ ì¤‘ë³µ ì œê±°
2. ì„±ëŠ¥ ìµœì í™”
3. íƒ€ì… ì•ˆì „ì„± ê°•í™”
4. ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ìƒì„±

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- [í…Œë„ŒíŠ¸ ì‚¬ìš©ì ê´€ë¦¬ ì½”ë“œ ìµœì í™” ê³„íš](./.cursor/plans/-b4d37dcd.plan.md)
- [Super Admin í…Œë„ŒíŠ¸ ë¯¸í• ë‹¹ ì‚¬ìš©ì ê´€ë¦¬ êµ¬í˜„](./2025-02-02-tenantless-users-management.md)
- [ê¸°ê´€ë³„ ì‚¬ìš©ì ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„ (Phase 1)](./2025-02-02-tenant-users-management-phase1.md)

