# 캠프 템플릿 학생 입력 제한 수정 (추가)

## 📋 작업 개요

캠프 템플릿에서 "학생 입력 허용"이 체크되지 않은 필드들이 학생이 캠프 템플릿을 작성할 때 `onChange` 핸들러에서 체크되지 않아 수정 가능한 문제를 수정했습니다.

## 🐛 문제 분석

### 문제 상황

- 캠프 템플릿에서 "학생 입력 허용"이 체크되지 않은 필드는 수정 불가능해야 함
- `disabled` 속성은 설정되어 있었지만, `onChange` 핸들러에서 입력 허용 여부를 체크하지 않음
- 결과적으로 브라우저 개발자 도구나 다른 방법으로 우회하여 수정할 수 있는 가능성이 있었음

### 원인

`Step1BasicInfo` 컴포넌트의 일부 필드에서 `onChange` 핸들러에 `canStudentInput*` 체크가 누락되어 있었습니다.

**영향받는 필드**:
- 플랜 이름 (`name`)
- 플랜 목적 (`plan_purpose`)

**영향받는 파일**:
- `app/(student)/plan/new-group/_components/_features/basic-info/Step1BasicInfo.tsx`

### 문제 상세

1. **플랜 이름 필드** (262-265번 줄):
   - `disabled` 속성에는 `canStudentInputName` 체크가 있음
   - 하지만 `onChange` 핸들러에는 `canStudentInputName` 체크가 없음
   - 결과적으로 `disabled`를 우회하면 수정 가능

2. **플랜 목적 필드** (329-336번 줄):
   - `disabled` 속성에는 `canStudentInputPlanPurpose` 체크가 있음
   - 하지만 `onChange` 핸들러에는 `canStudentInputPlanPurpose` 체크가 없음
   - 결과적으로 `disabled`를 우회하면 수정 가능

## ✅ 수정 내용

### `Step1BasicInfo.tsx`

#### 1. 플랜 이름 필드 수정

```typescript
// 수정 전
onChange={(e) => {
  if (!editable) return;
  onUpdate({ name: e.target.value });
}}

// 수정 후
onChange={(e) => {
  if (!editable) return;
  if (isCampMode && !canStudentInputName) return;
  onUpdate({ name: e.target.value });
}}
```

#### 2. 플랜 목적 필드 수정

```typescript
// 수정 전
onChange={() => {
  if (!editable) return;
  onUpdate({ 
    plan_purpose: (purpose.value === "내신대비" || purpose.value === "모의고사(수능)" || purpose.value === "")
      ? purpose.value
      : "" as WizardData["plan_purpose"]
  });
}}

// 수정 후
onChange={() => {
  if (!editable) return;
  if (isCampMode && !canStudentInputPlanPurpose) return;
  onUpdate({ 
    plan_purpose: (purpose.value === "내신대비" || purpose.value === "모의고사(수능)" || purpose.value === "")
      ? purpose.value
      : "" as WizardData["plan_purpose"]
  });
}}
```

## 🔍 동작 원리

### 이중 방어 체계

1. **UI 레벨 방어**: `disabled` 속성으로 사용자 인터페이스에서 입력을 차단
2. **로직 레벨 방어**: `onChange` 핸들러에서 입력 허용 여부를 체크하여 우회 시도를 방지

### 체크 순서

```typescript
onChange={(e) => {
  // 1. 기본 편집 가능 여부 체크
  if (!editable) return;
  
  // 2. 캠프 모드에서 학생 입력 허용 여부 체크
  if (isCampMode && !canStudentInputName) return;
  
  // 3. 업데이트 수행
  onUpdate({ name: e.target.value });
}}
```

## 🧪 테스트 시나리오

### 시나리오 1: 플랜 이름 필드 수정 방지 확인

1. 캠프 템플릿 생성 페이지에서 "학생 입력 허용" 체크박스 해제
2. 학생 모드에서 캠프 템플릿 작성 페이지 접속
3. 플랜 이름 필드가 비활성화되어 있는지 확인
4. 브라우저 개발자 도구로 `disabled` 속성 제거 시도
5. 필드에 입력해도 값이 변경되지 않는지 확인

**예상 결과**:
- 필드가 비활성화되어 있음
- `disabled` 속성을 제거해도 `onChange`에서 체크하여 값이 변경되지 않음

### 시나리오 2: 플랜 목적 필드 수정 방지 확인

1. 캠프 템플릿 생성 페이지에서 "학생 입력 허용" 체크박스 해제
2. 학생 모드에서 캠프 템플릿 작성 페이지 접속
3. 플랜 목적 라디오 버튼이 비활성화되어 있는지 확인
4. 브라우저 개발자 도구로 `disabled` 속성 제거 시도
5. 라디오 버튼 클릭해도 선택이 변경되지 않는지 확인

**예상 결과**:
- 라디오 버튼이 비활성화되어 있음
- `disabled` 속성을 제거해도 `onChange`에서 체크하여 선택이 변경되지 않음

## 📝 변경된 파일 목록

1. `app/(student)/plan/new-group/_components/_features/basic-info/Step1BasicInfo.tsx`
   - 플랜 이름 필드 `onChange` 핸들러에 `canStudentInputName` 체크 추가
   - 플랜 목적 필드 `onChange` 핸들러에 `canStudentInputPlanPurpose` 체크 추가

## ✅ 검증 완료

- [x] TypeScript 타입 에러 없음
- [x] ESLint 에러 없음
- [x] 모든 관련 필드에서 일관된 패턴 적용
- [x] 이중 방어 체계 구현 (UI 레벨 + 로직 레벨)

## 🔄 관련 수정 사항

이 수정은 이전에 수정된 내용의 보완입니다:
- `docs/20251222_035407-캠프-템플릿-학생-입력-제한-수정.md`: `isCampMode` prop 전달 문제 수정
- `docs/20251222_034621-학생-입력-허용-및-블록-세트-저장-수정.md`: 학생 입력 허용 토글 기능 수정

## 📚 참고 사항

### 다른 필드들의 상태

다음 필드들은 이미 `onChange` 핸들러에서 입력 허용 여부를 체크하고 있습니다:
- ✅ 스케줄러 유형 (`scheduler_type`)
- ✅ 학습 기간 (`period_start`, `period_end`) - `PeriodSection` 컴포넌트에서 처리
- ✅ 블록 세트 (`block_set_id`) - `BlockSetSection` 컴포넌트에서 처리
- ✅ 학습일/복습일 수 (`study_review_cycle`) - 이미 체크 있음

### 보안 고려사항

- `disabled` 속성만으로는 보안이 보장되지 않음
- 서버 사이드에서도 입력 허용 여부를 검증해야 함 (향후 개선 사항)
- 클라이언트 사이드 검증은 사용자 경험 개선을 위한 것


