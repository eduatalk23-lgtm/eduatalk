# 출석 관리 메뉴 구조 재구성

**작성일**: 2025-02-03  
**버전**: 1.0

---

## 개요

관리자 네비게이션에서 출석 관리 기능을 "학생 관리" 카테고리에서 분리하여 독립된 카테고리로 재구성했습니다.

---

## 변경 사항

### 네비게이션 구조 변경

#### 이전 구조
```
관리자 메뉴
├── 학생 관리
│   ├── 학생 목록
│   ├── 출석 관리          ← 출석 관련 메뉴들이 여기에 위치
│   ├── QR 코드 생성
│   ├── 출석 위치 설정
│   └── ...
```

#### 변경 후 구조
```
관리자 메뉴
├── 학생 관리
│   ├── 학생 목록
│   ├── 학부모 연결 관리
│   ├── 학생 구분 관리
│   └── 구분 항목 관리
│
└── 출석 관리 (신규 독립 카테고리)  ← 출석 관련 메뉴들이 독립 카테고리로 분리
    ├── 출석 기록
    ├── 출석 통계
    ├── QR 코드 관리
    ├── 출석 설정
    └── SMS 로그
```

### 메뉴 항목 상세

#### 출석 관리 카테고리

| 메뉴 항목 | 경로 | 설명 |
|---------|------|------|
| 출석 기록 | `/admin/attendance` | 출석 기록 조회 및 입력 |
| 출석 통계 | `/admin/attendance/statistics` | 출석 통계 및 분석 |
| QR 코드 관리 | `/admin/attendance/qr-code` | QR 코드 생성 및 관리 |
| 출석 설정 | `/admin/attendance/settings` | 출석 관련 설정 |
| SMS 로그 | `/admin/attendance/sms-logs` | SMS 발송 로그 확인 |

---

## 변경 이유

1. **사용자 경험 개선**: 출석 관리 기능을 더 쉽게 찾을 수 있도록 독립 카테고리로 분리
2. **메뉴 위계 명확화**: 출석 관리가 학생 관리의 하위 기능이 아닌 독립적인 기능임을 명확히 함
3. **확장성**: 향후 출석 관련 기능 추가 시 자연스러운 배치 가능

---

## 영향 범위

### 변경된 파일

1. **네비게이션 설정**
   - `components/navigation/global/configs/adminCategories.tsx`
   - 출석 관리 항목을 "학생 관리"에서 제거하고 독립 카테고리로 생성

2. **문서**
   - `docs/attendance/admin-manual.md`
   - 네비게이션 경로 업데이트 반영

### 영향 없는 부분

- **URL 경로**: 기존 URL 경로는 변경되지 않음 (`/admin/attendance/*`)
- **권한 관리**: 출석 관리 카테고리는 admin과 consultant 모두 접근 가능 (변경 없음)
- **학생 상세 페이지**: 학생 상세 페이지의 출석 섹션은 그대로 유지

---

## 컴포넌트 구조 확인

### 재사용 가능한 컴포넌트

출석 관련 컴포넌트들은 이미 재사용 가능하도록 잘 설계되어 있습니다:

- `AttendanceStatistics`: 출석 통계 표시 컴포넌트
  - 출석 관리 페이지 (`/admin/attendance`)에서 사용
  - 학생 상세 페이지 (`/admin/students/[id]`)에서 사용

- `AttendanceList`: 출석 목록 표시 컴포넌트
  - 학생 상세 페이지에서 사용

- `AttendanceRecordForm`: 출석 기록 입력 폼 컴포넌트
  - 학생 상세 페이지에서 사용

**결론**: 추가 최적화 불필요

---

## 데이터베이스 확인

### RLS 정책

출석 관련 테이블의 RLS 정책이 올바르게 설정되어 있습니다:

- **관리자**: 자신의 테넌트 내 모든 출석 기록 조회/수정 가능
- **학생**: 자신의 출석 기록만 조회/생성/수정 가능
- **학부모**: 자녀의 출석 기록 조회 가능

### 인덱스 최적화

필요한 인덱스가 모두 생성되어 있습니다:

- `idx_attendance_records_tenant_id`: tenant_id 인덱스
- `idx_attendance_records_student_id`: student_id 인덱스
- `idx_attendance_records_attendance_date`: attendance_date 인덱스
- `idx_attendance_records_status`: status 인덱스
- `idx_attendance_records_student_date`: (student_id, attendance_date) 복합 인덱스

---

## 사용자 가이드

### 출석 관리 메뉴 접근 방법

1. 관리자 페이지에 로그인
2. 좌측 네비게이션 메뉴에서 **"출석 관리"** 카테고리 클릭
3. 원하는 메뉴 항목 선택

### 주요 기능

- **출석 기록**: 일별/학생별 출석 기록 조회 및 입력
- **출석 통계**: 출석률, 지각률, 결석률 등 통계 확인
- **QR 코드 관리**: QR 코드 생성 및 활성화/비활성화 관리
- **출석 설정**: 출석 관련 설정 (위치, SMS 등)
- **SMS 로그**: 출석 관련 SMS 발송 이력 확인

---

## 마이그레이션 가이드

### 사용자 측면

- **URL 변경 없음**: 기존 북마크나 링크가 그대로 작동합니다
- **메뉴 위치 변경**: 출석 관리 메뉴가 "학생 관리" 하위에서 독립 카테고리로 이동했습니다

### 개발자 측면

- **컴포넌트 구조**: 변경 없음 (이미 재사용 가능하도록 설계됨)
- **타입 정의**: 변경 없음 (`lib/domains/attendance/types.ts`)
- **API 경로**: 변경 없음

---

## 향후 개선 사항

1. **타입 안전성 강화**: Next.js 15의 `Route` 타입을 활용한 타입 안전한 href 정의 검토
2. **아이콘 일관성**: 모든 출석 관리 메뉴 항목의 아이콘 일관성 확인 및 개선

---

## 관련 문서

- [출석 관리 매뉴얼](./admin-manual.md)
- [출석 기능 사용 가이드](./user-guide.md)
- [QR 코드 시스템 가이드](./qr-code-system-guide.md)
- [SMS 설정 가이드](./sms-settings-guide.md)

---

**작성자**: AI Assistant  
**검토자**: -  
**승인자**: -

