# í•™ìƒ ì…ë ¥ í—ˆìš© ë° ë¸”ë¡ ì„¸íŠ¸ ì €ì¥ ìˆ˜ì •

## ğŸ“‹ ì‘ì—… ê°œìš”

í”Œëœ ìœ„ì €ë“œì—ì„œ ë‹¤ìŒ ë‘ ê°€ì§€ ë¬¸ì œë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤:

1. **í•™ìƒ ì…ë ¥ í—ˆìš© ê¸°ëŠ¥ ì‘ë™ ë¬¸ì œ**: ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ìƒíƒœê°€ ì˜¬ë°”ë¥´ê²Œ ë°˜ì˜ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ
2. **ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ í›„ ì €ì¥ ë¬¸ì œ**: ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ í›„ ì €ì¥ì´ ì•ˆ ë˜ëŠ” ë¬¸ì œ

## ğŸ› ë¬¸ì œ ë¶„ì„

### ë¬¸ì œ 1: í•™ìƒ ì…ë ¥ í—ˆìš© ê¸°ëŠ¥ ì‘ë™ ë¬¸ì œ

**ì›ì¸**:
- `CollapsibleSection` ì»´í¬ë„ŒíŠ¸ì—ì„œ ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ `e.target.checked` ê°’ì„ `onStudentInputToggle` ì½œë°±ì— ì „ë‹¬
- í•˜ì§€ë§Œ `toggleFieldControl` í•¨ìˆ˜ëŠ” `enabled` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì§€ ì•Šê³  ë‚´ë¶€ì—ì„œ ìë™ í† ê¸€ë§Œ ìˆ˜í–‰
- ê²°ê³¼ì ìœ¼ë¡œ ì²´í¬ë°•ìŠ¤ ìƒíƒœì™€ ì‹¤ì œ ë°ì´í„° ìƒíƒœê°€ ë¶ˆì¼ì¹˜

**ì˜í–¥ë°›ëŠ” íŒŒì¼**:
- `app/(student)/plan/new-group/_components/utils/fieldLockUtils.ts`
- `app/(student)/plan/new-group/_components/_features/basic-info/Step1BasicInfo.tsx`
- `app/(student)/plan/new-group/_components/_features/basic-info/components/BlockSetSection.tsx`
- `app/(student)/plan/new-group/_components/_features/basic-info/components/PeriodSection.tsx`

### ë¬¸ì œ 2: ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ í›„ ì €ì¥ ë¬¸ì œ

**ì›ì¸**:
- ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ ì‹œ `e.target.value`ê°€ ë¹ˆ ë¬¸ìì—´ì¼ ìˆ˜ ìˆìŒ
- `e.target.value || undefined`ë¡œ ì²˜ë¦¬í–ˆì§€ë§Œ, ë¹ˆ ë¬¸ìì—´ì´ ê·¸ëŒ€ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆìŒ
- ê²°ê³¼ì ìœ¼ë¡œ `block_set_id`ê°€ ë¹ˆ ë¬¸ìì—´ë¡œ ì €ì¥ë˜ì–´ ì €ì¥ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•ŠìŒ

**ì˜í–¥ë°›ëŠ” íŒŒì¼**:
- `app/(student)/plan/new-group/_components/_features/basic-info/components/BlockSetSection.tsx`

## âœ… ìˆ˜ì • ë‚´ìš©

### 1. í•™ìƒ ì…ë ¥ í—ˆìš© ê¸°ëŠ¥ ìˆ˜ì •

#### `fieldLockUtils.ts`

```typescript
// ìˆ˜ì • ì „
export function toggleFieldControl(
  fieldName: keyof NonNullable<TemplateLockedFields["step1"]>,
  currentLocked: TemplateLockedFields["step1"] | undefined
): TemplateLockedFields["step1"] {
  const locked = currentLocked || {};
  const currentValue = locked[fieldName];
  const newValue = currentValue === true ? false : true;
  return {
    ...locked,
    [fieldName]: newValue,
  };
}

// ìˆ˜ì • í›„
export function toggleFieldControl(
  fieldName: keyof NonNullable<TemplateLockedFields["step1"]>,
  currentLocked: TemplateLockedFields["step1"] | undefined,
  enabled?: boolean  // ëª…ì‹œì  ê°’ ì¶”ê°€
): TemplateLockedFields["step1"] {
  const locked = currentLocked || {};
  
  // enabled ê°’ì´ ëª…ì‹œì ìœ¼ë¡œ ì œê³µë˜ë©´ ê·¸ ê°’ì„ ì‚¬ìš©, ì•„ë‹ˆë©´ ìë™ í† ê¸€
  const newValue = enabled !== undefined 
    ? enabled 
    : (locked[fieldName] === true ? false : true);

  return {
    ...locked,
    [fieldName]: newValue,
  };
}
```

#### `Step1BasicInfo.tsx`

```typescript
// ìˆ˜ì • ì „
const toggleFieldControl = (fieldName: keyof NonNullable<TemplateLockedFields["step1"]>) => {
  if (!isTemplateMode || !data) return;
  const currentLocked = data.templateLockedFields?.step1;
  const newLocked = toggleFieldControlUtil(fieldName, currentLocked);
  onUpdate(updateFieldLock(data, newLocked));
};

// ìˆ˜ì • í›„
const toggleFieldControl = (fieldName: keyof NonNullable<TemplateLockedFields["step1"]>, enabled?: boolean) => {
  if (!isTemplateMode || !data) return;
  const currentLocked = data.templateLockedFields?.step1;
  const newLocked = toggleFieldControlUtil(fieldName, currentLocked, enabled);
  onUpdate(updateFieldLock(data, newLocked));
};
```

#### ëª¨ë“  `CollapsibleSection`ì˜ `onStudentInputToggle` ìˆ˜ì •

```typescript
// ìˆ˜ì • ì „
onStudentInputToggle={(enabled) =>
  toggleFieldControl("allow_student_name")
}

// ìˆ˜ì • í›„
onStudentInputToggle={(enabled) =>
  toggleFieldControl("allow_student_name", enabled)
}
```

**ìˆ˜ì •ëœ ì„¹ì…˜**:
- í”Œëœ ì´ë¦„ (`allow_student_name`)
- í”Œëœ ëª©ì  (`allow_student_plan_purpose`)
- ìŠ¤ì¼€ì¤„ëŸ¬ ìœ í˜• (`allow_student_scheduler_type`)
- í•™ìŠµ ê¸°ê°„ (`allow_student_period`)
- ë¸”ë¡ ì„¸íŠ¸ (`allow_student_block_set_id`)
- ì¶”ê°€ ê¸°ê°„ í•™ìŠµ ë²”ìœ„ ì¬ë°°ì¹˜ (`allow_student_additional_period_reallocation`)

### 2. ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ í›„ ì €ì¥ ë¬¸ì œ ìˆ˜ì •

#### `BlockSetSection.tsx`

```typescript
// ìˆ˜ì • ì „
onChange={(e) => {
  if (!editable || (isCampMode && !canStudentInputBlockSetId)) return;
  onUpdate({
    block_set_id: e.target.value || undefined,
  });
}}

// ìˆ˜ì • í›„
onChange={(e) => {
  if (!editable || (isCampMode && !canStudentInputBlockSetId)) return;
  const blockSetId = e.target.value?.trim() || undefined;
  onUpdate({
    block_set_id: blockSetId,
  });
}}
```

**ë³€ê²½ ì‚¬í•­**:
- `e.target.value?.trim()`ì„ ì‚¬ìš©í•˜ì—¬ ë¹ˆ ë¬¸ìì—´ì„ ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬
- ë¹ˆ ë¬¸ìì—´ì´ë©´ `undefined`ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: í•™ìƒ ì…ë ¥ í—ˆìš© ì²´í¬ë°•ìŠ¤ ì‘ë™ í™•ì¸

1. í…œí”Œë¦¿ ëª¨ë“œì—ì„œ í”Œëœ ìƒì„± í˜ì´ì§€ ì ‘ì†
2. ê° ì„¹ì…˜ì˜ "í•™ìƒ ì…ë ¥ í—ˆìš©" ì²´í¬ë°•ìŠ¤ í´ë¦­
3. ì²´í¬ë°•ìŠ¤ ìƒíƒœê°€ ì˜¬ë°”ë¥´ê²Œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸
4. ë‹¤ì‹œ í´ë¦­í•˜ì—¬ í•´ì œ ì‹œ ìƒíƒœê°€ ì˜¬ë°”ë¥´ê²Œ ë°˜ì˜ë˜ëŠ”ì§€ í™•ì¸

**ì˜ˆìƒ ê²°ê³¼**:
- ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ ì¦‰ì‹œ ìƒíƒœ ë°˜ì˜
- ì²´í¬ë°•ìŠ¤ ìƒíƒœì™€ ì‹¤ì œ ë°ì´í„° ìƒíƒœ ì¼ì¹˜

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ í›„ ì €ì¥ í™•ì¸

1. í”Œëœ ìƒì„± í˜ì´ì§€ì—ì„œ ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ
2. ë‹¤ë¥¸ ë¸”ë¡ ì„¸íŠ¸ë¡œ ë³€ê²½
3. ì €ì¥ ë²„íŠ¼ í´ë¦­
4. ì €ì¥ í›„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì„ íƒí•œ ë¸”ë¡ ì„¸íŠ¸ê°€ ìœ ì§€ë˜ëŠ”ì§€ í™•ì¸

**ì˜ˆìƒ ê²°ê³¼**:
- ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ ì‹œ ì¦‰ì‹œ `wizardData`ì— ë°˜ì˜
- ì €ì¥ í›„ì—ë„ ì„ íƒí•œ ë¸”ë¡ ì„¸íŠ¸ê°€ ìœ ì§€ë¨

## ğŸ“ ë³€ê²½ëœ íŒŒì¼ ëª©ë¡

1. `app/(student)/plan/new-group/_components/utils/fieldLockUtils.ts`
   - `toggleFieldControl` í•¨ìˆ˜ì— `enabled` íŒŒë¼ë¯¸í„° ì¶”ê°€

2. `app/(student)/plan/new-group/_components/_features/basic-info/Step1BasicInfo.tsx`
   - `toggleFieldControl` í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ìˆ˜ì •
   - ëª¨ë“  `onStudentInputToggle` ì½œë°±ì—ì„œ `enabled` ê°’ ì „ë‹¬
   - íƒ€ì… ë‹¨ì–¸ ì œê±°

3. `app/(student)/plan/new-group/_components/_features/basic-info/components/BlockSetSection.tsx`
   - `toggleFieldControl` íƒ€ì… ì‹œê·¸ë‹ˆì²˜ ìˆ˜ì •
   - `onStudentInputToggle` ì½œë°±ì—ì„œ `enabled` ê°’ ì „ë‹¬
   - ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ ì‹œ ë¹ˆ ë¬¸ìì—´ ì²˜ë¦¬ ê°œì„ 

4. `app/(student)/plan/new-group/_components/_features/basic-info/components/PeriodSection.tsx`
   - `toggleFieldControl` íƒ€ì… ì‹œê·¸ë‹ˆì²˜ ìˆ˜ì •
   - ëª¨ë“  `onStudentInputToggle` ì½œë°±ì—ì„œ `enabled` ê°’ ì „ë‹¬

## âœ… ê²€ì¦ ì™„ë£Œ

- [x] TypeScript íƒ€ì… ì—ëŸ¬ ì—†ìŒ
- [x] ESLint ì—ëŸ¬ ì—†ìŒ
- [x] ëª¨ë“  ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¼ê´€ëœ íŒ¨í„´ ì ìš©
- [x] ë¹ˆ ë¬¸ìì—´ ì²˜ë¦¬ ë¡œì§ ê°œì„ 

## ğŸ”„ í–¥í›„ ê°œì„  ì‚¬í•­

1. **íƒ€ì… ì•ˆì „ì„± ê°œì„ **: `toggleFieldControl`ì˜ `fieldName` íŒŒë¼ë¯¸í„°ë¥¼ ë” ì—„ê²©í•œ íƒ€ì…ìœ¼ë¡œ ì œí•œ
2. **í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€**: í•™ìƒ ì…ë ¥ í—ˆìš© ê¸°ëŠ¥ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€
3. **ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **: ë¸”ë¡ ì„¸íŠ¸ ì„ íƒ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ í”¼ë“œë°± ì œê³µ

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [í•™ìƒ ì…ë ¥ í—ˆìš© ê¸°ëŠ¥ ê°œì„  ë¬¸ì„œ](./camp-student-form-improvements.md)
- [ë¸”ë¡ ì„¸íŠ¸ í…œí”Œë¦¿ ì €ì¥ ê°œì„  ë¬¸ì„œ](./ë¸”ë¡-ì„¸íŠ¸-í…œí”Œë¦¿-ì €ì¥-ê°œì„ -ë°©ì•ˆ.md)

