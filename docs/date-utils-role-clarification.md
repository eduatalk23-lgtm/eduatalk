# ë‚ ì§œ ìœ í‹¸ë¦¬í‹° ì—­í•  ëª…í™•í™” ë¬¸ì„œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” `lib/utils/date.ts`ì™€ `lib/utils/dateUtils.ts` ë‘ íŒŒì¼ì˜ ì—­í• ì„ ëª…í™•íˆ í•˜ê³ , ì¤‘ë³µ ì—¬ë¶€ë¥¼ í™•ì¸í•œ ê²°ê³¼ì…ë‹ˆë‹¤.

**ì‘ì„±ì¼**: 2025-02-04  
**ì‘ì—…**: Phase 2.1 - ë‚ ì§œ ìœ í‹¸ë¦¬í‹° ì—­í•  ëª…í™•í™”

---

## ğŸ“ íŒŒì¼ë³„ ì—­í•  ë° í•¨ìˆ˜ ëª©ë¡

### 1. `lib/utils/date.ts` - ê¸°ë³¸ ë‚ ì§œ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹°

**ëª©ì **: UI ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ì ì¸ ë‚ ì§œ ì²˜ë¦¬ ë¡œì§  
**íŠ¹ì§•**: 
- íƒ€ì„ì¡´ì„ ê³ ë ¤í•˜ì§€ ì•ŠìŒ
- YYYY-MM-DD í˜•ì‹ ë¬¸ìì—´ ì¤‘ì‹¬
- ê°„ë‹¨í•œ ë‚ ì§œ ì—°ì‚° ë° í¬ë§·íŒ…
- ë¸Œë¼ìš°ì € ë¡œì»¬ íƒ€ì„ì¡´ ì‚¬ìš©

**í•¨ìˆ˜ ëª©ë¡ (16ê°œ)**:

| í•¨ìˆ˜ëª… | ì„¤ëª… | ë°˜í™˜ íƒ€ì… |
|--------|------|----------|
| `getTodayParts()` | ì˜¤ëŠ˜ ë‚ ì§œì˜ ì—°/ì›”/ì¼ ë°˜í™˜ | `{ year: number; month: number; day: number }` |
| `parseDateString(dateStr)` | YYYY-MM-DD ë¬¸ìì—´ì„ ì—°/ì›”/ì¼ë¡œ íŒŒì‹± | `{ year: number; month: number; day: number }` |
| `formatDateString(year, month, day)` | ì—°/ì›”/ì¼ì„ YYYY-MM-DD ë¬¸ìì—´ë¡œ ë³€í™˜ | `string` |
| `formatDateFromDate(date)` | Date ê°ì²´ë¥¼ YYYY-MM-DD ë¬¸ìì—´ë¡œ ë³€í™˜ | `string` |
| `getDaysInMonth(year, month)` | í•´ë‹¹ ì›”ì˜ ë§ˆì§€ë§‰ ì¼ ê³„ì‚° (ìœ¤ë…„ ê³ ë ¤) | `number` |
| `getDaysDifference(startDate, endDate)` | ë‘ ë‚ ì§œ ì‚¬ì´ì˜ ì¼ ìˆ˜ ê³„ì‚° | `number` |
| `getWeeksDifference(startDate, endDate)` | ë‘ ë‚ ì§œ ì‚¬ì´ì˜ ì£¼ ìˆ˜ ê³„ì‚° | `number` |
| `calculateEndDate(startDate, weeks)` | ì‹œì‘ ë‚ ì§œì™€ ì£¼ ìˆ˜ë¡œ ì¢…ë£Œ ë‚ ì§œ ê³„ì‚° | `string` |
| `addDaysToDate(dateStr, days)` | ë‚ ì§œ ë¬¸ìì—´ì— ì¼ìˆ˜ ë”í•˜ê±°ë‚˜ ë¹¼ê¸° | `string` |
| `calculateDday(targetDate)` | íŠ¹ì • ë‚ ì§œê¹Œì§€ D-day ê³„ì‚° | `number` |
| `isValidDateString(dateStr)` | ë‚ ì§œ ìœ íš¨ì„± ê²€ì‚¬ | `boolean` |
| `isValidDateRange(startDate, endDate)` | ë‚ ì§œ ë²”ìœ„ ìœ íš¨ì„± ê²€ì‚¬ (ì‹œì‘ <= ì¢…ë£Œ) | `boolean` |
| `isFutureDate(dateStr)` | ì£¼ì–´ì§„ ë‚ ì§œê°€ ì˜¤ëŠ˜ ì´í›„ì¸ì§€ í™•ì¸ | `boolean` |
| `getDayOfWeekName(dayNumber)` | ìš”ì¼ ë²ˆí˜¸ë¥¼ í•œê¸€ ìš”ì¼ë¡œ ë³€í™˜ | `string` |
| `getDayOfWeek(dateStr)` | ë‚ ì§œì—ì„œ ìš”ì¼ ë²ˆí˜¸ ì¶”ì¶œ (0: ì¼ìš”ì¼) | `number` |
| `generateDateRange(startDate, endDate)` | ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ ì‚¬ì´ì˜ ëª¨ë“  ë‚ ì§œ ìƒì„± | `string[]` |

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
import { formatDateString, getDaysDifference } from "@/lib/utils/date";

// ë‚ ì§œ í¬ë§·íŒ… (UI í‘œì‹œìš©)
const dateStr = formatDateString(2025, 2, 4); // "2025-02-04"

// ë‚ ì§œ ì°¨ì´ ê³„ì‚° (ê°„ë‹¨í•œ ì—°ì‚°)
const days = getDaysDifference("2025-01-01", "2025-01-31"); // 30
```

---

### 2. `lib/utils/dateUtils.ts` - íƒ€ì„ì¡´ ê³ ë ¤ ë‚ ì§œ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹°

**ëª©ì **: ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë° í•™ìŠµ ì§€í‘œ ê³„ì‚° ì‹œ íƒ€ì„ì¡´ì„ ê³ ë ¤í•œ ë‚ ì§œ ì²˜ë¦¬  
**íŠ¹ì§•**:
- íƒ€ì„ì¡´ì„ ëª…ì‹œì ìœ¼ë¡œ ê³ ë ¤í•¨ (ê¸°ë³¸ê°’: Asia/Seoul, KST, UTC+9)
- date-fns/tz ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- UTC Date ê°ì²´ì™€ íƒ€ì„ì¡´ ê°„ ë³€í™˜
- í•™ìŠµ ì§€í‘œê°€ 0ì‹œ~9ì‹œ ì‚¬ì´ ëˆ„ë½ë˜ëŠ” ë¬¸ì œ í•´ê²°

**í•¨ìˆ˜ ëª©ë¡ (6ê°œ)**:

| í•¨ìˆ˜ëª… | ì„¤ëª… | ë°˜í™˜ íƒ€ì… |
|--------|------|----------|
| `getStartOfDayUTC(date, timezone?)` | íŠ¹ì • íƒ€ì„ì¡´ì˜ í•˜ë£¨ ì‹œì‘ ì‹œê°„ì„ UTC Dateë¡œ ë³€í™˜ | `Date` |
| `getEndOfDayUTC(date, timezone?)` | íŠ¹ì • íƒ€ì„ì¡´ì˜ í•˜ë£¨ ë ì‹œê°„ì„ UTC Dateë¡œ ë³€í™˜ | `Date` |
| `formatDateInTimezone(date, timezone?)` | UTC Dateë¥¼ íŠ¹ì • íƒ€ì„ì¡´ ê¸°ì¤€ìœ¼ë¡œ YYYY-MM-DD ë¬¸ìì—´ë¡œ ë³€í™˜ | `string` |
| `getTodayInTimezone(timezone?)` | í˜„ì¬ ì‹œê°„ì„ íŠ¹ì • íƒ€ì„ì¡´ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ë°˜í™˜ | `string` |
| `isSameDayInTimezone(date1, date2, timezone?)` | ë‘ ë‚ ì§œê°€ íŠ¹ì • íƒ€ì„ì¡´ì—ì„œ ê°™ì€ ë‚ ì¸ì§€ í™•ì¸ | `boolean` |
| `parseDateInTimezone(dateStr, timezone?)` | íƒ€ì„ì¡´ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë¬¸ìì—´ì„ Date ê°ì²´ë¡œ ë³€í™˜ | `Date` |

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
import { getStartOfDayUTC, formatDateInTimezone } from "@/lib/utils/dateUtils";

// ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ë¥¼ ìœ„í•œ ë‚ ì§œ ë²”ìœ„ ì„¤ì • (íƒ€ì„ì¡´ ê³ ë ¤)
const startOfDay = getStartOfDayUTC("2025-02-04", "Asia/Seoul");
// KST 2025-02-04 00:00:00 â†’ UTC 2025-02-03 15:00:00

// UTC Dateë¥¼ íƒ€ì„ì¡´ ê¸°ì¤€ ë‚ ì§œ ë¬¸ìì—´ë¡œ ë³€í™˜
const dateStr = formatDateInTimezone(new Date(), "Asia/Seoul"); // "2025-02-04"
```

---

## ğŸ” ì¤‘ë³µ í•¨ìˆ˜ í™•ì¸

### í•¨ìˆ˜ëª… ë¹„êµ

| date.ts | dateUtils.ts | ì¤‘ë³µ ì—¬ë¶€ |
|---------|--------------|----------|
| `parseDateString` | `parseDateInTimezone` | âŒ ì¤‘ë³µ ì•„ë‹˜ (ë°˜í™˜ íƒ€ì… ë‹¤ë¦„) |
| `formatDateFromDate` | `formatDateInTimezone` | âŒ ì¤‘ë³µ ì•„ë‹˜ (íƒ€ì„ì¡´ ê³ ë ¤ ì—¬ë¶€ ë‹¤ë¦„) |
| `getTodayParts` | `getTodayInTimezone` | âŒ ì¤‘ë³µ ì•„ë‹˜ (ë°˜í™˜ íƒ€ì… ë‹¤ë¦„) |

**ê²°ë¡ **: í•¨ìˆ˜ëª…ì´ ìœ ì‚¬í•˜ì§€ë§Œ ì—­í• ê³¼ ë°˜í™˜ íƒ€ì…ì´ ë‹¤ë¥´ë¯€ë¡œ ì¤‘ë³µì´ ì•„ë‹™ë‹ˆë‹¤.

---

## ğŸ“Š ì—­í•  ë¹„êµ

| íŠ¹ì§• | date.ts | dateUtils.ts |
|------|---------|--------------|
| **ëª©ì ** | UI ì»´í¬ë„ŒíŠ¸ìš© ê¸°ë³¸ ë‚ ì§œ ì²˜ë¦¬ | ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ìš© íƒ€ì„ì¡´ ê³ ë ¤ ë‚ ì§œ ì²˜ë¦¬ |
| **íƒ€ì„ì¡´ ê³ ë ¤** | âŒ ê³ ë ¤í•˜ì§€ ì•ŠìŒ | âœ… ëª…ì‹œì ìœ¼ë¡œ ê³ ë ¤ (ê¸°ë³¸ê°’: Asia/Seoul) |
| **ì£¼ìš” ì…ë ¥/ì¶œë ¥** | YYYY-MM-DD ë¬¸ìì—´ | Date ê°ì²´ (UTC) â†” YYYY-MM-DD ë¬¸ìì—´ |
| **ë¼ì´ë¸ŒëŸ¬ë¦¬** | ë„¤ì´í‹°ë¸Œ Date ê°ì²´ë§Œ ì‚¬ìš© | date-fns/tz ì‚¬ìš© |
| **ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤** | ìº˜ë¦°ë” UI, ë‚ ì§œ ì„ íƒê¸°, ë‚ ì§œ í‘œì‹œ | í•™ìŠµ ì§€í‘œ ì¿¼ë¦¬, ë¦¬í¬íŠ¸ ìƒì„±, í†µê³„ ê³„ì‚° |
| **index.ts export** | âœ… exportë¨ | âŒ exportë˜ì§€ ì•ŠìŒ |

---

## âœ… ê²°ë¡ 

### ì¤‘ë³µ í•¨ìˆ˜ ì—†ìŒ

ë‘ íŒŒì¼ì˜ í•¨ìˆ˜ë“¤ì€ ì—­í• ì´ ëª…í™•íˆ ë‹¤ë¥´ë©°, ì¤‘ë³µ í•¨ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤:

1. **`date.ts`**: UI ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ë‚ ì§œ ì²˜ë¦¬
   - íƒ€ì„ì¡´ ê³ ë ¤ ë¶ˆí•„ìš”í•œ ê°„ë‹¨í•œ ì—°ì‚°
   - ë¬¸ìì—´ ì¤‘ì‹¬ì˜ ë‚ ì§œ ì²˜ë¦¬

2. **`dateUtils.ts`**: ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë° í•™ìŠµ ì§€í‘œ ê³„ì‚°ìš©
   - íƒ€ì„ì¡´ì„ ëª…ì‹œì ìœ¼ë¡œ ê³ ë ¤í•´ì•¼ í•˜ëŠ” ê²½ìš°
   - UTC Date ê°ì²´ì™€ íƒ€ì„ì¡´ ê°„ ë³€í™˜ í•„ìš”

### ê¶Œì¥ ì‚¬ìš© ê°€ì´ë“œ

**`date.ts` ì‚¬ìš© ì˜ˆì‹œ**:
- ìº˜ë¦°ë” UIì—ì„œ ë‚ ì§œ í‘œì‹œ
- ë‚ ì§œ ì…ë ¥ í¼ì—ì„œ ë‚ ì§œ í¬ë§·íŒ…
- D-day ê³„ì‚° (UI í‘œì‹œìš©)
- ê°„ë‹¨í•œ ë‚ ì§œ ì°¨ì´ ê³„ì‚°

**`dateUtils.ts` ì‚¬ìš© ì˜ˆì‹œ**:
- Supabase ì¿¼ë¦¬ì—ì„œ ë‚ ì§œ ë²”ìœ„ í•„í„°ë§
- í•™ìŠµ ì§€í‘œ ê³„ì‚° ì‹œ ë‚ ì§œ ë²”ìœ„ ì„¤ì •
- ë¦¬í¬íŠ¸ ìƒì„± ì‹œ ë‚ ì§œ ë²”ìœ„ ì²˜ë¦¬
- íƒ€ì„ì¡´ ë³€í™˜ì´ í•„ìš”í•œ ëª¨ë“  ê²½ìš°

### ê°œì„  ì‚¬í•­

í˜„ì¬ `dateUtils.ts`ì˜ í•¨ìˆ˜ë“¤ì´ `lib/utils/index.ts`ì—ì„œ exportë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. í•„ìš”ì‹œ ëª…ì‹œì ìœ¼ë¡œ importí•´ì•¼ í•©ë‹ˆë‹¤:

```typescript
// í˜„ì¬
import { getStartOfDayUTC } from "@/lib/utils/dateUtils";

// í–¥í›„ ê°œì„  ê°€ëŠ¥ì„±
import { getStartOfDayUTC } from "@/lib/utils"; // index.tsì— ì¶”ê°€ ì‹œ
```

---

## ğŸ“ ì°¸ê³  ìë£Œ

- `lib/utils/date.ts` - ê¸°ë³¸ ë‚ ì§œ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹°
- `lib/utils/dateUtils.ts` - íƒ€ì„ì¡´ ê³ ë ¤ ë‚ ì§œ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹°
- `lib/utils/index.ts` - ê³µí†µ ìœ í‹¸ë¦¬í‹° export ëª©ë¡
- ë¬¸ì„œ: `docs/2025-01-30-date-timezone-fix.md` - íƒ€ì„ì¡´ ë¬¸ì œ í•´ê²° ì´ë ¥
