# 전략과목/취약과목 설정 검증 로직 수정

## 작업 일자
2025-12-04

## 문제 상황

관리자가 콘텐츠별로 전략/취약과목을 설정했는데도 "전략과목/취약과목 정보를 설정해주세요."라는 에러 메시지가 표시되었습니다.

## 원인 분석

**파일**: `lib/validation/wizardValidator.ts`

`validateStep5` 함수에서 `subject_allocations`만 필수로 검증하고 있었습니다:
- `content_allocations`는 검증하지 않음
- 콘텐츠별 설정만 했을 때 에러 발생

## 해결 방법

### wizardValidator.ts의 validateStep5 수정

**파일**: `lib/validation/wizardValidator.ts`

**변경 사항**:
- `subject_allocations` 필수 검증을 `content_allocations` 또는 `subject_allocations` 중 하나라도 있으면 통과하도록 수정
- `subject_allocations`가 있을 때만 과목 일치 검증 수행 (기존 로직 유지)

**변경 전**:
```typescript
// subject_allocations 필수 검증
if (
  !wizardData.subject_allocations ||
  wizardData.subject_allocations.length === 0
) {
  errors.push("전략과목/취약과목 정보를 설정해주세요.");
} else {
  // 과목 일치 검증
}
```

**변경 후**:
```typescript
// content_allocations 또는 subject_allocations 중 하나라도 있어야 함
const hasContentAllocations =
  wizardData.content_allocations &&
  wizardData.content_allocations.length > 0;
const hasSubjectAllocations =
  wizardData.subject_allocations &&
  wizardData.subject_allocations.length > 0;

if (!hasContentAllocations && !hasSubjectAllocations) {
  errors.push("전략과목/취약과목 정보를 설정해주세요.");
} else if (hasSubjectAllocations) {
  // subject_allocations가 있을 때만 과목 일치 검증 수행
  // 과목 일치 검증 로직
}
```

## 수정된 파일 목록

1. `lib/validation/wizardValidator.ts`
   - validateStep5 함수의 subject_allocations 필수 검증 로직 수정
   - content_allocations도 허용하도록 변경

## 테스트 시나리오

1. **콘텐츠별 설정만 했을 때** (content_allocations만 있음)
   - 에러 없이 통과해야 함

2. **교과별 설정만 했을 때** (subject_allocations만 있음)
   - 기존과 동일하게 동작해야 함
   - 과목 일치 검증도 수행됨

3. **둘 다 설정했을 때**
   - 에러 없이 통과해야 함
   - subject_allocations가 있으면 과목 일치 검증 수행

4. **둘 다 없을 때**
   - "전략과목/취약과목 정보를 설정해주세요." 에러 표시

## 예상 효과

- ✅ 콘텐츠별 설정만 해도 검증 통과
- ✅ 교과별 설정만 해도 기존과 동일하게 동작
- ✅ 둘 다 설정해도 정상 동작
- ✅ 하위 호환성 유지

