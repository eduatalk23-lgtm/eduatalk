# ì„±ì  ëŒ€ì‹œë³´ë“œ ìŠ¤í‚¤ë§ˆ ë§ˆì´ê·¸ë ˆì´ì…˜

## ğŸ“‹ ì‘ì—… ê°œìš”

ì„±ì  ëŒ€ì‹œë³´ë“œ ê´€ë ¨ ì½”ë“œë¥¼ í˜„ì¬ DB ìŠ¤í‚¤ë§ˆ ê¸°ì¤€ìœ¼ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

- ë‚´ì‹  í…Œì´ë¸”: `student_internal_scores` ì‚¬ìš©
- ëª¨ì˜ê³ ì‚¬ í…Œì´ë¸”: `student_mock_scores` ì‚¬ìš©
- í•™ê¸° ê´€ë¦¬: `student_terms` í…Œì´ë¸” ê¸°ë°˜ `termId` ì‚¬ìš©

## ğŸ”„ ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. ë‚´ì‹  ë¶„ì„ ë¡œì§ (`lib/scores/internalAnalysis.ts`)

**ë³€ê²½ ì „:**
- `student_school_scores` í…Œì´ë¸” ì‚¬ìš©
- `studentTermId`ë¥¼ `grade:semester` í˜•ì‹ìœ¼ë¡œ ì²˜ë¦¬
- `subject_group` ì»¬ëŸ¼ ì§ì ‘ ì‚¬ìš©

**ë³€ê²½ í›„:**
- `student_internal_scores` í…Œì´ë¸” ì‚¬ìš©
- `studentTermId`ëŠ” UUID í˜•ì‹ì˜ `student_term_id` ì‚¬ìš©
- `subject_group_id`ë¥¼ í†µí•´ `subject_groups` ì¡°ì¸í•˜ì—¬ êµê³¼êµ°ëª… ì¡°íšŒ
- ì»¬ëŸ¼ëª… ë³€ê²½: `subject_average` â†’ `avg_score`, `standard_deviation` â†’ `std_dev`

### 2. ëª¨ì˜ê³ ì‚¬ ë¶„ì„ ë¡œì§ (`lib/scores/mockAnalysis.ts`)

**ë³€ê²½ ì „:**
- `exam_type` ì»¬ëŸ¼ ì‚¬ìš©
- `created_at` ê¸°ì¤€ìœ¼ë¡œ ìµœê·¼ ì‹œí—˜ ì¡°íšŒ

**ë³€ê²½ í›„:**
- `exam_date`, `exam_title` ì»¬ëŸ¼ ì‚¬ìš©
- `exam_date` ê¸°ì¤€ìœ¼ë¡œ ìµœê·¼ ì‹œí—˜ ì¡°íšŒ
- `exam_type` ì°¸ì¡° ì œê±°

### 3. API ë¼ìš°íŠ¸ (`app/api/students/[id]/score-dashboard/route.ts`)

**ë³€ê²½ ì „:**
- `grade`, `semester`ë§Œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ìŒ
- `studentTermId`ë¥¼ `grade:semester` í˜•ì‹ìœ¼ë¡œ ìƒì„±
- `student_school_scores` í…Œì´ë¸” ì°¸ì¡°

**ë³€ê²½ í›„:**
- `termId` íŒŒë¼ë¯¸í„° ì§€ì› ì¶”ê°€
- `termId` ìš°ì„ , ì—†ìœ¼ë©´ `grade`+`semester`ë¡œ `student_terms`ì—ì„œ ì¡°íšŒ
- `student_terms`ì—ì„œ ì‹¤ì œ UUID í˜•ì‹ì˜ `termId` ì¡°íšŒ
- `student_school_scores` ì°¸ì¡° ì œê±°

**íŒŒë¼ë¯¸í„° ì²˜ë¦¬ ìš°ì„ ìˆœìœ„:**
1. `termId` íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
2. `termId`ê°€ ì—†ê³  `grade`, `semester`ê°€ ìˆìœ¼ë©´ `student_terms`ì—ì„œ ì¡°íšŒ
3. ë‘˜ ë‹¤ ì—†ìœ¼ë©´ ìµœê·¼ í•™ê¸° ì¡°íšŒ

### 4. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ (`scripts/testScoreDashboard.ts`)

**ë³€ê²½ ì „:**
- `grade`, `semester`ë§Œ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì— ì „ë‹¬

**ë³€ê²½ í›„:**
- `termId`ë¥¼ ë‚´ë¶€ì—ì„œ ê³„ì‚°í•˜ì—¬ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì— ì „ë‹¬
- `grade`, `semester`ê°€ ìˆìœ¼ë©´ `student_terms`ì—ì„œ `termId` ì¡°íšŒ
- ì—†ìœ¼ë©´ ìµœê·¼ í•™ê¸° ì¡°íšŒ

## ğŸ“Š ë°ì´í„° íë¦„

### ë‚´ì‹  ë¶„ì„
```
API ìš”ì²­ (termId ë˜ëŠ” grade+semester)
  â†“
student_terms ì¡°íšŒ (termId ê²°ì •)
  â†“
student_internal_scores ì¡°íšŒ (student_term_id í•„í„°)
  â†“
subject_groups ì¡°ì¸ (êµê³¼êµ°ëª… ë§¤í•‘)
  â†“
GPA, Z-Index, êµê³¼êµ°ë³„ GPA ê³„ì‚°
```

### ëª¨ì˜ê³ ì‚¬ ë¶„ì„
```
API ìš”ì²­ (tenantId, studentId)
  â†“
student_mock_scores ì¡°íšŒ (exam_date DESC)
  â†“
subjects ì¡°ì¸ (subject_group_id ì¶”ì¶œ)
  â†“
subject_groups ì¡°ì¸ (êµê³¼êµ°ëª… ë§¤í•‘)
  â†“
í†µê³„ ê³„ì‚° (í‰ê·  ë°±ë¶„ìœ„, í‘œì¤€ì ìˆ˜ í•©, ìƒìœ„ 3ê°œ ë“±ê¸‰ í•©)
```

## âœ… ê²€ì¦ ë°©ë²•

### 1. ë”ë¯¸ ë°ì´í„° ìƒì„±
```bash
npx tsx scripts/seedScoreDashboardDummy.ts
```

### 2. í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
```bash
# í•™ìƒ A (ì •ì‹œìš°ìœ„)
npx tsx scripts/testScoreDashboard.ts fe7d04b5-3663-421c-8014-bc6a1018a652 84b71a5d-5681-4da3-88d2-91e75ef89015 2 1

# í•™ìƒ B (ìˆ˜ì‹œìš°ìœ„)
npx tsx scripts/testScoreDashboard.ts 83d4bb2f-51c3-42ee-b980-216fb180910a 84b71a5d-5681-4da3-88d2-91e75ef89015 2 1

# í•™ìƒ C (ê· í˜•í˜•)
npx tsx scripts/testScoreDashboard.ts 1a5d69c0-65ce-4048-acac-b80898ded458 84b71a5d-5681-4da3-88d2-91e75ef89015 2 1
```

### 3. ê¸°ëŒ€ ê²°ê³¼

**ë‚´ì‹  ë¶„ì„:**
- ì „ì²´ GPA: ìˆ«ì (N/A ì•„ë‹˜)
- Z-Index: ìˆ«ì (N/A ì•„ë‹˜)
- êµê³¼êµ°ë³„ GPA: êµ­ì–´, ìˆ˜í•™, ì˜ì–´, ì‚¬íšŒ, ê³¼í•™ ê°ê° ìˆ«ì

**ëª¨ì˜ê³ ì‚¬ ë¶„ì„:**
- ìµœê·¼ ì‹œí—˜: 2025í•™ë…„ë„ 3ì›” ëª¨ì˜ê³ ì‚¬ (2025-03-15)
- í‰ê·  ë°±ë¶„ìœ„: ìˆ«ì
- í‘œì¤€ì ìˆ˜ í•©: ìˆ«ì
- ìƒìœ„ 3ê°œ ë“±ê¸‰ í•©: ìˆ«ì

**ì „ëµ ë¶„ì„:**
- ë‚´ì‹ /ëª¨ì˜ê³ ì‚¬ í™˜ì‚° ë°±ë¶„ìœ„ ê¸°ë°˜ìœ¼ë¡œ BALANCED/ì •ì‹œìš°ìœ„/ìˆ˜ì‹œìš°ìœ„ ë¶„ë¥˜

## ğŸ” ë””ë²„ê¹… ë¡œê·¸

API ë¼ìš°íŠ¸ì—ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ ë¡œê·¸ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤:
- ì…ë ¥ íŒŒë¼ë¯¸í„° (tenantId, termId, grade, semester)
- ì¡°íšŒëœ student_terms ì •ë³´
- ë‚´ì‹  ë°ì´í„° ê°œìˆ˜
- ëª¨ì˜ê³ ì‚¬ ë°ì´í„° ê°œìˆ˜
- ëª¨ì˜ê³ ì‚¬ ë¶„ì„ ê²°ê³¼

## ğŸ“ ì°¸ê³ ì‚¬í•­

- `student_internal_scores` í…Œì´ë¸”ì€ `student_term_id` (FK)ë¥¼ í†µí•´ í•™ê¸°ë³„ë¡œ í•„í„°ë§
- `student_mock_scores` í…Œì´ë¸”ì€ `exam_date` ê¸°ì¤€ìœ¼ë¡œ ìµœê·¼ ì‹œí—˜ ì¡°íšŒ
- ë‚´ì‹ ê³¼ ëª¨ì˜ê³ ì‚¬ëŠ” ë…ë¦½ì ìœ¼ë¡œ ë¶„ì„ë˜ë©°, í•œìª½ ë°ì´í„°ê°€ ì—†ì–´ë„ ë‹¤ë¥¸ ìª½ì€ ì •ìƒ ë¶„ì„
- `termId`ë¥¼ ì°¾ì§€ ëª»í•˜ë”ë¼ë„ ëª¨ì˜ê³ ì‚¬ ë¶„ì„ì€ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë¨

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. ì‹¤ì œ ë°ì´í„°ë¡œ ê²€ì¦
2. ì„±ëŠ¥ ìµœì í™” (í•„ìš”ì‹œ)
3. ì—ëŸ¬ ì²˜ë¦¬ ê°•í™” (í•„ìš”ì‹œ)

