# 캘린더 제외일 타입별 차별화 처리

## 📋 요구사항

"휴일지정"과 "기타" 제외일을 다르게 처리해야 함:
- **"휴일지정" (지정휴일)**: 자율학습 배치를 할 수 있으므로 자율학습은 표시해야 함
- **"기타"**: 모든 학습 관련 슬롯 필터링

## 🔧 수정 내용

### 1. 제외일 타입별 필터링 로직 (`app/(student)/plan/calendar/_utils/timelineUtils.ts`)

**변경 전:**
- 모든 제외일 타입에 대해 동일하게 처리
- 제외일인 경우 학습 관련 타임슬롯 모두 필터링

**변경 후:**
- 제외일 타입에 따라 다르게 처리:
  - **"휴일지정"**: 자율학습만 허용, 나머지 학습 관련 슬롯 필터링
  - **"기타"**: 모든 학습 관련 슬롯 필터링 (자율학습 포함)
  - **"휴가", "개인사정"**: 모든 학습 관련 슬롯 필터링 (기존과 동일)

```typescript
// 제외일 타입 확인
const exclusionType = dayExclusions.length > 0 ? dayExclusions[0].exclusion_type : null;
const isHolidayDesignated = exclusionType === "휴일지정"; // 자율학습 허용
const isOtherExclusion = exclusionType === "기타"; // 모든 학습 관련 슬롯 필터링

// 타임슬롯 필터링
if (isExclusionDay) {
  // "기타" 제외일: 모든 학습 관련 슬롯 필터링 (자율학습 포함)
  if (isOtherExclusion && slot.type !== "학원일정") {
    return;
  }
  // "휴일지정" 제외일: 자율학습은 허용, 나머지 학습 관련 슬롯은 필터링
  if (isHolidayDesignated && slot.type !== "학원일정" && slot.type !== "자율학습") {
    return;
  }
  // "휴가", "개인사정" 등 기타 제외일: 모든 학습 관련 슬롯 필터링
  if (!isHolidayDesignated && !isOtherExclusion && slot.type !== "학원일정" && slot.type !== "학습시간") {
    return;
  }
}
```

### 2. 제외일 타입 매핑 (`lib/date/calendarDayTypes.ts`)

**변경 전:**
- "휴일지정"과 "기타"를 모두 "지정휴일"로 매핑

**변경 후:**
- "휴일지정"과 "기타"는 모두 "지정휴일"로 표시하되, 내부적으로 `exclusion_type`을 유지하여 타임슬롯 필터링 시 구분

```typescript
// "휴일지정"과 "기타"는 모두 "지정휴일"로 표시
// 하지만 타임슬롯 필터링 시 exclusion_type을 확인하여 다르게 처리
if (exclusion.exclusion_type === "휴일지정" || exclusion.exclusion_type === "기타") {
  exclusionDayType = "지정휴일";
}
```

## ✅ 결과

### 제외일 타입별 표시 규칙

| 제외일 타입 | 자율학습 | 학습시간 | 점심시간 | 이동시간 | 학원일정 |
|------------|---------|---------|---------|---------|---------|
| **휴일지정** | ✅ 표시 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 |
| **기타** | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 |
| **휴가** | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 |
| **개인사정** | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 | ❌ 필터링 |

### 주요 변경사항

1. **"휴일지정" 제외일**
   - 자율학습 슬롯은 표시됨
   - 학습시간, 점심시간, 이동시간 등은 필터링됨
   - 학원일정은 필터링됨

2. **"기타" 제외일**
   - 모든 학습 관련 슬롯 필터링 (자율학습 포함)
   - 학원일정도 필터링됨

3. **기타 제외일 타입 ("휴가", "개인사정")**
   - 기존과 동일하게 모든 학습 관련 슬롯 필터링

## 📝 관련 파일

- `app/(student)/plan/calendar/_utils/timelineUtils.ts`: 제외일 타입별 타임슬롯 필터링 로직
- `lib/date/calendarDayTypes.ts`: 제외일 타입 매핑 (표시용)

## 🔍 테스트 시나리오

1. **"휴일지정" 제외일 확인**
   - 자율학습 슬롯이 표시되는지 확인
   - 학습시간, 점심시간, 이동시간이 필터링되는지 확인
   - 학원일정이 필터링되는지 확인

2. **"기타" 제외일 확인**
   - 모든 학습 관련 슬롯(자율학습 포함)이 필터링되는지 확인
   - 학원일정이 필터링되는지 확인

3. **다른 제외일 타입 확인**
   - "휴가", "개인사정" 제외일에서 모든 학습 관련 슬롯이 필터링되는지 확인

