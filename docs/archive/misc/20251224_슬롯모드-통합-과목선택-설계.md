# ìŠ¬ë¡¯ ëª¨ë“œ í†µí•© ë° ê³¼ëª© ì„ íƒ í™•ì¥ ì„¤ê³„ v2

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-12-24
- **ë²„ì „**: v2.1 (ê¸°ì¡´ ì‹œìŠ¤í…œ ë¶„ì„ ë°˜ì˜)
- **ìƒíƒœ**: ì„¤ê³„ ë‹¨ê³„
- **ê´€ë ¨ ë¬¸ì„œ**: `20251223_160953-2ë‹¨ê³„-ì½˜í…ì¸ -ì„ íƒ-ì‹œìŠ¤í…œ-ì„¤ê³„.md`

---

## ëª©ì°¨

1. [ê¸°ì¡´ ì „ëµ/ì·¨ì•½ ê³¼ëª© ì‹œìŠ¤í…œ ë¶„ì„](#1-ê¸°ì¡´-ì „ëµì·¨ì•½-ê³¼ëª©-ì‹œìŠ¤í…œ-ë¶„ì„)
2. [ìŠ¬ë¡¯ ê¸°ë°˜ í†µí•© ì„¤ê³„](#2-ìŠ¬ë¡¯-ê¸°ë°˜-ì „ëµì·¨ì•½-ê³¼ëª©-í†µí•©)
3. [ê°€ìƒ ìŠ¤ì¼€ì¤„ ìƒì„± í”Œë¡œìš°](#3-ê°€ìƒ-ìŠ¤ì¼€ì¤„-ìƒì„±--ì‹¤ì œ-ì½˜í…ì¸ -ì—°ê²°-í”Œë¡œìš°)
4. [ìŠ¬ë¡¯ íƒ€ì… í™•ì¥](#4-ìŠ¬ë¡¯-íƒ€ì…-í™•ì¥)
5. [ë°ì´í„° íë¦„](#5-ë°ì´í„°-íë¦„-ì •ë¦¬)
6. [ì¶”ê°€ ê³ ë ¤ ì‚¬í•­](#6-ì¶”ê°€-ê³ ë ¤-ì‚¬í•­)
7. [ëª¨ë“œ í†µí•© ì‹œ ì½˜í…ì¸  ì—°ê²° ê¸°ëŠ¥](#7-ëª¨ë“œ-í†µí•©-ì‹œ-ì½˜í…ì¸ -ì—°ê²°-ê¸°ëŠ¥-í†µí•©)
8. [ê´€ë ¨ íŒŒì¼](#8-ê´€ë ¨-íŒŒì¼)

---

## 1. ê¸°ì¡´ ì „ëµ/ì·¨ì•½ ê³¼ëª© ì‹œìŠ¤í…œ ë¶„ì„

### 1.1 í˜„ì¬ íƒ€ì… ì •ì˜

```typescript
// lib/types/plan/domain.ts
type SubjectAllocation = {
  subject_id: string;
  subject_name: string;
  subject_type: "strategy" | "weakness";
  weekly_days?: number; // ì „ëµê³¼ëª©ì¸ ê²½ìš°: 2, 3, 4
};

// lib/utils/subjectAllocation.ts
type ContentAllocation = {
  content_type: "book" | "lecture" | "custom";
  content_id: string;
  subject_type: "strategy" | "weakness";
  weekly_days?: number;
};
```

### 1.2 ë°°ì • ë¡œì§ (ì¼ìˆ˜ ê¸°ë°˜)

ê¸°ì¡´ ì‹œìŠ¤í…œì€ **ë¹„ìœ¨ ê¸°ë°˜ì´ ì•„ë‹Œ ì¼ìˆ˜ ê¸°ë°˜**ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

| ê³¼ëª© ìœ í˜• | ë°°ì • ë°©ì‹ | weekly_days |
|-----------|-----------|-------------|
| **ì·¨ì•½ê³¼ëª©** (weakness) | ì „ì²´ í•™ìŠµì¼ì— ë°°ì • | ì‚¬ìš© ì•ˆ í•¨ |
| **ì „ëµê³¼ëª©** (strategy) | ì£¼ë‹¹ 2/3/4ì¼ë§Œ ë°°ì • | 2, 3, 4 ì¤‘ ì„ íƒ |

```typescript
// lib/plan/1730TimetableLogic.ts
export function calculateSubjectAllocationDates(
  cycleDays: CycleDayInfo[],
  allocation: SubjectAllocation
): string[] {
  const studyDates = cycleDays
    .filter((d) => d.day_type === "study")
    .map((d) => d.date);

  if (allocation.subject_type === "weakness") {
    // ì·¨ì•½ê³¼ëª©: ëª¨ë“  í•™ìŠµì¼ì— ë°°ì •
    return studyDates;
  }

  // ì „ëµê³¼ëª©: weekly_daysì— ë”°ë¼ ê· ë“± ë°°ì •
  const daysPerWeek = allocation.weekly_days || 3;
  // ... ê· ë“± ë°°ì • ë¡œì§
}
```

### 1.3 ìš°ì„ ìˆœìœ„ ì¡°íšŒ

```typescript
// lib/utils/subjectAllocation.ts
function getEffectiveAllocation(
  content: ContentInfo,
  contentAllocations?: ContentAllocation[],
  subjectAllocations?: SubjectAllocation[]
): AllocationResult {
  // ìš°ì„ ìˆœìœ„:
  // 1. content_allocations (ì½˜í…ì¸ ë³„ ì„¤ì •)
  // 2. subject_allocations (êµê³¼ë³„ ì„¤ì •)
  // 3. ê¸°ë³¸ê°’: weakness (ì·¨ì•½ê³¼ëª©)
}
```

### 1.4 í˜„ì¬ UI ìœ„ì¹˜

- **Step 6 (í•™ìŠµë²”ìœ„ ì ê²€)**: `SubjectAllocationUI.tsx`
- ì½˜í…ì¸ ì˜ `subject_category`ì—ì„œ ê³¼ëª© ëª©ë¡ ì¶”ì¶œ
- ê³¼ëª©ë³„ë¡œ ì „ëµ/ì·¨ì•½ ì„ íƒ + ì „ëµ ì„ íƒ ì‹œ weekly_days ì„¤ì •

---

## 2. ìŠ¬ë¡¯ ê¸°ë°˜ ì „ëµ/ì·¨ì•½ ê³¼ëª© í†µí•©

### 2.1 í•µì‹¬ ë°©í–¥ ë³€ê²½

| í•­ëª© | ê¸°ì¡´ (Step 6) | ê°œì„  (Step 4 ìŠ¬ë¡¯) |
|------|---------------|-------------------|
| ì„¤ì • ìœ„ì¹˜ | ì½˜í…ì¸  ì„ íƒ í›„ ë³„ë„ UI | **ìŠ¬ë¡¯ êµ¬ì„± ì‹œ í†µí•©** |
| ì„¤ì • ë‹¨ìœ„ | subject_category ê¸°ì¤€ | **ìŠ¬ë¡¯ ë‹¨ìœ„** |
| ì½˜í…ì¸  ì—°ê²° | í•„ìˆ˜ (ì½˜í…ì¸ ì—ì„œ ê³¼ëª© ì¶”ì¶œ) | **ì„ íƒì ** (ìŠ¬ë¡¯ ìì²´ì— ê³¼ëª© ì§€ì •) |
| ìŠ¤ì¼€ì¤„ ìƒì„± | ì½˜í…ì¸  ë²”ìœ„ í•„ìˆ˜ | **ê°€ìƒ ìŠ¬ë¡¯ìœ¼ë¡œë„ ê°€ëŠ¥** |

### 2.2 ìŠ¬ë¡¯ íƒ€ì… í™•ì¥ (ê¸°ì¡´ ì‹œìŠ¤í…œ í˜¸í™˜)

```typescript
// lib/types/content-selection.ts
type ContentSlot = SlotTemplate & {
  // ê¸°ì¡´ í•„ë“œ
  slot_index: number;
  slot_type: SlotType | null;
  subject_category: string;
  subject_id?: string | null;

  // ğŸ†• ì „ëµ/ì·¨ì•½ ì„¤ì • í•„ë“œ (ê¸°ì¡´ íƒ€ì… ì¬ì‚¬ìš©)
  subject_type?: "strategy" | "weakness";  // ê¸°ë³¸ê°’: "weakness"
  weekly_days?: number;                     // ì „ëµê³¼ëª©ì¼ ë•Œ: 2, 3, 4

  // ì½˜í…ì¸  ì—°ê²° í•„ë“œ (ì„ íƒ)
  content_id?: string | null;
  start_range?: number;
  end_range?: number;
  // ...
};
```

### 2.3 ë°°ì • ë¡œì§ í†µí•©

```typescript
/**
 * ìŠ¬ë¡¯ ê¸°ë°˜ ë°°ì • ì •ë³´ ìƒì„±
 *
 * ê¸°ì¡´ subject_allocations ëŒ€ì‹  content_slotsì—ì„œ ì§ì ‘ ìƒì„±
 */
function buildAllocationFromSlots(
  slots: ContentSlot[]
): SubjectAllocation[] {
  // subject_categoryë³„ë¡œ ê·¸ë£¹í™”
  const subjectMap = new Map<string, ContentSlot[]>();

  slots.forEach(slot => {
    if (!slot.subject_category) return;
    const existing = subjectMap.get(slot.subject_category) || [];
    existing.push(slot);
    subjectMap.set(slot.subject_category, existing);
  });

  // êµê³¼ë³„ subject_type ê²°ì • (ìŠ¬ë¡¯ ì¤‘ í•˜ë‚˜ë¼ë„ strategyë©´ strategy)
  return Array.from(subjectMap.entries()).map(([category, categorySlots]) => {
    const hasStrategy = categorySlots.some(s => s.subject_type === "strategy");
    const strategySlot = categorySlots.find(s => s.subject_type === "strategy");

    return {
      subject_id: category,
      subject_name: category,
      subject_type: hasStrategy ? "strategy" : "weakness",
      weekly_days: strategySlot?.weekly_days ?? 3,
    };
  });
}
```

### 2.4 UI í†µí•©

**í˜„ì¬**: Step 6ì—ì„œ ê³¼ëª©ë³„ ì „ëµ/ì·¨ì•½ ì„¤ì • (ì½˜í…ì¸  ì„ íƒ í›„)

**ê°œì„ **: Step 4 ìŠ¬ë¡¯ êµ¬ì„±ì—ì„œ í†µí•©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìŠ¬ë¡¯ 1                                                    [ì‚­ì œ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚ğŸ“š êµì¬ â–¼â”‚ â”‚ ìˆ˜í•™  â–¼ â”‚ â”‚ ìˆ˜í•™â…¡ â–¼â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ë°°ì • ë°©ì‹                                                    â”‚   â”‚
â”‚  â”‚ â—‹ ì·¨ì•½ê³¼ëª© - ì „ì²´ í•™ìŠµì¼ì— ë°°ì •                              â”‚   â”‚
â”‚  â”‚ â— ì „ëµê³¼ëª© - ì£¼ë‹¹ [3 â–¼]ì¼ë§Œ ë°°ì •                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ğŸ“– ì½˜í…ì¸ : ë¯¸ì—°ê²° [ì—°ê²°í•˜ê¸°]                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì „ëµê³¼ëª© ì„ íƒ ì‹œ weekly_days ë“œë¡­ë‹¤ìš´:
- ì£¼ 2ì¼
- ì£¼ 3ì¼ (ê¸°ë³¸)
- ì£¼ 4ì¼
```

## 3. ê°€ìƒ ìŠ¤ì¼€ì¤„ ìƒì„± â†’ ì‹¤ì œ ì½˜í…ì¸  ì—°ê²° í”Œë¡œìš°

### 3.1 í•µì‹¬ ì•„ì´ë””ì–´

```
ì½˜í…ì¸  ì—†ì´ë„ ìŠ¤ì¼€ì¤„ ìƒì„± ê°€ëŠ¥
â†’ ìŠ¬ë¡¯ì˜ êµê³¼/ì „ëµÂ·ì·¨ì•½ ì„¤ì •ìœ¼ë¡œ ì¼ìˆ˜ ê¸°ë°˜ ë°°ì •
â†’ ì´í›„ ì‹¤ì œ ì½˜í…ì¸  ì—°ê²° ì‹œ ë²”ìœ„ ê¸°ë°˜ ì¬ì¡°ì •
```

### 3.2 ì‚¬ìš©ì í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        í”Œëœ ìƒì„± ìœ„ìë“œ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Step 1: ê¸°ë³¸ ì •ë³´                                                   â”‚
â”‚  â””â”€ í”Œëœ ì´ë¦„, ê¸°ê°„, ëª©ì                                             â”‚
â”‚          â”‚                                                          â”‚
â”‚          â–¼                                                          â”‚
â”‚  Step 2: ì‹œê°„ ì„¤ì •                                                   â”‚
â”‚  â””â”€ í•™ì› ì¼ì •, ì œì™¸ì¼, í•™ìŠµ ì‹œê°„ (daily_schedule)                    â”‚
â”‚          â”‚                                                          â”‚
â”‚          â–¼                                                          â”‚
â”‚  Step 3: ìŠ¤ì¼€ì¤„ ë¯¸ë¦¬ë³´ê¸°                                             â”‚
â”‚  â””â”€ ì¼ë³„ í•™ìŠµ ê°€ëŠ¥ ì‹œê°„ í™•ì¸                                         â”‚
â”‚          â”‚                                                          â”‚
â”‚          â–¼                                                          â”‚
â”‚  Step 4: ìŠ¬ë¡¯ ì„¤ê³„                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ìŠ¬ë¡¯ êµ¬ì„± (í•„ìˆ˜)                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ íƒ€ì…: êµì¬/ê°•ì˜                                           â”‚  â”‚
â”‚  â”‚  â”œâ”€ êµê³¼/ê³¼ëª© ì„ íƒ                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ ë°°ì • ë°©ì‹: ì·¨ì•½ê³¼ëª©(ì „ì²´ì¼) / ì „ëµê³¼ëª©(ì£¼Nì¼)               â”‚  â”‚
â”‚  â”‚  â””â”€ (ì„ íƒ) ì½˜í…ì¸  ì—°ê²°                                         â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  â¬‡ï¸ ì‹¤ì‹œê°„ ê³„ì‚°                                               â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  ê°€ìƒ íƒ€ì„ë¼ì¸ ë¯¸ë¦¬ë³´ê¸°                                        â”‚  â”‚
â”‚  â”‚  â””â”€ êµê³¼ë³„ ì¼ìˆ˜ ë°°ì •, ì¼ë³„ ë°°ì¹˜ ì‹œë®¬ë ˆì´ì…˜                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                                                          â”‚
â”‚          â–¼                                                          â”‚
â”‚  Step 5: ìŠ¤ì¼€ì¤„ ìƒì„±                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  [ì½˜í…ì¸  ì „ì²´ ì—°ê²°ë¨]         [ì¼ë¶€/ì „ì²´ ë¯¸ì—°ê²°]                â”‚  â”‚
â”‚  â”‚         â”‚                           â”‚                         â”‚  â”‚
â”‚  â”‚         â–¼                           â–¼                         â”‚  â”‚
â”‚  â”‚  ì‹¤ì œ ë²”ìœ„ ê¸°ë°˜              ê°€ìƒ ë²”ìœ„ ê¸°ë°˜                    â”‚  â”‚
â”‚  â”‚  ìŠ¤ì¼€ì¤„ ìƒì„±                 ìŠ¤ì¼€ì¤„ ìƒì„±                       â”‚  â”‚
â”‚  â”‚         â”‚                           â”‚                         â”‚  â”‚
â”‚  â”‚         â–¼                           â–¼                         â”‚  â”‚
â”‚  â”‚  plan_items ìƒì„±             virtual_plan_items ìƒì„±          â”‚  â”‚
â”‚  â”‚  (í•™ìŠµ ì‹œì‘ ê°€ëŠ¥)            (ë²”ìœ„: "ê°€ìƒ ë°°ë¶„")               â”‚  â”‚
â”‚  â”‚                                     â”‚                         â”‚  â”‚
â”‚  â”‚                                     â–¼                         â”‚  â”‚
â”‚  â”‚                              ì´í›„ ì½˜í…ì¸  ì—°ê²° ì‹œ                â”‚  â”‚
â”‚  â”‚                              â†’ ë²”ìœ„ ì¬ê³„ì‚°                     â”‚  â”‚
â”‚  â”‚                              â†’ plan_items ê°±ì‹                  â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                                                          â”‚
â”‚          â–¼                                                          â”‚
â”‚  Step 6: ì™„ë£Œ                                                        â”‚
â”‚  â””â”€ í”Œëœ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™                                          â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Plan Items êµ¬ì¡° ë³€ê²½

```typescript
// í˜„ì¬: content_id í•„ìˆ˜
type PlanItem = {
  content_type: ContentType;
  content_id: string;           // í•„ìˆ˜
  target_start_page_or_time: number;
  target_end_page_or_time: number;
  // ...
};

// ê°œì„ : ê°€ìƒ ìŠ¬ë¡¯ ê¸°ë°˜ í—ˆìš©
type PlanItem = {
  // ìŠ¬ë¡¯ ì°¸ì¡° (ì‹ ê·œ)
  slot_index?: number;          // ì—°ê²°ëœ ìŠ¬ë¡¯ ì¸ë±ìŠ¤
  is_virtual?: boolean;         // ê°€ìƒ í”Œëœ ì—¬ë¶€

  // ì½˜í…ì¸  (ì„ íƒ)
  content_type: ContentType;
  content_id?: string | null;   // null í—ˆìš© (ê°€ìƒ í”Œëœ)

  // ë²”ìœ„
  target_start_page_or_time: number;
  target_end_page_or_time: number;

  // ê°€ìƒ í”Œëœìš© ë©”íƒ€ë°ì´í„°
  virtual_subject_category?: string;  // "ìˆ˜í•™"
  virtual_subject_id?: string;        // "ìˆ˜í•™â…¡"
  virtual_description?: string;       // "ìˆ˜í•™ êµì¬ í•™ìŠµ"
  // ...
};
```

### 3.4 ì‹œë‚˜ë¦¬ì˜¤ë³„ í”Œë¡œìš°

#### ì‹œë‚˜ë¦¬ì˜¤ A: ì½˜í…ì¸  ì™„ì „ ì—°ê²° í›„ ìŠ¤ì¼€ì¤„ ìƒì„±

```
1. ìŠ¬ë¡¯ 3ê°œ êµ¬ì„±
   - ìˆ˜í•™ êµì¬ (ì „ëµ)
   - ì˜ì–´ ê°•ì˜ (ì·¨ì•½)
   - êµ­ì–´ êµì¬ (ì¼ë°˜)

2. ê° ìŠ¬ë¡¯ì— ì½˜í…ì¸  + ë²”ìœ„ ì—°ê²°
   - ìˆ˜í•™: ê°œë…ì›ë¦¬ p.1-200
   - ì˜ì–´: EBS 1-30ê°•
   - êµ­ì–´: ê³ ì „ë¬¸í•™ p.1-150

3. ìŠ¤ì¼€ì¤„ ìƒì„±
   â†’ ì‹¤ì œ ë²”ìœ„ ê¸°ë°˜ plan_items ìƒì„±
   â†’ ì¦‰ì‹œ í•™ìŠµ ì‹œì‘ ê°€ëŠ¥
```

#### ì‹œë‚˜ë¦¬ì˜¤ B: ì½˜í…ì¸  ì—†ì´ ìŠ¤ì¼€ì¤„ ìƒì„± (ë¡œë“œë§µ)

```
1. ìŠ¬ë¡¯ 3ê°œ êµ¬ì„± (ì½˜í…ì¸  ë¯¸ì—°ê²°)
   - ìˆ˜í•™ êµì¬ (ì „ëµ, ì£¼3ì¼) â†’ í•™ìŠµì¼ ì¤‘ ì£¼3ì¼ë§Œ ë°°ì •
   - ì˜ì–´ ê°•ì˜ (ì·¨ì•½)        â†’ ì „ì²´ í•™ìŠµì¼ ë°°ì •
   - êµ­ì–´ êµì¬ (ì·¨ì•½)        â†’ ì „ì²´ í•™ìŠµì¼ ë°°ì •

2. ìŠ¤ì¼€ì¤„ ìƒì„± (ê°€ìƒ)
   â†’ virtual_plan_items ìƒì„±
   â†’ ì¼ìˆ˜ ê¸°ë°˜ ë°°ì • (ì „ëµê³¼ëª©ì€ íŠ¹ì • ìš”ì¼ë§Œ)

3. ìº˜ë¦°ë”ì—ì„œ í™•ì¸ (ì˜ˆ: í•™ìŠµì¼ 6ì¼ ì£¼ê¸°)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 12/26 (ëª©) - í•™ìŠµì¼ 1                          â”‚
   â”‚ â”œâ”€ ğŸ“š ìˆ˜í•™ (ì „ëµ, ì½˜í…ì¸  ë¯¸ì •)                 â”‚ â† ì£¼3ì¼ ë°°ì •
   â”‚ â”œâ”€ ğŸ¬ ì˜ì–´ (ì·¨ì•½, ì½˜í…ì¸  ë¯¸ì •)                 â”‚
   â”‚ â””â”€ ğŸ“š êµ­ì–´ (ì·¨ì•½, ì½˜í…ì¸  ë¯¸ì •)                 â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ 12/27 (ê¸ˆ) - í•™ìŠµì¼ 2                          â”‚
   â”‚ â”œâ”€ ğŸ¬ ì˜ì–´ (ì·¨ì•½, ì½˜í…ì¸  ë¯¸ì •)                 â”‚ â† ìˆ˜í•™ ì—†ìŒ
   â”‚ â””â”€ ğŸ“š êµ­ì–´ (ì·¨ì•½, ì½˜í…ì¸  ë¯¸ì •)                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. ì´í›„ ì½˜í…ì¸  ì—°ê²°
   - í”Œëœ ìƒì„¸ â†’ ìŠ¬ë¡¯ í¸ì§‘ â†’ ì½˜í…ì¸  ì—°ê²°
   - ë²”ìœ„ ì„¤ì • í›„ "ìŠ¤ì¼€ì¤„ ì¬ìƒì„±"
   - virtual_plan_items â†’ plan_items ë³€í™˜
```

#### ì‹œë‚˜ë¦¬ì˜¤ C: ë¶€ë¶„ ì—°ê²° í›„ ìŠ¤ì¼€ì¤„ ìƒì„±

```
1. ìŠ¬ë¡¯ 3ê°œ ì¤‘ 2ê°œë§Œ ì½˜í…ì¸  ì—°ê²°
   - ìˆ˜í•™: âœ… ê°œë…ì›ë¦¬ p.1-200
   - ì˜ì–´: âŒ ë¯¸ì—°ê²°
   - êµ­ì–´: âœ… ê³ ì „ë¬¸í•™ p.1-150

2. ìŠ¤ì¼€ì¤„ ìƒì„± (í˜¼í•©)
   - ìˆ˜í•™, êµ­ì–´: ì‹¤ì œ plan_items
   - ì˜ì–´: virtual_plan_items

3. ìº˜ë¦°ë” í‘œì‹œ
   â”‚ 09:00-10:30 â”‚ ğŸ“š ìˆ˜í•™ p.1-10              â”‚ â† ì‹¤ì œ
   â”‚ 10:30-12:30 â”‚ ğŸ¬ ì˜ì–´ (ì½˜í…ì¸  ë¯¸ì •)        â”‚ â† ê°€ìƒ
   â”‚ 14:00-15:00 â”‚ ğŸ“š êµ­ì–´ p.1-8               â”‚ â† ì‹¤ì œ

4. ì˜ì–´ ì½˜í…ì¸  ì—°ê²° ì‹œ
   - í•´ë‹¹ ìŠ¬ë¡¯ë§Œ ì¬ê³„ì‚°
   - virtual â†’ ì‹¤ì œ ë³€í™˜
```

---

## 4. ìŠ¬ë¡¯ íƒ€ì… í™•ì¥

### 4.1 í˜„ì¬ SlotTemplate íƒ€ì…

```typescript
export type SlotTemplate = {
  slot_index: number;
  slot_type: SlotType | null;
  subject_category: string;
  subject_id?: string | null;           // âš ï¸ ì¡´ì¬í•˜ë‚˜ UI ë¯¸êµ¬í˜„
  curriculum_revision_id?: string | null;
  is_required?: boolean;
  is_locked?: boolean;
  is_ghost?: boolean;
  ghost_message?: string;
  default_search_term?: string;
};
```

### 4.2 í™•ì¥ëœ SlotTemplate íƒ€ì… (ì œì•ˆ)

```typescript
export type SlotTemplate = {
  // ê¸°ë³¸ ì‹ë³„
  slot_index: number;
  slot_type: SlotType | null;

  // êµê³¼/ê³¼ëª©
  subject_category: string;
  subject_id?: string | null;
  curriculum_revision_id?: string | null;

  // ğŸ†• ì „ëµ/ì·¨ì•½ ì„¤ì • (ê¸°ì¡´ SubjectAllocation í˜¸í™˜)
  subject_type?: "strategy" | "weakness";  // ê¸°ë³¸ê°’: "weakness"
  weekly_days?: number;                     // ì „ëµê³¼ëª©ì¼ ë•Œ: 2, 3, 4

  // ğŸ†• ì‹œê°„ ì œì•½ (ì„ íƒì‚¬í•­)
  block_duration_minutes?: number;   // ê¸°ë³¸ ë¸”ë¡ ì‹œê°„ (ê¸°ë³¸ 90ë¶„)
  min_daily_minutes?: number;        // ìµœì†Œ ì¼ì¼ í•™ìŠµ
  max_daily_minutes?: number;        // ìµœëŒ€ ì¼ì¼ í•™ìŠµ

  // ê¸°ì¡´ í•„ë“œ
  is_required?: boolean;
  is_locked?: boolean;
  is_ghost?: boolean;
  ghost_message?: string;
  default_search_term?: string;
};
```

### 4.3 ê³¼ëª© ì„ íƒ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìŠ¬ë¡¯ 1                                               [ì‚­ì œ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ğŸ“š êµì¬  â–¼  â”‚  â”‚ ìˆ˜í•™      â–¼ â”‚  â”‚ ìˆ˜í•™â…¡    â–¼ â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚     ì½˜í…ì¸  íƒ€ì…          êµê³¼              ê³¼ëª© (ì„ íƒ)           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ë°°ì • ë°©ì‹                                                   â”‚â”‚
â”‚  â”‚  â— ì·¨ì•½ê³¼ëª© - ì „ì²´ í•™ìŠµì¼ì— ë°°ì •                             â”‚â”‚
â”‚  â”‚  â—‹ ì „ëµê³¼ëª© - ì£¼ë‹¹ [3 â–¼]ì¼ë§Œ ë°°ì •                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“Š ì˜ˆìƒ ë°°ì •: ì „ì²´ 6ì¼ ì¤‘ 6ì¼ (ì·¨ì•½)                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ì—°ê²°ëœ ì½˜í…ì¸ : ì—†ìŒ                         [ì½˜í…ì¸  ì—°ê²°]    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. ë°ì´í„° íë¦„ ì •ë¦¬

### 5.1 ì „ì²´ ë°ì´í„° íë¦„

```
Step 2: ì‹œê°„ ì„¤ì •
    â”‚
    â”œâ”€â†’ daily_schedule ìƒì„± (ë‚ ì§œë³„ study_hours)
    â”‚
    â–¼
Step 4: ìŠ¬ë¡¯ ì„¤ê³„
    â”‚
    â”œâ”€â†’ content_slots ìƒì„±/ìˆ˜ì •
    â”‚   â””â”€ subject_type (strategy/weakness)
    â”‚   â””â”€ weekly_days (ì „ëµê³¼ëª©ì¼ ë•Œ: 2, 3, 4)
    â”‚   â””â”€ subject_category, subject_id
    â”‚   â””â”€ (ì„ íƒ) content_id, start_range, end_range
    â”‚
    â”œâ”€â†’ buildAllocationFromSlots()
    â”‚   â””â”€ content_slots â†’ SubjectAllocation[] ë³€í™˜
    â”‚
    â”œâ”€â†’ calculateVirtualTimeline()
    â”‚   â””â”€ daily_schedule + content_slots â†’ ì¼ìˆ˜ ê¸°ë°˜ ê°€ìƒ ë°°ì¹˜
    â”‚
    â–¼
Step 5: ìŠ¤ì¼€ì¤„ ìƒì„±
    â”‚
    â”œâ”€â†’ generatePlans()
    â”‚   â”‚
    â”‚   â”œâ”€ [ì½˜í…ì¸  ì—°ê²°ë¨] â†’ ì‹¤ì œ plan_items ìƒì„±
    â”‚   â”‚   â””â”€ ë²”ìœ„ ê¸°ë°˜ ë¶„í• 
    â”‚   â”‚
    â”‚   â””â”€ [ì½˜í…ì¸  ë¯¸ì—°ê²°] â†’ virtual_plan_items ìƒì„±
    â”‚       â””â”€ ì¼ìˆ˜ ê¸°ë°˜ ê°€ìƒ ë°°ì • (ì „ëµ: ì£¼Nì¼, ì·¨ì•½: ì „ì²´ì¼)
    â”‚
    â–¼
í”Œëœ ìƒì„¸
    â”‚
    â”œâ”€â†’ ìº˜ë¦°ë” í‘œì‹œ (ì‹¤ì œ + ê°€ìƒ í˜¼í•©)
    â”‚
    â”œâ”€â†’ ìŠ¬ë¡¯ í¸ì§‘ â†’ ì½˜í…ì¸  ì—°ê²°
    â”‚   â””â”€â†’ regeneratePlanItems() â†’ í•´ë‹¹ ìŠ¬ë¡¯ë§Œ ì¬ê³„ì‚°
    â”‚
    â–¼
í•™ìŠµ ì‹œì‘
    â””â”€â†’ ì‹¤ì œ plan_itemsë§Œ í•™ìŠµ ê°€ëŠ¥
        (ê°€ìƒ í•­ëª©ì€ "ì½˜í…ì¸  ì—°ê²° í•„ìš”" í‘œì‹œ)
```

### 5.2 scheduler_options í†µí•©

```typescript
// í˜„ì¬: subject_allocations ë³„ë„ ê´€ë¦¬
type SchedulerOptions = {
  // ... ê¸°íƒ€ í•„ë“œ
  subject_allocations?: SubjectAllocation[];
  content_allocations?: ContentAllocation[];
};

// ê°œì„ : content_slotsì—ì„œ ìë™ ìœ ë„ (Dual Write íŒ¨í„´)
type SchedulerOptions = {
  // ... ê¸°íƒ€ í•„ë“œ

  // ê¸°ì¡´ í•„ë“œ ìœ ì§€ (í•˜ìœ„ í˜¸í™˜ì„±)
  subject_allocations?: SubjectAllocation[];
  content_allocations?: ContentAllocation[];
};

// Dual Write ì „ëµ:
// 1. use_slot_mode = true ì‹œ:
//    - content_slotsì—ì„œ buildAllocationFromSlots()ë¡œ subject_allocations ìë™ ìƒì„±
//    - ê¸°ì¡´ ë¡œì§ê³¼ ìƒˆ ë¡œì§ ëª¨ë‘ ë™ì‘
// 2. use_slot_mode = false ë˜ëŠ” content_slots ì—†ìŒ:
//    - ê¸°ì¡´ subject_allocations ì‚¬ìš©
// 3. ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ í›„:
//    - content_slots ìš°ì„ , subject_allocationsëŠ” ì½ê¸° ì „ìš©ìœ¼ë¡œ ì „í™˜
```

---

## 6. ì¶”ê°€ ê³ ë ¤ ì‚¬í•­

### 6.1 ê¸°ì¡´ í”Œëœ í˜¸í™˜ì„±

| ìƒí™© | ì²˜ë¦¬ ë°©ë²• |
|------|-----------|
| content_slots ì—†ìŒ + subject_allocations ìˆìŒ | ê¸°ì¡´ ë¡œì§ ì‚¬ìš© |
| content_slots ìˆìŒ | ìŠ¬ë¡¯ ê¸°ë°˜ ë¡œì§ ì‚¬ìš© |
| ë‘˜ ë‹¤ ì—†ìŒ | ê¸°ë³¸ ê· ë“± ë°°ë¶„ |

### 6.2 ê°€ìƒ í”Œëœ ì•„ì´í…œ í‘œì‹œ

```
ìº˜ë¦°ë”/íƒ€ì„ë¼ì¸ì—ì„œ ê°€ìƒ í•­ëª© êµ¬ë¶„:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 12/26 (ëª©) - í•™ìŠµì¼                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 09:00-10:30 â”‚ ğŸ“š ìˆ˜í•™ â”‚ ê°œë…ì›ë¦¬ p.1-10       â”‚ â† ì‹¤ì œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 10:30-12:30 â”‚ ğŸ¬ ì˜ì–´ â”‚ âš ï¸ ì½˜í…ì¸  ë¯¸ì •       â”‚ â† ê°€ìƒ
â”‚             â”‚         â”‚    [ì½˜í…ì¸  ì—°ê²°í•˜ê¸°]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 14:00-15:00 â”‚ ğŸ“š êµ­ì–´ â”‚ ê³ ì „ë¬¸í•™ p.1-8        â”‚ â† ì‹¤ì œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ìŠ¤íƒ€ì¼ êµ¬ë¶„:
- ì‹¤ì œ: ì¼ë°˜ ë°°ê²½
- ê°€ìƒ: ì ì„  í…Œë‘ë¦¬, ì—°í•œ ë°°ê²½, "ì½˜í…ì¸  ì—°ê²°" ë²„íŠ¼
```

### 6.3 í•™ìŠµ ì‹œì‘ ì¡°ê±´

```typescript
function canStartLearning(planItem: PlanItem): boolean {
  // ê°€ìƒ í”Œëœì€ í•™ìŠµ ì‹œì‘ ë¶ˆê°€
  if (planItem.is_virtual || !planItem.content_id) {
    return false;
  }
  return true;
}

// UIì—ì„œ:
// - ê°€ìƒ í•­ëª©: "ì½˜í…ì¸ ë¥¼ ì—°ê²°í•´ì•¼ í•™ìŠµì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
// - ì‹¤ì œ í•­ëª©: "í•™ìŠµ ì‹œì‘" ë²„íŠ¼ í™œì„±í™”
```

### 6.4 êµ¬í˜„ ìš°ì„ ìˆœìœ„ (ìˆ˜ì •ë¨)

#### Phase 1: ìŠ¬ë¡¯ íƒ€ì… í™•ì¥
- [ ] `subject_type`, `weekly_days` í•„ë“œ ì¶”ê°€ (SlotTemplate, ContentSlot)
- [ ] ìŠ¬ë¡¯ UIì— ë°°ì • ë°©ì‹ ì„ íƒ ì¶”ê°€ (ì·¨ì•½/ì „ëµ + weekly_days)
- [ ] ê³¼ëª© ì„ íƒ UI ì¶”ê°€ (`subject_id`)

#### Phase 2: ë°°ì • ë¡œì§ í†µí•©
- [ ] `buildAllocationFromSlots()` êµ¬í˜„ (ìŠ¬ë¡¯ â†’ SubjectAllocation ë³€í™˜)
- [ ] ê°€ìƒ íƒ€ì„ë¼ì¸ì— ì¼ìˆ˜ ê¸°ë°˜ ë°°ì • í‘œì‹œ
- [ ] ê¸°ì¡´ `subject_allocations`ì™€ì˜ í˜¸í™˜ì„± ìœ ì§€ (Dual Write)

#### Phase 3: ê°€ìƒ ìŠ¤ì¼€ì¤„ ìƒì„±
- [ ] `virtual_plan_items` ìƒì„± ë¡œì§
- [ ] `generatePlans()` ìˆ˜ì • (í˜¼í•© ëª¨ë“œ ì§€ì›)
- [ ] ìº˜ë¦°ë”ì— ê°€ìƒ í•­ëª© í‘œì‹œ

#### Phase 4: ì½˜í…ì¸  ì—°ê²° í›„ ì¬ìƒì„±
- [ ] ìŠ¬ë¡¯ë³„ ì½˜í…ì¸  ì—°ê²° UI
- [ ] `regeneratePlanItems()` êµ¬í˜„
- [ ] ë¶€ë¶„ ì¬ìƒì„± (ë³€ê²½ëœ ìŠ¬ë¡¯ë§Œ)

---

## 7. ëª¨ë“œ í†µí•© ì‹œ ì½˜í…ì¸  ì—°ê²° ê¸°ëŠ¥ í†µí•©

### 7.1 ê¸°ë³¸ ëª¨ë“œì™€ ìŠ¬ë¡¯ ëª¨ë“œ ê¸°ëŠ¥ ë¹„êµ

| ê¸°ëŠ¥ | ê¸°ë³¸ ëª¨ë“œ | ìŠ¬ë¡¯ ëª¨ë“œ (í˜„ì¬) | í†µí•© ì‹œ í•„ìš” |
|------|-----------|-----------------|--------------|
| **í•™ìƒ ì½˜í…ì¸  ê²€ìƒ‰** | âœ… StudentContentsPanel | âœ… ContentLinkingPanel | ìœ ì§€ |
| **ë§ˆìŠ¤í„° ì½˜í…ì¸  ê°€ì ¸ì˜¤ê¸°** | âœ… MasterContentsPanel | âŒ ì—†ìŒ | ğŸ”´ ì¶”ê°€ í•„ìš” |
| **ì½˜í…ì¸  ìƒì„¸ ì •ë³´ ì„ íƒ** | âœ… RangeSettingModal (ëª©ì°¨/ì—í”¼ì†Œë“œ) | âŒ ìˆ˜ë™ ì…ë ¥ë§Œ | ğŸ”´ ì¶”ê°€ í•„ìš” |
| **ìë™ ì¶”ì²œ (ìŠ¬ë¡¯ ë ˆë²¨)** | âŒ ì—†ìŒ | âœ… SlotRecommendationDropdown | ìœ ì§€ |
| **ìë™ ì¶”ì²œ (ì½˜í…ì¸  ë ˆë²¨)** | âœ… RecommendedContentsPanel | âŒ ì—†ìŒ | ğŸŸ¡ ê²€í†  í•„ìš” |
| **ì¶”ì²œ ì½˜í…ì¸  (ì»¨ì„¤í„´íŠ¸)** | âœ… Step4RecommendedContents | âŒ ì—†ìŒ | ğŸŸ¡ ê²€í†  í•„ìš” |

### 7.2 í˜„ì¬ ìŠ¬ë¡¯ ëª¨ë“œ ContentLinkingPanel ë¶„ì„

```typescript
// í˜„ì¬ ContentLinkingPanel.tsxì˜ ì œí•œ ì‚¬í•­

// 1. ì½˜í…ì¸  ì†ŒìŠ¤ ì œí•œ (í•™ìƒ ì½˜í…ì¸ ë§Œ)
const filteredContents = useMemo(() => {
  let contents: ContentItem[] = [];
  if (selectedSlot.slot_type === "book") {
    contents = availableContents.books;      // í•™ìƒ booksë§Œ
  } else if (selectedSlot.slot_type === "lecture") {
    contents = availableContents.lectures;   // í•™ìƒ lecturesë§Œ
  }
  // âŒ ë§ˆìŠ¤í„° ì½˜í…ì¸  ì—†ìŒ
});

// 2. ë²”ìœ„ ì„¤ì • ì œí•œ (ìˆ˜ë™ ì…ë ¥ë§Œ)
<input type="number" value={rangeStart} />  // âŒ ìƒì„¸ ì •ë³´ ì„ íƒ ì—†ìŒ
<input type="number" value={rangeEnd} />
```

### 7.3 ì½˜í…ì¸  ì—°ê²° ê¸°ëŠ¥ í†µí•© ì„¤ê³„

#### 7.3.1 í™•ì¥ëœ ContentLinkingPanel

```typescript
type ContentLinkingPanelProps = {
  selectedSlot: ContentSlot | null;
  slotIndex: number | null;

  // ê¸°ì¡´: í•™ìƒ ì½˜í…ì¸ 
  availableContents: {
    books: ContentItem[];
    lectures: ContentItem[];
    custom: ContentItem[];
  };

  // ğŸ†• ì¶”ê°€: ë§ˆìŠ¤í„° ì½˜í…ì¸  ê²€ìƒ‰ í™œì„±í™”
  enableMasterContentSearch?: boolean;

  // ğŸ†• ì¶”ê°€: ìƒì„¸ ì •ë³´ ì„ íƒ í™œì„±í™”
  enableDetailSelection?: boolean;

  // ğŸ†• ì¶”ê°€: ìë™ ì¶”ì²œ ì½˜í…ì¸  (ì»¨ì„¤í„´íŠ¸ ì¶”ì²œ)
  recommendedContents?: ContentItem[];

  onLinkContent: (
    slotIndex: number,
    content: ContentItem,
    range: {
      start: number;
      end: number;
      start_detail_id?: string;  // ğŸ†• ì¶”ê°€
      end_detail_id?: string;    // ğŸ†• ì¶”ê°€
    }
  ) => void;
  // ...
};
```

#### 7.3.2 ì½˜í…ì¸  ì—°ê²° UI í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìŠ¬ë¡¯ 1 - ìˆ˜í•™ êµì¬                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ì½˜í…ì¸  ì†ŒìŠ¤ íƒ­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ [ë‚´ ì½˜í…ì¸ ] â”‚ [ë§ˆìŠ¤í„° ì½˜í…ì¸ ] â”‚ [ì¶”ì²œ ì½˜í…ì¸ ]                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ë‚´ ì½˜í…ì¸  (ê¸°ë³¸) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ğŸ” [ê²€ìƒ‰...]                                                   â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚ ğŸ“š ê°œë…ì›ë¦¬ ìˆ˜í•™â…¡                         [ì„ íƒ]        â”‚  â”‚â”‚
â”‚  â”‚  â”‚ ğŸ“š ìˆ˜í•™ì˜ ì •ì„ ìˆ˜í•™â…¡                      [ì„ íƒ]        â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ë§ˆìŠ¤í„° ì½˜í…ì¸  (ìƒˆë¡œ ì¶”ê°€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  êµìœ¡ê³¼ì •: [2022 ê°œì • â–¼] êµê³¼: [ìˆ˜í•™ â–¼] ê³¼ëª©: [ìˆ˜í•™â…¡ â–¼]        â”‚â”‚
â”‚  â”‚  ğŸ” [ê²€ìƒ‰...]                                   [ê²€ìƒ‰]          â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚ ğŸ“š EBS ìˆ˜ëŠ¥ì™„ì„± ìˆ˜í•™â…¡ (2024)               [ê°€ì ¸ì˜¤ê¸°]   â”‚  â”‚â”‚
â”‚  â”‚  â”‚ ğŸ“š ë©”ê°€ìŠ¤í„°ë”” ê°œë… ê¸°ë³¸ì„œ ìˆ˜í•™â…¡            [ê°€ì ¸ì˜¤ê¸°]   â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ì¶”ì²œ ì½˜í…ì¸  (ì»¨ì„¤í„´íŠ¸ ì¶”ì²œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  â­ ì»¨ì„¤í„´íŠ¸ê°€ ì´ êµê³¼ì— ì¶”ì²œí•œ ì½˜í…ì¸                            â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
â”‚  â”‚  â”‚ ğŸ“š ìˆ ìˆ˜í•™â…¡                               [ì—°ê²°í•˜ê¸°]    â”‚  â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 7.3.3 ë²”ìœ„ ì„¤ì • ê°œì„  (ìƒì„¸ ì •ë³´ ì„ íƒ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“š ê°œë…ì›ë¦¬ ìˆ˜í•™â…¡ - ë²”ìœ„ ì„¤ì •                              [ë‹«ê¸°] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ë²”ìœ„ ì„ íƒ ë°©ì‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ â— ëª©ì°¨ë¡œ ì„ íƒ    â—‹ ì§ì ‘ ì…ë ¥                                    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ì‹œì‘ ë²”ìœ„ (ëª©ì°¨ ì„ íƒ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  [â–¼ 1ì¥. í•¨ìˆ˜ì˜ ê·¹í•œ]                                           â”‚â”‚
â”‚  â”‚  â”œâ”€ 1-1. í•¨ìˆ˜ì˜ ê·¹í•œ (p.8)                                      â”‚â”‚
â”‚  â”‚  â”œâ”€ 1-2. í•¨ìˆ˜ì˜ ì—°ì† (p.24)  â† ì„ íƒë¨                           â”‚â”‚
â”‚  â”‚  â””â”€ ...                                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€ ì¢…ë£Œ ë²”ìœ„ (ëª©ì°¨ ì„ íƒ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  [â–¼ 3ì¥. ì ë¶„ë²•]                                                â”‚â”‚
â”‚  â”‚  â”œâ”€ 3-1. ë¶€ì •ì ë¶„ (p.156)                                       â”‚â”‚
â”‚  â”‚  â”œâ”€ 3-2. ì •ì ë¶„ (p.178)  â† ì„ íƒë¨                               â”‚â”‚
â”‚  â”‚  â””â”€ ...                                                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                     â”‚
â”‚  ğŸ“Š ì„ íƒ ë²”ìœ„: p.24 ~ p.178 (154í˜ì´ì§€)                             â”‚
â”‚                                                                     â”‚
â”‚  [ì·¨ì†Œ]                                        [ë²”ìœ„ í™•ì •]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 ìë™ ì¶”ì²œ ê¸°ëŠ¥ ë¹„êµ

#### 7.4.1 ìŠ¬ë¡¯ ë ˆë²¨ ìë™ ì¶”ì²œ (í˜„ì¬ ìˆìŒ)

```typescript
// SlotRecommendationDropdown.tsx
// í•™ë…„, ëª©ì , ê°•ë„ì— ë”°ë¼ ìŠ¬ë¡¯ êµ¬ì„± í”„ë¦¬ì…‹ ì¶”ì²œ

PURPOSE_OPTIONS = [
  { value: "comprehensive", label: "ì¢…í•© í•™ìŠµ" },
  { value: "weakness", label: "ì·¨ì•½ì  ë³´ì™„" },
  // ...
];

GRADE_OPTIONS = [
  { value: "high1", label: "ê³ 1" },
  { value: "high2", label: "ê³ 2" },
  // ...
];
```

#### 7.4.2 ì½˜í…ì¸  ë ˆë²¨ ìë™ ì¶”ì²œ (ê¸°ë³¸ ëª¨ë“œì—ë§Œ ìˆìŒ)

```typescript
// ê¸°ë³¸ ëª¨ë“œ: useRecommendedContents.ts
// í•™ìƒì˜ í•™ìŠµ ì´ë ¥, ì„±ì  ê¸°ë°˜ ì½˜í…ì¸  ì¶”ì²œ

// ìŠ¬ë¡¯ ëª¨ë“œ í†µí•© ì‹œ: ìŠ¬ë¡¯ì˜ êµê³¼/ê³¼ëª© ê¸°ë°˜ ì¶”ì²œ í•„ìš”
async function getRecommendedContentsForSlot(
  slot: ContentSlot,
  studentId: string
): Promise<ContentItem[]> {
  // 1. ìŠ¬ë¡¯ì˜ subject_category, subject_id ê¸°ë°˜
  // 2. í•™ìƒì˜ í•´ë‹¹ ê³¼ëª© í•™ìŠµ ì´ë ¥ ë¶„ì„
  // 3. ì¶”ì²œ ì½˜í…ì¸  ë°˜í™˜
}
```

### 7.5 êµ¬í˜„ ìš°ì„ ìˆœìœ„

#### Phase 1: ë§ˆìŠ¤í„° ì½˜í…ì¸  ê°€ì ¸ì˜¤ê¸°
- [ ] ContentLinkingPanelì— ë§ˆìŠ¤í„° ì½˜í…ì¸  íƒ­ ì¶”ê°€
- [ ] MasterContentsPanel ë¡œì§ ì¬ì‚¬ìš© (ê²€ìƒ‰ API, í•„í„°)
- [ ] ë§ˆìŠ¤í„° â†’ í•™ìƒ ì½˜í…ì¸  ë³€í™˜ ë¡œì§

#### Phase 2: ìƒì„¸ ì •ë³´ ì„ íƒ
- [ ] RangeSettingModal í†µí•©
- [ ] ContentLinkingPanelì—ì„œ ìƒì„¸ ì •ë³´ ì„ íƒ UI ì¶”ê°€
- [ ] start_detail_id, end_detail_id ì €ì¥

#### Phase 3: ì¶”ì²œ ì½˜í…ì¸  ì—°ë™
- [ ] ìŠ¬ë¡¯ ê¸°ë°˜ ì½˜í…ì¸  ì¶”ì²œ ë¡œì§
- [ ] ì»¨ì„¤í„´íŠ¸ ì¶”ì²œ ì½˜í…ì¸  í‘œì‹œ
- [ ] í•™ìŠµ ì´ë ¥ ê¸°ë°˜ ì¶”ì²œ (ì„ íƒì‚¬í•­)

### 7.6 ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©

| ê¸°ë³¸ ëª¨ë“œ ì»´í¬ë„ŒíŠ¸ | ìŠ¬ë¡¯ ëª¨ë“œ í†µí•© ë°©ë²• |
|-------------------|-------------------|
| `MasterContentsPanel.tsx` | ê²€ìƒ‰ ë¡œì§ ì¶”ì¶œí•˜ì—¬ ê³µí†µ í›… ìƒì„± |
| `RangeSettingModal.tsx` | ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš© (isSlotMode prop ì¶”ê°€) |
| `useRecommendedContents.ts` | ìŠ¬ë¡¯ ê¸°ë°˜ í•„í„° ì¡°ê±´ ì¶”ê°€ |
| `ContentCard.tsx` | ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš© |

## 8. ê´€ë ¨ íŒŒì¼

### ê¸°ì¡´ ì‹œìŠ¤í…œ ì°¸ê³  íŒŒì¼
```
lib/types/plan/domain.ts          # SubjectAllocation íƒ€ì… ì •ì˜
lib/utils/subjectAllocation.ts    # getEffectiveAllocation() í•¨ìˆ˜
lib/plan/1730TimetableLogic.ts    # calculateSubjectAllocationDates() í•¨ìˆ˜
app/(student)/plan/new-group/_components/_features/content-selection/Step6FinalReview/
â””â”€â”€ SubjectAllocationUI.tsx       # í˜„ì¬ ì „ëµ/ì·¨ì•½ ì„¤ì • UI
```

### íƒ€ì… ìˆ˜ì • í•„ìš”
```
lib/types/content-selection.ts    # SlotTemplate, ContentSlotì— subject_type, weekly_days ì¶”ê°€
lib/types/plan/domain.ts          # PlanItem ìˆ˜ì • (is_virtual, slot_index ë“±)
```

### ë¡œì§ ìˆ˜ì • í•„ìš”
```
lib/plan/virtualSchedulePreview.ts            # buildAllocationFromSlots() ì¶”ê°€
lib/utils/subjectAllocation.ts                # ìŠ¬ë¡¯ ê¸°ë°˜ ë¡œì§ í†µí•©
lib/domains/plan/actions/plan-groups/generatePlansRefactored.ts  # ê°€ìƒ í”Œëœ ìƒì„±
```

### UI ìˆ˜ì • í•„ìš”
```
app/(student)/plan/new-group/_components/_features/content-selection/slot-mode/
â”œâ”€â”€ SlotItem.tsx                  # ë°°ì • ë°©ì‹ (ì·¨ì•½/ì „ëµ + weekly_days) UI ì¶”ê°€
â”œâ”€â”€ SlotConfigurationPanel.tsx    # ì¼ìˆ˜ ê¸°ë°˜ ë°°ì • ë¯¸ë¦¬ë³´ê¸°
â”œâ”€â”€ ContentLinkingPanel.tsx       # ë§ˆìŠ¤í„° ì½˜í…ì¸  íƒ­, ìƒì„¸ ì„ íƒ ì¶”ê°€
â””â”€â”€ VirtualTimelinePreview.tsx    # ê°€ìƒ/ì‹¤ì œ êµ¬ë¶„ í‘œì‹œ
```

### ì½˜í…ì¸  ì—°ê²° ê¸°ëŠ¥ í†µí•© ê´€ë ¨ (ê¸°ë³¸ ëª¨ë“œì—ì„œ ì¬ì‚¬ìš©)
```
app/(student)/plan/new-group/_components/_features/content-selection/components/
â”œâ”€â”€ MasterContentsPanel.tsx       # ë§ˆìŠ¤í„° ì½˜í…ì¸  ê²€ìƒ‰/ê°€ì ¸ì˜¤ê¸° (ì¬ì‚¬ìš©)
â”œâ”€â”€ RangeSettingModal.tsx         # ìƒì„¸ ì •ë³´ ì„ íƒ ëª¨ë‹¬ (ì¬ì‚¬ìš©)
â”œâ”€â”€ ContentCard.tsx               # ì½˜í…ì¸  ì¹´ë“œ UI (ì¬ì‚¬ìš©)
â”œâ”€â”€ RecommendedContentsPanel.tsx  # ì¶”ì²œ ì½˜í…ì¸  (ì¬ì‚¬ìš© ê²€í† )
â””â”€â”€ StudentContentsPanel.tsx      # í•™ìƒ ì½˜í…ì¸  (ì°¸ì¡°)

app/(student)/plan/new-group/_components/_features/content-selection/hooks/
â”œâ”€â”€ useRecommendedContents.ts     # ì½˜í…ì¸  ì¶”ì²œ í›… (ìŠ¬ë¡¯ ê¸°ë°˜ í™•ì¥)
â””â”€â”€ useStudentContentSelection.ts # í•™ìƒ ì½˜í…ì¸  ì„ íƒ (ì°¸ì¡°)
```
