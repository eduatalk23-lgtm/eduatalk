# í”Œëœ ê·¸ë£¹ ìƒì„¸ í˜ì´ì§€ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 

**ì‘ì—… ì¼ì‹œ**: 2025-12-05  
**ì‘ì—… ë²”ìœ„**: ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ê°œì„ 

---

## ğŸ› ë¬¸ì œ ìƒí™©

`PlanGroupDetailPage`ì—ì„œ í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì‹œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì§€ë§Œ, ì—ëŸ¬ ì •ë³´ê°€ ì œëŒ€ë¡œ ì¶”ì¶œë˜ì§€ ì•Šì•„ ì½˜ì†”ì— ë¹ˆ ê°ì²´(`{} {}`)ë¡œ ì¶œë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.

```
[PlanGroupDetailPage] í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì—ëŸ¬: {} {}
```

---

## ğŸ” ì›ì¸ ë¶„ì„

ê¸°ì¡´ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ì´ Supabase ì—ëŸ¬ ê°ì²´ì˜ ì†ì„±ì„ ì•ˆì „í•˜ê²Œ ì¶”ì¶œí•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤:

1. **ì—ëŸ¬ ê°ì²´ íƒ€ì… ë¶ˆì¼ì¹˜**: Supabase ì—ëŸ¬ ê°ì²´ê°€ `Error` ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹ ìˆ˜ ìˆìŒ
2. **ì†ì„± ì ‘ê·¼ ì‹¤íŒ¨**: ì—ëŸ¬ ê°ì²´ì˜ ì†ì„±ì— ì ‘ê·¼í•  ë•Œ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
3. **ì›ë³¸ ì—ëŸ¬ ì •ë³´ ì†ì‹¤**: ì—ëŸ¬ ì •ë³´ ì¶”ì¶œ ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì—ëŸ¬ ì •ë³´ê°€ ì†ì‹¤ë¨

---

## âœ… í•´ê²° ë°©ë²•

### 1. ì•ˆì „í•œ ì—ëŸ¬ ì†ì„± ì¶”ì¶œ ë¡œì§ êµ¬í˜„

ì—ëŸ¬ ê°ì²´ë¥¼ ë” ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•˜ë„ë¡ ê°œì„ :

```typescript
// Supabase ì—ëŸ¬ ê°ì²´ì˜ ì£¼ìš” ì†ì„± ì¶”ì¶œ (ë” ì•ˆì „í•œ ì²˜ë¦¬)
const errorInfo: Record<string, unknown> = {};

try {
  if (blockSetError instanceof Error) {
    errorInfo.message = blockSetError.message;
    errorInfo.name = blockSetError.name;
    errorInfo.stack = blockSetError.stack;
  } else if (typeof blockSetError === "object" && blockSetError !== null) {
    // ì¼ë°˜ ê°ì²´ì¸ ê²½ìš° ëª¨ë“  ì†ì„± ë³µì‚¬
    Object.keys(blockSetError).forEach((key) => {
      try {
        errorInfo[key] = (blockSetError as Record<string, unknown>)[key];
      } catch {
        // ì†ì„± ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ
      }
    });
  } else {
    errorInfo.value = String(blockSetError);
  }
  
  // Supabase ì—ëŸ¬ì˜ í‘œì¤€ ì†ì„±ë“¤ í™•ì¸
  const standardKeys = ["message", "code", "details", "hint", "statusCode"];
  standardKeys.forEach((key) => {
    if (key in blockSetError) {
      try {
        errorInfo[key] = (blockSetError as Record<string, unknown>)[key];
      } catch {
        // ì†ì„± ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ
      }
    }
  });
} catch (extractError) {
  errorInfo.extractionError = String(extractError);
  errorInfo.rawError = String(blockSetError);
}

// ìµœì†Œí•œì˜ ì •ë³´ë¼ë„ ë³´ì¥
if (Object.keys(errorInfo).length === 0) {
  errorInfo.message = String(blockSetError);
}
```

### 2. ì›ë³¸ ì—ëŸ¬ ì •ë³´ ë³´ì¡´

ì—ëŸ¬ ë¡œê·¸ì— ì›ë³¸ ì—ëŸ¬ ê°ì²´ë„ í•¨ê»˜ ì¶œë ¥:

```typescript
console.error(
  "[PlanGroupDetailPage] í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì—ëŸ¬:",
  errorInfo,
  {
    block_set_id: blockSetId,
    template_id: group.camp_template_id,
  },
  "ì›ë³¸ ì—ëŸ¬:",
  blockSetError
);
```

### 3. ëª¨ë“  ì—ëŸ¬ ì²˜ë¦¬ ì§€ì  ê°œì„ 

ë‹¤ìŒ ì„¸ ê°€ì§€ ì—ëŸ¬ ì²˜ë¦¬ ì§€ì  ëª¨ë‘ ê°œì„ :

1. **í…œí”Œë¦¿ ì¡°íšŒ ì—ëŸ¬** (ë¼ì¸ ~170)
2. **í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì—ëŸ¬** (ë¼ì¸ ~243)
3. **í…œí”Œë¦¿ ë¸”ë¡ ì¡°íšŒ ì—ëŸ¬** (ë¼ì¸ ~293)

---

## ğŸ“ ë³€ê²½ íŒŒì¼

- `app/(student)/plan/group/[id]/page.tsx`
  - ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ê°œì„  (3ê³³)
  - ì›ë³¸ ì—ëŸ¬ ì •ë³´ ë³´ì¡´ ë° ì¶œë ¥

---

## ğŸ¯ ê°œì„  íš¨ê³¼

1. **ìƒì„¸í•œ ì—ëŸ¬ ì •ë³´**: ì—ëŸ¬ ë°œìƒ ì‹œ ë” ìƒì„¸í•œ ì •ë³´ë¥¼ ì½˜ì†”ì—ì„œ í™•ì¸ ê°€ëŠ¥
2. **ë””ë²„ê¹… ìš©ì´ì„±**: ì›ë³¸ ì—ëŸ¬ ê°ì²´ë¥¼ í•¨ê»˜ ì¶œë ¥í•˜ì—¬ ë¬¸ì œ ì›ì¸ íŒŒì•… ìš©ì´
3. **ì•ˆì •ì„± í–¥ìƒ**: ì—ëŸ¬ ì •ë³´ ì¶”ì¶œ ì‹¤íŒ¨ ì‹œì—ë„ ìµœì†Œí•œì˜ ì •ë³´ëŠ” ë³´ì¥

---

## ğŸ”„ í–¥í›„ ì‘ì—…

1. ì‹¤ì œ ì—ëŸ¬ ë°œìƒ ì‹œ ë¡œê·¸ í™•ì¸í•˜ì—¬ ê·¼ë³¸ ì›ì¸ íŒŒì•…
2. í•„ìš” ì‹œ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë¡œì§ ê²€í† 
3. ì—ëŸ¬ ë°œìƒ ì‹œ ì‚¬ìš©ìì—ê²Œ ì ì ˆí•œ ë©”ì‹œì§€ í‘œì‹œ (í˜„ì¬ëŠ” ì½˜ì†” ë¡œê·¸ë§Œ)

---

## ğŸ“ 2ì°¨ ê°œì„  (2025-12-05)

### ë¬¸ì œ ìƒí™©

ì—ëŸ¬ ì •ë³´ê°€ ì—¬ì „íˆ ë¹ˆ ê°ì²´ë¡œ ì¶œë ¥ë˜ëŠ” ë¬¸ì œê°€ ì§€ì†ë¨:

```
[PlanGroupDetailPage] í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì—ëŸ¬: {} {} "ì›ë³¸ ì—ëŸ¬:" {}
```

### ì¶”ê°€ ê°œì„  ì‚¬í•­

#### 1. ìƒì„¸ ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

ì¿¼ë¦¬ ì‹¤í–‰ ì „í›„ë¡œ ìƒì„¸í•œ ìƒíƒœ ì •ë³´ë¥¼ ë¡œê¹…:

```typescript
// ì¿¼ë¦¬ ì‹¤í–‰ ì „
console.log("[PlanGroupDetailPage] í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ì‹œë„:", {
  block_set_id: blockSetId,
  template_id: group.camp_template_id,
});

// ì¿¼ë¦¬ ì‹¤í–‰ í›„
console.log("[PlanGroupDetailPage] í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ê²°ê³¼:", {
  hasError: !!blockSetError,
  hasData: !!templateBlockSet,
  errorType: typeof blockSetError,
  errorIsNull: blockSetError === null,
  errorIsUndefined: blockSetError === undefined,
  errorConstructor: blockSetError?.constructor?.name,
  errorKeys: blockSetError && typeof blockSetError === "object" ? Object.keys(blockSetError) : null,
  data: templateBlockSet,
});
```

#### 2. ë‹¤ì¤‘ ì§ë ¬í™” ë°©ì‹ ì‹œë„

ì—ëŸ¬ ê°ì²´ë¥¼ ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì§ë ¬í™”í•˜ì—¬ ì •ë³´ ì¶”ì¶œ:

- `JSON.stringify()` ì§ì ‘ ì‹œë„
- ìˆœí™˜ ì°¸ì¡° ë°©ì§€ ë¡œì§ í¬í•¨í•œ `JSON.stringify()`
- ëª¨ë“  ì†ì„±ì„ ì•ˆì „í•˜ê²Œ ì¶”ì¶œí•˜ëŠ” ë¡œì§
- ì§ì ‘ ì†ì„± ì ‘ê·¼ (`message`, `code`, `details` ë“±)

#### 3. í¬ê´„ì ì¸ ì—ëŸ¬ ì •ë³´ ìˆ˜ì§‘

ë‹¤ìŒ ì •ë³´ë“¤ì„ ëª¨ë‘ ìˆ˜ì§‘í•˜ì—¬ ì¶œë ¥:

```typescript
const errorInfo = {
  // ê¸°ë³¸ ì •ë³´
  errorExists: !!blockSetError,
  errorType: typeof blockSetError,
  errorConstructor: blockSetError?.constructor?.name,
  
  // ì§ë ¬í™” ê²°ê³¼
  stringified: errorStringified,
  serialized: errorSerialized,
  
  // ì§ì ‘ ì ‘ê·¼
  directMessage: (blockSetError as any)?.message,
  directCode: (blockSetError as any)?.code,
  directDetails: (blockSetError as any)?.details,
  directHint: (blockSetError as any)?.hint,
  directStatusCode: (blockSetError as any)?.statusCode,
  
  // toString ì‹œë„
  toString: blockSetError?.toString?.(),
  
  // Object.keys ì‹œë„
  keys: blockSetError && typeof blockSetError === "object" ? Object.keys(blockSetError) : null,
  
  // ëª¨ë“  ì†ì„± ì‹œë„ (ì•ˆì „í•˜ê²Œ)
  allProperties: { /* ëª¨ë“  ì†ì„± */ },
};
```

### ê¸°ëŒ€ íš¨ê³¼

1. **ì—ëŸ¬ ì›ì¸ íŒŒì•…**: ìƒì„¸í•œ ë¡œê·¸ë¡œ ì‹¤ì œ ì—ëŸ¬ ë°œìƒ ì›ì¸ í™•ì¸ ê°€ëŠ¥
2. **ì—ëŸ¬ íƒ€ì… ì‹ë³„**: ì—ëŸ¬ ê°ì²´ì˜ íƒ€ì…ê³¼ êµ¬ì¡° í™•ì¸ ê°€ëŠ¥
3. **ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ í™•ì¸**: ì‹¤ì œë¡œ ë°ì´í„°ê°€ ì—†ì–´ì„œ ì—ëŸ¬ì¸ì§€, ë‹¤ë¥¸ ì›ì¸ì¸ì§€ êµ¬ë¶„ ê°€ëŠ¥

---

## ğŸ“ 3ì°¨ ê°œì„  (2025-12-05) - ê·¼ë³¸ ì›ì¸ í•´ê²°

### ë¬¸ì œ ì›ì¸ í™•ì¸

ì—ëŸ¬ ë¡œê·¸ë¥¼ í†µí•´ ì‹¤ì œ ì›ì¸ì„ í™•ì¸:

```
code: 'PGRST205'
message: "Could not find the table 'public.template_block_sets' in the schema cache"
hint: "Perhaps you meant the table 'public.camp_template_block_sets'"
```

**ë¬¸ì œ**: ì½”ë“œì—ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” `template_block_sets` í…Œì´ë¸”ì„ ì¡°íšŒí•˜ë ¤ê³  ì‹œë„í–ˆìŠµë‹ˆë‹¤.

### í•´ê²° ë°©ë²•

ì˜¬ë°”ë¥¸ í…Œì´ë¸” êµ¬ì¡°ë¡œ ìˆ˜ì •:

1. **ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ**: `template_block_sets` â†’ `tenant_block_sets`
2. **ë¸”ë¡ ì¡°íšŒ**: `template_blocks` â†’ `tenant_blocks`
3. **ì—°ê²° ì •ë³´ í™•ì¸**: `camp_template_block_sets` í…Œì´ë¸”ì—ì„œ ì—°ê²° ì •ë³´ ë¨¼ì € ì¡°íšŒ

### ìˆ˜ì • ë‚´ìš©

#### 1. ë¸”ë¡ ì„¸íŠ¸ ID ì¡°íšŒ ë¡œì§ ê°œì„ 

ì„¸ ê°€ì§€ ê²½ë¡œì—ì„œ ë¸”ë¡ ì„¸íŠ¸ IDë¥¼ ì°¾ë„ë¡ ê°œì„ :

```typescript
// 1. scheduler_optionsì—ì„œ template_block_set_id í™•ì¸
if (schedulerOptions?.template_block_set_id) {
  blockSetId = schedulerOptions.template_block_set_id;
}

// 2. ì—°ê²° í…Œì´ë¸”ì—ì„œ block_set_id í™•ì¸ (ìƒˆë¡œìš´ ë°©ì‹)
if (!blockSetId && group.camp_template_id) {
  const { data: templateBlockSetLink } = await supabase
    .from("camp_template_block_sets")
    .select("tenant_block_set_id")
    .eq("camp_template_id", group.camp_template_id)
    .maybeSingle();

  if (templateBlockSetLink) {
    blockSetId = templateBlockSetLink.tenant_block_set_id;
  }
}

// 3. template_dataì—ì„œ block_set_id í™•ì¸ (í•˜ìœ„ í˜¸í™˜ì„±)
if (!blockSetId && templateData?.block_set_id) {
  blockSetId = templateData.block_set_id;
}
```

#### 2. ì˜¬ë°”ë¥¸ í…Œì´ë¸”ë¡œ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ

```typescript
// ìˆ˜ì • ì „: template_block_sets (ì¡´ì¬í•˜ì§€ ì•ŠìŒ)
const { data: templateBlockSet } = await supabase
  .from("template_block_sets")
  .select("id, name, template_id")
  .eq("id", blockSetId)
  .maybeSingle();

// ìˆ˜ì • í›„: tenant_block_sets (ì˜¬ë°”ë¥¸ í…Œì´ë¸”)
const { data: templateBlockSet } = await supabase
  .from("tenant_block_sets")
  .select("id, name")
  .eq("id", blockSetId)
  .eq("tenant_id", tenantContext.tenantId)
  .maybeSingle();
```

#### 3. ì˜¬ë°”ë¥¸ í…Œì´ë¸”ë¡œ ë¸”ë¡ ì¡°íšŒ

```typescript
// ìˆ˜ì • ì „: template_blocks
const { data: blocks } = await supabase
  .from("template_blocks")
  .select("id, day_of_week, start_time, end_time")
  .eq("template_block_set_id", templateBlockSet.id)
  .order("day_of_week", { ascending: true });

// ìˆ˜ì • í›„: tenant_blocks
const { data: blocks } = await supabase
  .from("tenant_blocks")
  .select("id, day_of_week, start_time, end_time")
  .eq("tenant_block_set_id", templateBlockSet.id)
  .order("day_of_week", { ascending: true });
```

### í…Œì´ë¸” êµ¬ì¡°

```
camp_templates
  â†“ (camp_template_block_sets ì—°ê²° í…Œì´ë¸”)
camp_template_block_sets
  - camp_template_id
  - tenant_block_set_id
  â†“
tenant_block_sets
  - id
  - name
  - tenant_id
  â†“ (tenant_blocks)
tenant_blocks
  - id
  - tenant_block_set_id
  - day_of_week
  - start_time
  - end_time
```

### ê°œì„  íš¨ê³¼

1. âœ… **ì—ëŸ¬ í•´ê²°**: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í…Œì´ë¸” ì¡°íšŒ ë¬¸ì œ í•´ê²°
2. âœ… **ì˜¬ë°”ë¥¸ ë°ì´í„° ì¡°íšŒ**: `tenant_block_sets`ì™€ `tenant_blocks`ì—ì„œ ì •í™•í•œ ë°ì´í„° ì¡°íšŒ
3. âœ… **ë‹¤ì–‘í•œ ê²½ë¡œ ì§€ì›**: scheduler_options, ì—°ê²° í…Œì´ë¸”, template_data ëª¨ë‘ ì§€ì›
4. âœ… **í•˜ìœ„ í˜¸í™˜ì„±**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ë°ì´í„°ë„ ì²˜ë¦¬ ê°€ëŠ¥

