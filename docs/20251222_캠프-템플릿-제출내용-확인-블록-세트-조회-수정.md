# ìº í”„ í…œí”Œë¦¿ ì œì¶œë‚´ìš© í™•ì¸ í˜ì´ì§€ ë¸”ë¡ ì„¸íŠ¸ ì¡°íšŒ ìˆ˜ì •

**ì‘ì—… ì¼ì‹œ**: 2024ë…„ 12ì›” 22ì¼  
**ì‘ì—…ì**: AI Assistant

## ğŸ“‹ ë¬¸ì œ ìƒí™©

ê´€ë¦¬ìê°€ ìº í”„ í…œí”Œë¦¿ ì°¸ì—¬ìì˜ ì œì¶œ ë‚´ìš©ì„ í™•ì¸í•˜ëŠ” í˜ì´ì§€(`/admin/camp-templates/{templateId}/participants/{groupId}/review`)ì—ì„œ ë¸”ë¡ ì„¸íŠ¸ê°€ ì¡°íšŒë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

### ì¦ìƒ

- "ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”" ë©”ì‹œì§€ê°€ í‘œì‹œë¨
- "ë“±ë¡ëœ ë¸”ë¡ ì„¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤. '+' ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìƒì„±í•˜ì„¸ìš”." ë©”ì‹œì§€ê°€ í‘œì‹œë¨
- ì½ê¸° ì „ìš© ëª¨ë“œì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

### ì›ì¸ ë¶„ì„

1. **`CampPlanGroupReviewForm`ì—ì„œ ë¹ˆ `blockSets` ë°°ì—´ ì „ë‹¬**
   - `Step1BasicInfo` ì»´í¬ë„ŒíŠ¸ì— `blockSets={[]}`ë¡œ ë¹ˆ ë°°ì—´ì„ ì „ë‹¬
   - `Step1BasicInfo`ëŠ” `blockSets` propì—ì„œ ì„ íƒëœ ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ”ë°, ë¹ˆ ë°°ì—´ì´ë¯€ë¡œ ì°¾ì„ ìˆ˜ ì—†ìŒ

2. **í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ ë¯¸ì‚¬ìš©**
   - `templateBlockSetId`, `templateBlockSetName`, `templateBlocks`ë¥¼ propsë¡œ ë°›ê³  ìˆì§€ë§Œ
   - `blockSets` ë°°ì—´ì„ êµ¬ì„±í•  ë•Œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

3. **`wizardData.block_set_id` ë¯¸ì„¤ì •**
   - í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ IDê°€ `wizardData.block_set_id`ì— ì„¤ì •ë˜ì§€ ì•Šì•„
   - `Step1BasicInfo`ì—ì„œ ì„ íƒëœ ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ

## ğŸ›  í•´ê²° ë°©ë²•

### ìˆ˜ì • ë‚´ìš©

#### 1. `CampPlanGroupReviewForm.tsx` - í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ë¥¼ `blockSets` í˜•ì‹ìœ¼ë¡œ ë³€í™˜

**íŒŒì¼**: `app/(admin)/admin/camp-templates/[id]/participants/[groupId]/review/CampPlanGroupReviewForm.tsx`

**ë³€ê²½ ì „**:
```typescript
// WizardData ìƒì„± (Step ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©)
const wizardData = useMemo(() => {
  return planGroupToWizardData(
    group,
    exclusions,
    academySchedules,
    studentContentsWithDetails,
    templateBlocks,
    templateBlockSetName
  );
}, [
  group,
  exclusions,
  academySchedules,
  studentContentsWithDetails,
  templateBlocks,
  templateBlockSetName,
]);

// Step1BasicInfoì— ì „ë‹¬
<Step1BasicInfo
  data={wizardData}
  onUpdate={() => {}}
  blockSets={[]} // âŒ ë¹ˆ ë°°ì—´ ì „ë‹¬
  editable={false}
  isCampMode={true}
  isTemplateMode={false}
/>
```

**ë³€ê²½ í›„**:
```typescript
// í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ë¥¼ blockSets í˜•ì‹ìœ¼ë¡œ ë³€í™˜
const blockSets = useMemo(() => {
  if (templateBlockSetId && templateBlockSetName) {
    return [
      {
        id: templateBlockSetId,
        name: templateBlockSetName,
        blocks: templateBlocks,
      },
    ];
  }
  return [];
}, [templateBlockSetId, templateBlockSetName, templateBlocks]);

// WizardData ìƒì„± (Step ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©)
const wizardData = useMemo(() => {
  const wizardDataResult = planGroupToWizardData(
    group,
    exclusions,
    academySchedules,
    studentContentsWithDetails,
    templateBlocks,
    templateBlockSetName
  );
  
  // í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ IDê°€ ìˆìœ¼ë©´ wizardDataì— ì„¤ì •
  if (templateBlockSetId && !wizardDataResult.block_set_id) {
    wizardDataResult.block_set_id = templateBlockSetId;
  }
  
  return wizardDataResult;
}, [
  group,
  exclusions,
  academySchedules,
  studentContentsWithDetails,
  templateBlocks,
  templateBlockSetName,
  templateBlockSetId,
]);

// Step1BasicInfoì— ì „ë‹¬
<Step1BasicInfo
  data={wizardData}
  onUpdate={() => {}}
  blockSets={blockSets} // âœ… í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ í¬í•¨
  editable={false}
  isCampMode={true}
  isTemplateMode={false}
/>
```

#### 2. `getCampPlanGroupForReview` - `tenantId` íŒŒë¼ë¯¸í„° ì¶”ê°€

**íŒŒì¼**: `app/(admin)/actions/camp-templates/progress.ts`

**ë³€ê²½ ì „**:
```typescript
const tenantBlockSetId = await getTemplateBlockSetId(
  result.group.camp_template_id,
  schedulerOptions
);
```

**ë³€ê²½ í›„**:
```typescript
const tenantBlockSetId = await getTemplateBlockSetId(
  result.group.camp_template_id,
  schedulerOptions,
  tenantContext.tenantId // âœ… tenantId ì „ë‹¬
);
```

## âœ… ìˆ˜ì • ê²°ê³¼

### ìˆ˜ì • ì „

- "ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”" ë©”ì‹œì§€ í‘œì‹œ
- "ë“±ë¡ëœ ë¸”ë¡ ì„¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤" ë©”ì‹œì§€ í‘œì‹œ
- ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

### ìˆ˜ì • í›„

- í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì´ë¦„ì´ í‘œì‹œë¨
- í…œí”Œë¦¿ ë¸”ë¡ ëª©ë¡ì´ í‘œì‹œë¨
- ìš”ì¼ë³„ í•™ìŠµ ì‹œê°„ì´ í™•ì¸ ê°€ëŠ¥í•¨
- ì½ê¸° ì „ìš© ëª¨ë“œì—ì„œë„ ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë¨

## ğŸ” ë°ì´í„° íë¦„

### ìˆ˜ì • ì „

```
getCampPlanGroupForReview
  â†“
templateBlockSetId, templateBlockSetName, templateBlocks ì¡°íšŒ âœ…
  â†“
CampPlanGroupReviewFormì— propsë¡œ ì „ë‹¬ âœ…
  â†“
blockSets={[]} âŒ (ë¹ˆ ë°°ì—´)
  â†“
Step1BasicInfoì—ì„œ ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ âŒ
  â†“
"ë¸”ë¡ ì„¸íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”" ë©”ì‹œì§€ í‘œì‹œ âŒ
```

### ìˆ˜ì • í›„

```
getCampPlanGroupForReview
  â†“
templateBlockSetId, templateBlockSetName, templateBlocks ì¡°íšŒ âœ…
  â†“
CampPlanGroupReviewFormì— propsë¡œ ì „ë‹¬ âœ…
  â†“
blockSets ë°°ì—´ êµ¬ì„± âœ… (í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ í¬í•¨)
  â†“
wizardData.block_set_id ì„¤ì • âœ…
  â†“
Step1BasicInfoì—ì„œ ë¸”ë¡ ì„¸íŠ¸ ì°¾ê¸° âœ…
  â†“
ë¸”ë¡ ì„¸íŠ¸ ì •ë³´ ì •ìƒ í‘œì‹œ âœ…
```

## ğŸ“ ì£¼ìš” ë³€ê²½ íŒŒì¼

1. **app/(admin)/admin/camp-templates/[id]/participants/[groupId]/review/CampPlanGroupReviewForm.tsx**
   - í…œí”Œë¦¿ ë¸”ë¡ ì„¸íŠ¸ë¥¼ `blockSets` í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§ ì¶”ê°€
   - `wizardData.block_set_id` ì„¤ì • ë¡œì§ ì¶”ê°€
   - `Step1BasicInfo`ì— `blockSets` prop ì „ë‹¬

2. **app/(admin)/actions/camp-templates/progress.ts**
   - `getTemplateBlockSetId` í˜¸ì¶œ ì‹œ `tenantId` íŒŒë¼ë¯¸í„° ì¶”ê°€

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [ìº í”„ í…œí”Œë¦¿ ì œì¶œ ì‹œ ë¸”ë¡ ì„¸íŠ¸ê°’ ì „ë‹¬ ê²€í† ](./20251222_ìº í”„-í…œí”Œë¦¿-ë¸”ë¡-ì„¸íŠ¸-ì „ë‹¬-ê²€í† .md)
- [ìº í”„ í…œí”Œë¦¿ ì œì¶œ í›„ ì‹œê°„ë¸”ë¡ í‘œì‹œ ê°œì„ ](./camp-submission-template-blocks-fix.md)
- [ê´€ë¦¬ì í˜ì´ì§€ 'ë‚¨ì€ ë‹¨ê³„ ì§„í–‰í•˜ê¸°' ë¸”ë¡ì„¸íŠ¸ ë¡œì§ ì—…ë°ì´íŠ¸](./admin-camp-continue-block-set-logic-update.md)



