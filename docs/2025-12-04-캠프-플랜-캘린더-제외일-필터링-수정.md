# 캠프 플랜 캘린더 제외일 필터링 수정

## 문제 상황

캠프 플랜 캘린더에서 플랜 생성 시 추가하지 않은 학습 제외일이 캘린더에 반영되고 있었습니다.

### 원인

- 일반 플랜 캘린더는 `exclusions` prop(플랜 그룹에 저장된 제외일)만 사용하여 제외일을 표시합니다.
- 하지만 `buildDayTypesFromDailySchedule` 함수가 `daily_schedule`의 제외일 정보를 그대로 사용하여, 플랜 생성 시 계산된 제외일(실제로 추가하지 않은 제외일)도 캘린더에 표시되었습니다.

## 수정 내용

### 1. `buildDayTypesFromDailySchedule` 함수 수정

**파일**: `lib/date/calendarDayTypes.ts`

- `exclusions` 매개변수를 추가하여 실제 제외일 목록을 받도록 수정
- 제외일 타입(지정휴일, 휴가, 개인일정)인 경우, 실제 제외일 목록에 있는지 확인
- 제외일 목록에 없는 경우 제외일 타입으로 표시하지 않음

```typescript
export function buildDayTypesFromDailySchedule(
  dailySchedules: Array<DailyScheduleInfo[] | null | undefined>,
  exclusions?: Array<{
    exclusion_date: string;
    exclusion_type: string;
    reason?: string | null;
  }>
): Map<string, DayTypeInfo>
```

### 2. `PlanCalendarView` 컴포넌트 수정

**파일**: `app/(student)/plan/calendar/_components/PlanCalendarView.tsx`

- `buildDayTypesFromDailySchedule` 호출 시 `exclusions` prop을 전달하도록 수정
- 이제 실제 제외일 목록에 있는 제외일만 캘린더에 표시됩니다

```typescript
const dayTypes = useMemo(() => {
  return buildDayTypesFromDailySchedule(dailySchedules, exclusions);
}, [dailySchedules, exclusions]);
```

## 동작 방식

1. **일반 플랜 캘린더**:
   - `getPlanExclusions`로 플랜 그룹에 저장된 제외일만 조회
   - `exclusions` prop으로 전달
   - `buildDayTypesFromDailySchedule`에서 필터링하여 표시

2. **캠프 플랜 캘린더**:
   - 동일하게 `getPlanExclusions`로 제외일 조회
   - `daily_schedule`의 제외일 정보와 비교하여 실제 추가한 제외일만 표시

## 테스트 확인 사항

- [ ] 캠프 플랜 생성 시 추가하지 않은 제외일이 캘린더에 표시되지 않는지 확인
- [ ] 캠프 플랜 생성 시 추가한 제외일이 정상적으로 캘린더에 표시되는지 확인
- [ ] 일반 플랜 캘린더의 동작이 변경되지 않았는지 확인

## 관련 파일

- `lib/date/calendarDayTypes.ts`
- `app/(student)/plan/calendar/_components/PlanCalendarView.tsx`
- `app/(student)/plan/calendar/page.tsx`

