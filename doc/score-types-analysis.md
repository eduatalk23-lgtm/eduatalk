# 성적 유형 분석 문서

## 📋 개요

이 문서는 TimeLevelUp 시스템에서 관리하는 성적 유형을 분석하고, 각 유형의 특징과 필드를 정리합니다.

---

## 1. 내신 성적 (SchoolScore)

### 1.1 정의

학교에서 실시하는 정기 평가(중간고사, 기말고사) 및 수행평가 성적을 관리하는 유형입니다.

### 1.2 테이블 구조

**테이블명**: `student_school_scores`

### 1.3 필드 구성

#### 필수 필드

| 필드명             | 타입    | 설명         | 비고                          |
| ------------------ | ------- | ------------ | ----------------------------- |
| `id`               | uuid    | 고유 식별자  | PK                            |
| `student_id`       | uuid    | 학생 ID      | FK → students                 |
| `grade`            | integer | 학년         | 1~3                           |
| `semester`         | integer | 학기         | 1~2                           |
| `subject_group_id` | uuid    | 교과 그룹 ID | FK → subject_groups           |
| `subject_id`       | uuid    | 과목 ID      | FK → subjects                 |
| `subject_type_id`  | uuid    | 과목구분 ID  | FK → subject_types (nullable) |
| `raw_score`        | numeric | 원점수       | 0 이상                        |
| `grade_score`      | integer | 성취도 등급  | 1~9 (1등급이 최고)            |
| `test_date`        | date    | 시험일       |                               |

#### 선택 필드

| 필드명               | 타입    | 설명     | 비고     |
| -------------------- | ------- | -------- | -------- |
| `credit_hours`       | numeric | 학점수   | 예: 4, 5 |
| `subject_average`    | numeric | 과목평균 |          |
| `standard_deviation` | numeric | 표준편차 |          |
| `total_students`     | integer | 수강자수 |          |
| `rank_grade`         | integer | 석차등급 | 1~9      |
| `class_rank`         | integer | 반 석차  |          |

### 1.4 특징

- **학기 단위 관리**: 학년과 학기를 기준으로 성적을 관리
- **상세 통계 정보**: 과목평균, 표준편차 등 통계 정보 포함 가능
- **등급 중심**: 성취도 등급(1~9등급)을 주요 지표로 사용
- **교과 위계 연동**: 교과 그룹, 과목, 과목구분과 정규화된 관계

### 1.5 사용 시나리오

1. 학생이 중간고사/기말고사 성적을 입력
2. 성취도 등급과 원점수 입력
3. 선택적으로 통계 정보(평균, 표준편차 등) 입력
4. 학기별로 성적 추이 확인

---

## 2. 모의고사 성적 (MockScore)

### 2.1 정의

대학수학능력시험 모의평가 및 학력평가 성적을 관리하는 유형입니다.

### 2.2 테이블 구조

**테이블명**: `student_mock_scores`

### 2.3 필드 구성

#### 필수 필드

| 필드명             | 타입    | 설명         | 비고                          |
| ------------------ | ------- | ------------ | ----------------------------- |
| `id`               | uuid    | 고유 식별자  | PK                            |
| `student_id`       | uuid    | 학생 ID      | FK → students                 |
| `grade`            | integer | 학년         | 1~3                           |
| `exam_type`        | text    | 시험 유형    | "교육청", "사설", "평가원"    |
| `subject_group_id` | uuid    | 교과 그룹 ID | FK → subject_groups           |
| `subject_id`       | uuid    | 과목 ID      | FK → subjects                 |
| `subject_type_id`  | uuid    | 과목구분 ID  | FK → subject_types (nullable) |
| `grade_score`      | integer | 등급         | 1~9 (1등급이 최고)            |
| `exam_round`       | text    | 회차         | 예: "3월", "6월", "9월"       |
| `test_date`        | date    | 시험일       |                               |

#### 선택 필드

| 필드명           | 타입    | 설명     | 비고                          |
| ---------------- | ------- | -------- | ----------------------------- |
| `raw_score`      | numeric | 원점수   | 영어/한국사 제외              |
| `standard_score` | numeric | 표준점수 | 영어/한국사 제외 필수         |
| `percentile`     | numeric | 백분위   | 영어/한국사 제외 필수 (0~100) |

### 2.4 특징

- **회차 단위 관리**: 학년과 회차(월)를 기준으로 성적을 관리
- **표준점수/백분위 중심**: 수능 체제에 맞춘 표준점수와 백분위 제공
- **영어/한국사 예외**: 영어와 한국사는 표준점수/백분위 없이 등급만 제공
- **시험 유형 구분**: 교육청, 사설, 평가원 등 시험 주체 구분
- **교과 위계 연동**: 교과 그룹, 과목, 과목구분과 정규화된 관계

### 2.5 사용 시나리오

1. 학생이 모의고사 성적을 입력
2. 시험 유형(교육청/사설)과 회차(월) 선택
3. 과목별 등급, 표준점수, 백분위 입력
4. 영어/한국사는 등급만 입력
5. 회차별 성적 추이 확인

---

## 3. 내신 성적 vs 모의고사 성적 비교

### 3.1 공통점

| 항목           | 설명                                               |
| -------------- | -------------------------------------------------- |
| 등급 체계      | 1~9등급 (1등급이 최고)                             |
| 교과 위계 연동 | subject_group_id, subject_id, subject_type_id 사용 |
| 학년 기준      | 1~3학년                                            |
| 시험일 기록    | test_date 필드                                     |

### 3.2 차이점

| 항목          | 내신 성적                    | 모의고사 성적           |
| ------------- | ---------------------------- | ----------------------- |
| **기준 단위** | 학기 (1학기, 2학기)          | 회차 (3월, 6월, 9월 등) |
| **주요 지표** | 원점수, 성취도 등급          | 표준점수, 백분위, 등급  |
| **통계 정보** | 과목평균, 표준편차, 석차     | 백분위 (전국 단위)      |
| **시험 유형** | 중간고사, 기말고사, 수행평가 | 교육청, 사설, 평가원    |
| **학점수**    | 있음 (credit_hours)          | 없음                    |
| **반 석차**   | 있음 (class_rank)            | 없음                    |

### 3.3 입력 필드 비교

#### 내신 성적 필수 필드

- 학년, 학기
- 교과, 과목, 과목구분
- 원점수, 성취도 등급
- 시험일

#### 모의고사 성적 필수 필드

- 학년, 시험 유형, 회차
- 교과, 과목, 과목구분
- 등급
- 표준점수, 백분위 (영어/한국사 제외)
- 시험일

---

## 4. 향후 확장 가능한 성적 유형

### 4.1 수능 성적 (CSAT)

**특징:**

- 대학수학능력시험 본시험 성적
- 모의고사와 유사한 구조이지만 최종 성적으로 관리
- 등급제와 표준점수 체계

**예상 필드:**

- `exam_type`: "수능"
- `exam_round`: null (본시험은 회차 없음)
- 모의고사와 동일한 필드 구조

### 4.2 학력평가 성적 (SAT)

**특징:**

- 전국 단위 학력평가 성적
- 모의고사와 유사한 구조
- 교육청 주관 시험

**예상 필드:**

- `exam_type`: "학력평가"
- 모의고사와 동일한 필드 구조

### 4.3 수행평가 성적

**특징:**

- 학교 내 수행평가 성적
- 내신 성적과 유사하지만 별도 관리
- 프로젝트, 발표, 실험 등 다양한 형태

**예상 필드:**

- 내신 성적과 유사한 구조
- `score_type`: "수행평가" 구분

### 4.4 기타 외부 시험 성적

**특징:**

- 토익, 토플, AP 등 외부 시험 성적
- 다양한 점수 체계 (만점 기준 다름)
- 등급이 아닌 점수 중심

**예상 필드:**

- `exam_type`: "토익", "토플", "AP" 등
- `raw_score`: 점수 (만점 기준 다양)
- `grade_score`: null (등급 없음)

---

## 5. 공통 데이터 구조

### 5.1 교과 위계 연동

모든 성적 유형은 다음 테이블과 정규화된 관계를 가집니다:

```
curriculum_revisions (개정교육과정)
  └─▶ subject_groups (교과)
        └─▶ subjects (과목)
              └─▶ subject_types (과목구분) via subject_type_id
```

**FK 필드:**

- `subject_group_id`: 교과 그룹 ID
- `subject_id`: 과목 ID
- `subject_type_id`: 과목구분 ID (nullable)

### 5.2 공통 메타데이터

| 필드명       | 타입        | 설명                        |
| ------------ | ----------- | --------------------------- |
| `tenant_id`  | uuid        | 테넌트 ID (멀티테넌트 지원) |
| `created_at` | timestamptz | 생성일시                    |
| `updated_at` | timestamptz | 수정일시                    |

---

## 6. 데이터 마이그레이션 고려사항

### 6.1 기존 텍스트 필드

**Deprecated 필드:**

- `subject_group` (text) → `subject_group_id` (uuid FK)
- `subject_type` (text) → `subject_type_id` (uuid FK)
- `subject_name` (text) → `subject_id` (uuid FK)

**마이그레이션 전략:**

1. 새 FK 컬럼 추가 (nullable)
2. 기존 텍스트 데이터를 FK로 변환
3. 데이터 검증 및 수동 보정
4. NOT NULL 제약조건 추가
5. 기존 텍스트 컬럼 제거

### 6.2 하위 호환성

마이그레이션 기간 동안 기존 텍스트 필드는 deprecated로 표시하되, 하위 호환성을 위해 유지합니다.

---

## 7. 참고 자료

- [교과 위계 구조 분석](./과목구분-위계-구조-분석.md)
- [교육과정-교과-과목-테이블-연결-확인](./교육과정-교과-과목-테이블-연결-확인.md)
- [입력 폼 가이드](./score-input-form-guide.md)

---

**마지막 업데이트**: 2025-01-XX








