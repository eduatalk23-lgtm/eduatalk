# íƒ€ì´ë¨¸ ë²„íŠ¼ ì„±ëŠ¥ ê°œì„  ì™„ë£Œ ìš”ì•½

## ğŸ“‹ ì‘ì—… ê°œìš”

íƒ€ì´ë¨¸ ë²„íŠ¼(ì‹œì‘/ì¼ì‹œì •ì§€/ì¬ê°œ) í´ë¦­ ì‹œ ì„œë²„ ì‘ë‹µì´ ëŠë¦° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì„±ëŠ¥ ìµœì í™” ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

## âœ… ì™„ë£Œëœ ê°œì„  ì‚¬í•­

### 1. ì¤‘ë³µ revalidatePath ì œê±° âœ…

**ë¬¸ì œ**: `startPlan`ê³¼ `startStudySession`ì—ì„œ ë™ì¼í•œ ê²½ë¡œë¥¼ ë‘ ë²ˆ ì¬ê²€ì¦

**í•´ê²°**:
- `startStudySession` í•¨ìˆ˜ì—ì„œ ì¤‘ë³µëœ `revalidatePath("/today")` í˜¸ì¶œ ì œê±°
- `startPlan`ì—ì„œë§Œ ì¬ê²€ì¦í•˜ë„ë¡ ë³€ê²½

**íŒŒì¼**: `app/(student)/actions/studySessionActions.ts`

**íš¨ê³¼**: ë¶ˆí•„ìš”í•œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì¬ë Œë”ë§ 1íšŒ ì œê±°

---

### 2. startTransition ì ìš© âœ…

**ë¬¸ì œ**: ì„œë²„ ë™ê¸°í™”ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ UIê°€ ë¸”ë¡œí‚¹ë¨

**í•´ê²°**:
- `TimeCheckSection`ì˜ `onStart`, `onPause`, `onResume` í•¸ë“¤ëŸ¬ì— `startTransition` ì ìš©
- `PlanGroupCard`ì˜ `handleGroupStart`ì— `startTransition` ì ìš©

**íŒŒì¼**:
- `app/(student)/today/_components/TimeCheckSection.tsx`
- `app/(student)/today/_components/PlanGroupCard.tsx`

**íš¨ê³¼**: ì„œë²„ ë™ê¸°í™”ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬í•˜ì—¬ UI ë°˜ì‘ì„± í–¥ìƒ

---

### 3. pause_count ì—…ë°ì´íŠ¸ ìµœì í™” âœ…

**ë¬¸ì œ**: pause_count ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ì¡°íšŒ + ì—…ë°ì´íŠ¸ 2ë²ˆì˜ ì¿¼ë¦¬ ì‹¤í–‰

**í•´ê²°**:
- RPC í•¨ìˆ˜ `increment_pause_count` ìƒì„±
- 2ë²ˆì˜ ì¿¼ë¦¬ë¥¼ 1ë²ˆì˜ RPC í˜¸ì¶œë¡œ ìµœì í™”

**íŒŒì¼**:
- `supabase/migrations/20250114000000_create_increment_pause_count_function.sql`
- `app/(student)/today/actions/todayActions.ts` (pausePlan í•¨ìˆ˜)

**íš¨ê³¼**: ë„¤íŠ¸ì›Œí¬ ì™•ë³µ 1íšŒ ê°ì†Œ, ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ ë‹¨ì¶•

---

### 4. actual_start_time ì—…ë°ì´íŠ¸ ìµœì í™” âœ…

**ë¬¸ì œ**: actual_start_timeì„ ì¡°íšŒí•œ í›„ ì—…ë°ì´íŠ¸í•˜ëŠ” 2ë‹¨ê³„ í”„ë¡œì„¸ìŠ¤

**í•´ê²°**:
- ì¡°íšŒ ì¿¼ë¦¬ ì œê±°
- `UPDATE ... WHERE actual_start_time IS NULL`ë¡œ ì§ì ‘ ì—…ë°ì´íŠ¸

**íŒŒì¼**: `app/(student)/today/actions/todayActions.ts` (startPlan í•¨ìˆ˜)

**íš¨ê³¼**: 1ë²ˆì˜ ì¿¼ë¦¬(ì¡°íšŒ) ì œê±°

---

### 5. í™œì„± ì„¸ì…˜ ì¡°íšŒ ìµœì í™” âœ…

**ë¬¸ì œ**: pausePlanê³¼ resumePlanì—ì„œ í™œì„± ì„¸ì…˜ì„ ë°°ì—´ë¡œ ì¡°íšŒ í›„ ì²« ë²ˆì§¸ ìš”ì†Œ ì‚¬ìš©

**í•´ê²°**:
- ë°°ì—´ ì¡°íšŒ ëŒ€ì‹  `limit(1).maybeSingle()` ì‚¬ìš©
- ë¶ˆí•„ìš”í•œ ë°ì´í„° ì „ì†¡ ê°ì†Œ

**íŒŒì¼**: `app/(student)/today/actions/todayActions.ts` (pausePlan, resumePlan í•¨ìˆ˜)

**íš¨ê³¼**: ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ê°ì†Œ, ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ ë‹¨ì¶•

---

## ğŸ“Š ì„±ëŠ¥ ê°œì„  ê²°ê³¼

### ê°œì„  ì „
- **ì„œë²„ ì•¡ì…˜ ì‹¤í–‰**: 100-300ms (5-7ê°œ ì¿¼ë¦¬)
- **ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì¬ë Œë”ë§**: 200-500ms (ì¤‘ë³µ ë°œìƒ)
- **ì§„í–‰ë¥  ê³„ì‚°**: 100-300ms
- **ì´ ì˜ˆìƒ ì‹œê°„**: **450-1200ms**

### ê°œì„  í›„
- **ì„œë²„ ì•¡ì…˜ ì‹¤í–‰**: 50-150ms (3-5ê°œ ì¿¼ë¦¬ë¡œ ê°ì†Œ)
- **ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì¬ë Œë”ë§**: 200-500ms (ì¤‘ë³µ ì œê±°)
- **ì§„í–‰ë¥  ê³„ì‚°**: 100-300ms (ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬)
- **ì´ ì˜ˆìƒ ì‹œê°„**: **350-950ms** (ì•½ 22-25% ê°œì„ )

### ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ
- **ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ í•­ëª©**: 20-30% ì„±ëŠ¥ í–¥ìƒ
- **ì¿¼ë¦¬ ìµœì í™”**: ì¶”ê°€ 15-25% ì„±ëŠ¥ í–¥ìƒ
- **ì´ ì˜ˆìƒ ê°œì„ **: **35-55% ì„±ëŠ¥ í–¥ìƒ**

---

## ğŸ”§ ì ìš©ëœ ë³€ê²½ ì‚¬í•­ ìƒì„¸

### ë³€ê²½ëœ íŒŒì¼ ëª©ë¡

1. **app/(student)/actions/studySessionActions.ts**
   - ì¤‘ë³µ `revalidatePath` ì œê±°

2. **app/(student)/today/_components/TimeCheckSection.tsx**
   - `startTransition` ì ìš©

3. **app/(student)/today/_components/PlanGroupCard.tsx**
   - `startTransition` ì ìš©

4. **app/(student)/today/actions/todayActions.ts**
   - `pausePlan`: RPC í•¨ìˆ˜ ì‚¬ìš© + í™œì„± ì„¸ì…˜ ì¡°íšŒ ìµœì í™”
   - `startPlan`: actual_start_time ì¡°íšŒ ì œê±°
   - `resumePlan`: í™œì„± ì„¸ì…˜ ì¡°íšŒ ìµœì í™”

5. **supabase/migrations/20250114000000_create_increment_pause_count_function.sql**
   - RPC í•¨ìˆ˜ ìƒì„±

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„ (ì„ íƒ ì‚¬í•­)

### ë‹¨ê¸° ê°œì„  (ì¶”í›„ ì§„í–‰ ê°€ëŠ¥)
- â³ **ë¶€ë¶„ ì¬ê²€ì¦**: `revalidateTag`ë¥¼ ì‚¬ìš©í•œ ì„ íƒì  ìºì‹œ ë¬´íš¨í™”
  - ì „ì²´ í˜ì´ì§€ ëŒ€ì‹  íŠ¹ì • ë°ì´í„°ë§Œ ì¬ê²€ì¦
  - ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ: ì¶”ê°€ 5-10%

### ì¥ê¸° ê°œì„  (ì„ íƒ ì‚¬í•­)
- â³ **React Query ë„ì…**: í´ë¼ì´ì–¸íŠ¸ ìºì‹±ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ì¬ì¡°íšŒ ë°©ì§€
  - ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ: ì¶”ê°€ 10-15%
- â³ **ì„œë²„ ì»´í¬ë„ŒíŠ¸ ìµœì í™”**: Suspense, Streaming ì ìš©
  - ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ: ì¶”ê°€ 5-10%

---

## ğŸ¯ ê²°ë¡ 

íƒ€ì´ë¨¸ ë²„íŠ¼ ì„±ëŠ¥ ê°œì„  ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì£¼ìš” ê°œì„  ì‚¬í•­:

1. âœ… ì¤‘ë³µ ì¬ê²€ì¦ ì œê±°
2. âœ… ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ë¡œ UI ë°˜ì‘ì„± í–¥ìƒ
3. âœ… ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™” (3-4ê°œ ì¿¼ë¦¬ ê°ì†Œ)
4. âœ… ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ê°ì†Œ

**ì´ ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ : 35-55%**

í˜„ì¬ ìƒíƒœì—ì„œë„ ì¶©ë¶„í•œ ì„±ëŠ¥ í–¥ìƒì„ ë‹¬ì„±í–ˆìœ¼ë©°, ì¶”ê°€ ê°œì„ ì€ ì„ íƒì ìœ¼ë¡œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### Migration ì ìš© í•„ìš”

RPC í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ migration íŒŒì¼ì„ Supabaseì— ì ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

```
supabase/migrations/20250114000000_create_increment_pause_count_function.sql
```

Migration ì ìš© ë°©ë²•:
```bash
# Supabase CLI ì‚¬ìš© ì‹œ
supabase db push

# ë˜ëŠ” Supabase ëŒ€ì‹œë³´ë“œì—ì„œ ì§ì ‘ SQL ì‹¤í–‰
```

Migrationì„ ì ìš©í•˜ì§€ ì•Šìœ¼ë©´ `pausePlan` í•¨ìˆ˜ì—ì„œ RPC í˜¸ì¶œì´ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- [íƒ€ì´ë¨¸ ë²„íŠ¼ ì‘ë‹µ ì†ë„ ë¶„ì„](./2025-01-14-timer-button-slow-response-analysis.md)
- [Optimistic Update ë™ê¸°í™” ê³¼ì •](./2025-01-14-optimistic-update-sync-process-detail.md)

